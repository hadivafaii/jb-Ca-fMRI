
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Load data &#8212; Ca-fMRI [Daily Progress]</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Ca-fMRI [Daily Progress]</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/feb21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/feb21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb21/feb-12-2021.html">
     February, 12th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb21/feb-13-2021.html">
     February, 13th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb21/feb-16-2021.html">
     February, 16th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb21/feb-20-2021.html">
     February, 20th 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/mar21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/mar21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-10-2021.html">
     March 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-13-2021.html">
     March 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-15-2021.html">
     March 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-16-2021.html">
     March 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-18-2021.html">
     March 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-19-2021.html">
     March 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-26-2021.html">
     March 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar21/mar-29-2021.html">
     March 29th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/apr21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/apr21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr21/apr-07-2021.html">
     April 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr21/apr-30-2021.html">
     April 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  May 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/may21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/may21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-08-2021.html">
     May 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-09-2021.html">
     May 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-11-2021.html">
     May 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-12-2021.html">
     May 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-20-2021.html">
     May 20th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-24-2021.html">
     May 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may21/may-31-2021.html">
     May 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  June 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/jun21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/jun21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-05-2021.html">
     June 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-06-2021.html">
     June 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-07-2021.html">
     June 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-12-2021.html">
     June 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-13-2021.html">
     June 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-15-2021.html">
     June 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-17-2021.html">
     June 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-18-2021.html">
     June 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-19-2021.html">
     June 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-21-2021.html">
     June 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-24-2021.html">
     June 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-26-2021.html">
     June, 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-29-2021.html">
     June 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun21/jun-30-2021.html">
     June 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  July 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/jul21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/jul21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul21/jul-01-2021.html">
     July 1st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul21/jul-09-2021.html">
     July 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul21/jul-11-2021.html">
     July 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul21/jul-31-2021.html">
     July 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  August 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/aug21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/aug21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug21/aug-21-2021.html">
     Aug 21st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  September 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/sep21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/sep21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-07-2021.html">
     Sep 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-08-2021.html">
     Sep 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-15-2021.html">
     Sep 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-19-2021.html">
     Sep 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-24-2021.html">
     Sep 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-25-2021.html">
     Sep 25th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep21/sep-27-2021.html">
     Sep 27th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  October 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/oct21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/oct21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-06-2021.html">
     October 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-10-2021.html">
     October 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-11-2021.html">
     October 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-12-2021.html">
     October 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-16-2021.html">
     October 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-17-2021.html">
     October 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-21-2021.html">
     October 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-26-2021.html">
     October 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-27-2021.html">
     October 27th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-29-2021.html">
     October 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-30-2021.html">
     October 30th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/oct21/oct-31-2021.html">
     October 31th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  November 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/nov21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/nov21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-05-2021.html">
     November 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-06-2021.html">
     November 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-09-2021.html">
     November 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-13-2021.html">
     November 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-24-2021.html">
     November 24th, 2021 (corr distrs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-26-2021.html">
     November 26th, 2021 (identify spikes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/nov21/nov-29-2021.html">
     November 29th, 2021 (figs 1 and 2)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  December 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/dec21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/dec21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-01-2021.html">
     Dec 1st, 2021 (topo dist)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-04-2021.html">
     Dec 4th, 2021 (Binary vs Sample)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-06-2021.html">
     Dec 6th, 2021 (tSNR: Ca all plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-07-2021.html">
     Dec 7th, 2021 (tSNR: Ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-08-2021.html">
     Dec 8th, 2021 (scp2raw2npy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-09-2021.html">
     Dec 9th, 2021 (tSNR: BOLD)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-10-2021.html">
     Dec 10th, 2021 (tSNR: identify bad areas)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-17-2021.html">
     Dec 17th, 2021 (GS all plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-18-2021.html">
     Dec 18th, 2021 (rabies)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-21-2021.html">
     Dec 21st, 2021 (ROI layers: concept)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-22-2021.html">
     Dec 22nd, 2021 (3-depths + render fns)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-24-2021.html">
     Dec 24th, 2021 (ROI layers: compare)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/dec21/dec-27-2021.html">
     Dec 27th, 2021 (Parcel viz 3D)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  January 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/jan22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/jan22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-03-2022.html">
     Jan 3rd, 2022 (Coreg ses play; fix 10_3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-04-2022.html">
     Jan 4th, 2022 (Coreg ses)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-07-2022.html">
     Jan 7th, 2022 (rabies: 2nd stage)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-12-2022.html">
     Jan 12th, 2022 (voxel sz plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-13-2022.html">
     Jan 13th, 2022 (topo dist, best density)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-17-2022.html">
     Jan 17th, 2022 (Results at various thresholds, discussion on topology)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-19-2022.html">
     Jan 19th, 2022 (Hierarchical)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-22-2022.html">
     Jan 22nd, 2022 (degree dist, cartography)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-25-2022.html">
     Jan 25th, 2022 (debug boot + 2 anim draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-26-2022.html">
     Jan 26th, 2022 (cleaner figs, SE bug)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-27-2022.html">
     Jan 27th, 2022 (SE debug)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-28-2022.html">
     Jan 28th, 2022 (SE debug: cont.)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-29-2022.html">
     Jan 29th, 2022 (seed filter: draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-30-2022.html">
     Jan 30th, 2022 (seed filter)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jan22/jan-31-2022.html">
     Jan 31st, 2022 (small memship vote: draft)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/feb22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/feb22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-01-2022.html">
     Feb 1st, 2022 (small memship vote)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-02-2022.html">
     Feb 2nd, 2022 (Mouse ICA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-04-2022.html">
     Feb 4th, 2022 (plot bold+ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-06-2022.html">
     Feb 6th, 2022 (rabies: 3rd stage)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-07-2022.html">
     Feb 7th, 2022 (Structural Connectome)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-08-2022.html">
     Feb 08, 2022 (LED vs. REST; avg over runs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-14-2022.html">
     Feb 14th, 2022 (pruned in grp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-15a-2022.html">
     Feb 15th, 2022 (Smart adj plot)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-15b-2022.html">
     Feb 15th, 2022 (Smart adj plot; better)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-18-2022.html">
     Feb 18th, 2022 (upsample bold; corr timeseries)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-22-2022.html">
     Feb 22nd, 2022 (GLM Ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-24-2022.html">
     Feb 24th, 2022 (grant finalize)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-25a-2022.html">
     Feb 25th, 2022 (Figs 4 the talk)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-25b-2022.html">
     Feb 25th, 2022 (compare cosine, DMN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-25c-2022.html">
     Feb 25th, 2022 (Entropy, carto)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-25d-2022.html">
     Feb 25th, 2022 (LFR reboot)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-25e-2022.html">
     Feb 25th, 2022 (ovp score, C_i; pie charts)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/feb22/feb-25f-2022.html">
     Feb 25th, 2022 (ROI plots)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/mar22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/mar22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar22/mar-05-2022.html">
     Mar 5th, 2022 (debug net; spearman &gt; pearson)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/mar22/mar-06-2022.html">
     Mar 6th, 2022 (Cartography, explored)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/apr22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/apr22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-01-2022.html">
     Apr 1st, 2022 (props, pie, entropy, contour, carto)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-02-2022.html">
     Apr 2nd, 2022 (quality control: both modalities)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-03-2022.html">
     Apr 3rd, 2022 (copy files: rabies + ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-04-2022.html">
     Apr 4th, 2022 (ca ref; viz some t)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-05-2022.html">
     Apr 5th, 2022 (check co-registration perf)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-07-2022.html">
     Apr 7th, 2022 (Fig 4, OCs, cosine sim, DMN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-11-2022.html">
     Apr 11th, 2022 (fix: affiliation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-12-2022.html">
     Apr 12th, 2022 (ent fixed + some supp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-13-2022.html">
     Apr 13th, 2022 (node &amp; oc overlap scores)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-14-2022.html">
     Apr 14th, 2022 (carto fixed + some supp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-15-2022.html">
     Apr 15th, 2022 (parcellation fix)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-16-2022.html">
     Apr 16th, 2022 (register RABIES)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-17-2022.html">
     Apr 17th, 2022 (a new beginning)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-20-2022.html">
     Apr 20th, 2022 (tSNR masks, many plot funcs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-21-2022.html">
     Apr 21st, 2022 (Ca clean, many adj plots, Yale comare RABIES)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-24-2022.html">
     Apr 24th, 2022 (findk both 128 and 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-25-2022.html">
     Apr 25th, 2022 (x-valid, both 128 and 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-26-2022.html">
     Apr 26th, 2022 (fix svinet, fix group)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-28-2022.html">
     Apr 28th, 2022 (plot ca node discont. + grey bg motion)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-29-2022.html">
     Apr 29th, 2022 (ROI sizes 2d &amp; 3d)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-30a-2022.html">
     Apr 30th, 2022 (Misc KABA, 128 * 3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/apr22/apr-30b-2022.html">
     Apr 30th, 2022 (Misc GABAN, 512 * 3)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  May 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/may22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/may22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-02-2022.html">
     May 2nd, 2022 (global order or not? – prelim)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-05-2022.html">
     May 5th, 2022 (global order or not? + sample vs. binary)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-06-2022.html">
     May 6th, 2022 (REST vs LED)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-08-2022.html">
     May 8th, 2022 (x-valid, binary vs sample)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-15-2022.html">
     May 15th, 2022 (rabies highpass: copy + plot n_t removed)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-16-2022.html">
     May 16th, 2022 (ca bp, lombscargle_fill)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-17-2022.html">
     May 17th, 2022 (ca bp, lombscargle_fill, finalize)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-24-2022.html">
     May 24th, 2022 (new results w/ bp: 192 * 3, k = 7)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-26-2022.html">
     May 26th, 2022 (task = all, info on good_nodes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-27-2022.html">
     May 27th, 2022 (plot degree dist; adj on ctx)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-31a-2022.html">
     May 31st, 2022 (Results so far: KABA, 128 * 3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/may22/may-31b-2022.html">
     May 31st, 2022 (Results so far: GABAN, 512 * 3)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  June 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/jun22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/jun22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-02-2022.html">
     Jun 2nd, 2022 (prune finalized – almost)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-03-2022.html">
     Jun 3rd, 2022 (global node selection (automatic now))
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-06a-2022.html">
     Jun 6th, 2022 (results so far, prune, mg)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-06b-2022.html">
     Jun 6th, 2022 (results so far, prune, mg)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-08a-2022.html">
     Jun 8th, 2022 (plot pi together for all: KABA 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-08b-2022.html">
     Jun 8th, 2022 (plot pi together for all: GABAN 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-09a-2022.html">
     Jun 9th, 2022 (entropy (clean) k=7,10,14: KABA 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-09b-2022.html">
     Jun 9th, 2022 (entropy (clean) k=7,10,14: GABAN 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-12a-2022.html">
     Jun 12th, 2022 (full brain bold: KABA 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-12b-2022.html">
     Jun 12th, 2022 (full brain bold: GABAN 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-13-2022.html">
     Jun 13th, 2022 (Node presnece figs for N=512 ROIs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-14a-2022.html">
     Jun 14th, 2022 (ttest + ovp score new: KABA 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-14b-2022.html">
     Jun 14th, 2022 (ttest + ovp score new: GABAN 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-18a-2022.html">
     Jun 18th, 2022 (boot parallel: 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-18b-2022.html">
     Jun 18th, 2022 (boot parallel: 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-21-2022.html">
     Jun 21st, 2022 (effect of mu and alpha on prune)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-22-2022.html">
     Jun 22nd, 2022 (Debug degree + anomalous run 9-2-1 detected)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-23-2022.html">
     Jun 23rd, 2022 (save fixed run_deg)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-27a-2022.html">
     Jun 27th, 2022 (Carto not working: 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-27b-2022.html">
     Jun 27th, 2022 (Carto not working: 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-28-2022.html">
     Jun 28th, 2022 (full brain bold: KABA 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-29a-2022.html">
     Jun 29th, 2022 (plot pi together for all: 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-29b-2022.html">
     Jun 29th, 2022 (plot pi together for all: 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-30a-2022.html">
     Jun 30th, 2022 (find max pi sym - seeds, prune or not: 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jun22/jun-30b-2022.html">
     Jun 30th, 2022 (find max pi sym - seeds, prune or not: 512)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  July 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/jul22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/jul22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-deg-2022.html">
     Jul 3rd, 2022 (Fig-2: Degree)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-04-2022.html">
     Jul 4th, 2022 (Fig-7: Entropy – draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ent-2022.html">
     Jul 5th, 2022 (Fig-7: Entropy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-05-2022.html">
     Jul 5th, 2022 (Fig-3 OCs – draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs3-2022.html">
     Jul 6th, 2022 (Fig-3 OCs; K=3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs7-2022.html">
     Jul 6th, 2022 (Fig-3 OCs; K=7)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs20-2022.html">
     Jul 6th, 2022 (Fig-3 OCs; K=20)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs-2022.html">
     Jul 7th, 2022 (Fig-3 OCs; combined)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-prop-2022.html">
     Jul 8th, 2022 (Fig-5 proportion plot)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-09-2022.html">
     Jul 9th, 2022 (Fig-6 mem plots – draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-mem-2022.html">
     Jul 9th, 2022 (Fig-6 mem plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-cbar-2022.html">
     Jul 10th, 2022 (cbar for figs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-sup-2022.html">
     Jul 11th, 2022 (Fig-sup: Deg/Ent Percentile)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-12-2022.html">
     Jul 12th, 2022 (perc = 15 is better)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-deg-final-2022.html">
     Jul 15th, 2022 (Fig-7: Degree)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ent-final-2022.html">
     Jul 15th, 2022 (Fig-6: Entropy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs3-final-2022.html">
     Jul 15th, 2022 (Fig-2 OCs; K=3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs7-final-2022.html">
     Jul 15th, 2022 (Fig-2 OCs; K=7)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs20-final-2022.html">
     Jul 15th, 2022 (Fig-3 OCs; K=20)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs-final-2022.html">
     Jul 15th, 2022 (Fig-2 OCs; combined)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-prop-final-2022.html">
     Jul 15th, 2022 (Fig-4 proportion)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-mem-final-2022.html">
     Jul 15th, 2022 (Fig-5 mem plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-sup-final-2022.html">
     Jul 16th, 2022 (Fig-sup: Deg/Ent perc + carto + n128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-cbar-final-2022.html">
     Jul 16th, 2022 (cbar for figs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-allen-2022.html">
     Jul 21st, 2022 (Allen Ctx + parc top)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs3-n128-2022.html">
     Jul 21st, 2022 (Fig-2 OCs; K=3; n=128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs7-n128-2022.html">
     Jul 21st, 2022 (Fig-2 OCs; K=7; n=128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs-n128-2022.html">
     Jul 21st, 2022 (Fig-2 OCs; combined; n=128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs7-p25-2022.html">
     Jul 21st, 2022 (Fig-2 OCs; K=7; p=25)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ocs-p25-2022.html">
     Jul 21st, 2022 (Fig-2 OCs; combined; p=25)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-22-2022.html">
     Jul 22nd, 2022 (Fig2, add indiv circles)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-deg-n128-2022.html">
     Jul 24th, 2022 (Fig-2: Degree; n=128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-ent-n128-2022.html">
     Jul 24th, 2022 (Fig-6: Entropy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/jul22/jul-27-2022.html">
     Jul 27th, 2022 (Ent dist nonzero + Deg perm)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  August 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/aug22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/aug22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-09-2022.html">
     Aug 9th, 2022 (Perm: OCs / overall)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-10a-2022.html">
     Aug 10th, 2022 (cos sim 8 x conds: 128)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-10b-2022.html">
     Aug 10th, 2022 (cos sim 8 x conds: 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-11-2022.html">
     Aug 11th, 2022 (render + ROI presence)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-12-2022.html">
     Aug 12th, 2022 (cos sim 8 x conds: 512)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-17-2022.html">
     Aug 17th, 2022 (Degree: 0 –&gt; NaN; zscore)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-19a-2022.html">
     Aug 19th, 2022 (Degree: w/o regression, KABA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-19b-2022.html">
     Aug 19th, 2022 (Degree: w/o regression, GABAN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-20-2022.html">
     Aug 20th, 2022 (Degree: re-calculate save group)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-21-2022.html">
     Aug 21st, 2022 (Degree: w/o regression, final)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-24-2022.html">
     Aug 24th, 2022 (LFR reboot 2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/aug22/aug-31-2022.html">
     Aug 31th, 2022 (Particip. Coeff.)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  September 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="md/sep22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="md/sep22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep22/sep-13-2022.html">
     Sep 13th, 2022 (Fig1: ROI plots, layer plots 10)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nb/sep22/sep-29-2022.html">
     Sep 29th, 2022 (Generate data Fig 2E, Fig 3)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/play_kmeans_parcellation-128.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hadivafaii/Ca-fMRI"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/hadivafaii/Ca-fMRI/issues/new?title=Issue%20on%20page%20%2Fplay_kmeans_parcellation-128.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hadivafaii/Ca-fMRI/master?urlpath=tree/docs/play_kmeans_parcellation-128.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Load data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concanenate">
   Concanenate
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#todo-add-anatomical-distance-based-on-center-of-k-means">
   TODO: add anatomical distance based on center of k means
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finer-scale">
     Finer scale
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#network-measures">
     Network measures
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span> <span class="k">as</span> <span class="n">sp_stats</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>


<span class="c1"># GitHub</span>
<span class="n">git_path</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git/Ca-fMRI/&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">git_path</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">simulation.simulation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.processing</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">model.configuration</span> <span class="kn">import</span> <span class="n">Config</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">filter_islands</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">atlas</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">min_com_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">coms_ctr</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    
    <span class="n">good_com_idxs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_com_size</span><span class="p">,</span> <span class="n">coms_ctr</span><span class="o">.</span><span class="n">most_common</span><span class="p">()))</span>
    <span class="n">good_com_idxs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">good_com_idxs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">bad_com_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">good_com_idxs</span><span class="p">]</span>

    <span class="n">comm_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">partition</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">comm_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">comm_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">comm_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="n">comm_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">atlas</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">com_idx</span> <span class="ow">in</span> <span class="n">partition</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">region_id</span> <span class="o">=</span> <span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">com_idx</span> <span class="ow">in</span> <span class="n">good_com_idxs</span><span class="p">:</span>
            <span class="n">comm_mat</span><span class="p">[</span><span class="n">atlas</span> <span class="o">==</span> <span class="n">region_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">good_com_idxs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">com_idx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comm_mat</span><span class="p">[</span><span class="n">atlas</span> <span class="o">==</span> <span class="n">region_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;good_com_idxs&#39;</span><span class="p">:</span> <span class="n">good_com_idxs</span><span class="p">,</span>
        <span class="s1">&#39;bad_com_idxs&#39;</span><span class="p">:</span> <span class="n">bad_com_idxs</span><span class="p">,</span>
        <span class="s1">&#39;comm_dict&#39;</span><span class="p">:</span> <span class="n">comm_dict</span><span class="p">,</span>
        <span class="s1">&#39;comm_mat&#39;</span><span class="p">:</span> <span class="n">comm_mat</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">output</span>


<span class="k">def</span> <span class="nf">plot_louvain_communities</span><span class="p">(</span>
    <span class="n">pearson</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">spearman</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">atlas</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">modularities</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">selected_idxs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">pearson_th</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="n">spearman_th</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">):</span>

    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">modularities</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
    <span class="n">best_res</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">plot_idxs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">selected_idxs</span> <span class="o">+</span> <span class="p">[</span><span class="n">best_idx</span><span class="p">])</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_idxs</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_idxs</span><span class="p">):</span>
        <span class="c1"># pearson</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">pearson</span><span class="p">[</span><span class="n">pearson_th</span><span class="p">])</span>
        <span class="n">coms</span> <span class="o">=</span> <span class="n">cdlib_algorithms</span><span class="o">.</span><span class="n">louvain</span><span class="p">(</span>
            <span class="n">g_original</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
            <span class="n">resolution</span><span class="o">=</span><span class="n">x0</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
            <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="s1">&#39;community&#39;</span><span class="p">,</span> <span class="s1">&#39;partition&#39;</span><span class="p">,</span> <span class="n">community</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">filter_islands</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">atlas</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">min_com_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">nx_comm</span><span class="o">.</span><span class="n">modularity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">communities</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Q = </span><span class="si">{:.3f}</span><span class="s1">,  # com = </span><span class="si">{:d}</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">][</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
        
        <span class="c1"># spearman</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">spearman</span><span class="p">[</span><span class="n">spearman_th</span><span class="p">])</span>
        <span class="n">coms</span> <span class="o">=</span> <span class="n">cdlib_algorithms</span><span class="o">.</span><span class="n">louvain</span><span class="p">(</span>
            <span class="n">g_original</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
            <span class="n">resolution</span><span class="o">=</span><span class="n">x0</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
            <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="s1">&#39;community&#39;</span><span class="p">,</span> <span class="s1">&#39;partition&#39;</span><span class="p">,</span> <span class="n">community</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">filter_islands</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">atlas</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">min_com_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">nx_comm</span><span class="o">.</span><span class="n">modularity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">communities</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>
    
        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;res = </span><span class="si">{:.3f}</span><span class="se">\n\n</span><span class="s1">Q = </span><span class="si">{:.3f}</span><span class="s1">,  # com = </span><span class="si">{:d}</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">][</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
        

        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;pearson</span><span class="se">\n</span><span class="s1">(th = </span><span class="si">{:.2f}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pearson_th</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;spearman</span><span class="se">\n</span><span class="s1">(th = </span><span class="si">{:.2f}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spearman_th</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
</pre></div>
</div>
</div>
</div>
<section id="load-data">
<h1>Load data<a class="headerlink" href="#load-data" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>

<span class="n">load</span> <span class="o">=</span> <span class="n">load_organized_data</span><span class="p">(</span>
    <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;atlas-128_unfiltered_unnormalized&#39;</span><span class="p">,</span><span class="c1">#&#39;filtered_low-0.001_high-4.000_ord-2_normalized&#39;,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">subject</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">session</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">run</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">num_regions</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROIs&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;kmeans_centers&#39;</span><span class="p">]:</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROI centers on cortex&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;flag_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Anatomical atlas&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">sup</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Here we define regions of interest (ROI)</span><span class="se">\n</span><span class="s1">In this parcellation schemce, we have </span><span class="si">{:d}</span><span class="s1"> ROIs = number of nodes&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_regions</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;kmeans_atlas.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="p">[</span><span class="n">sup</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_4_0.png" src="_images/play_kmeans_parcellation-128_4_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_pixs_per_roi</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_regions</span><span class="o">+</span><span class="mi">1</span><span class="p">)}</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">num_pixs_per_roi</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;num regions: </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_regions</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;num pixels in a region&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_8_0.png" src="_images/play_kmeans_parcellation-128_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    
    <span class="n">num_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">num_nan</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">num_nan</span><span class="p">)</span>
        <span class="k">continue</span>
    
    <span class="n">x</span><span class="p">[</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(190, 186, 5500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">1800</span>
<span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">_slice</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">+</span> <span class="n">res</span> <span class="o">*</span> <span class="mi">120</span><span class="p">]</span>
<span class="n">vminmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_slice</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_slice</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">res</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">idx</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">idx</span><span class="o">%</span><span class="k">ncols</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">_slice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span> <span class="o">*</span> <span class="n">res</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">vminmax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vminmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_12_0.png" src="_images/play_kmeans_parcellation-128_12_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">])</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node_labels</span><span class="p">)}</span>

<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>119</th>
      <th>120</th>
      <th>121</th>
      <th>122</th>
      <th>123</th>
      <th>124</th>
      <th>125</th>
      <th>126</th>
      <th>127</th>
      <th>128</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>...</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
      <td>5500.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7.798880</td>
      <td>9.520595</td>
      <td>7.131000</td>
      <td>12.710832</td>
      <td>12.746796</td>
      <td>6.627548</td>
      <td>10.146741</td>
      <td>15.847566</td>
      <td>11.650623</td>
      <td>19.583149</td>
      <td>...</td>
      <td>16.659527</td>
      <td>17.153321</td>
      <td>9.543558</td>
      <td>11.780937</td>
      <td>8.870620</td>
      <td>13.735455</td>
      <td>13.661941</td>
      <td>9.401963</td>
      <td>10.502899</td>
      <td>12.142878</td>
    </tr>
    <tr>
      <th>std</th>
      <td>24.875385</td>
      <td>30.259247</td>
      <td>19.099718</td>
      <td>32.786682</td>
      <td>35.865367</td>
      <td>11.525206</td>
      <td>40.075206</td>
      <td>50.424845</td>
      <td>46.738206</td>
      <td>63.394058</td>
      <td>...</td>
      <td>102.240594</td>
      <td>77.081863</td>
      <td>30.417967</td>
      <td>81.839726</td>
      <td>35.156782</td>
      <td>76.353094</td>
      <td>48.145441</td>
      <td>48.187395</td>
      <td>44.917977</td>
      <td>35.849339</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-76.311890</td>
      <td>-103.358659</td>
      <td>-68.768472</td>
      <td>-116.518565</td>
      <td>-113.629717</td>
      <td>-43.621664</td>
      <td>-129.534244</td>
      <td>-157.058232</td>
      <td>-164.693261</td>
      <td>-200.283706</td>
      <td>...</td>
      <td>-322.182653</td>
      <td>-224.871680</td>
      <td>-90.758845</td>
      <td>-241.672304</td>
      <td>-110.361040</td>
      <td>-226.638952</td>
      <td>-135.122950</td>
      <td>-140.325162</td>
      <td>-131.258650</td>
      <td>-98.528095</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-8.092969</td>
      <td>-10.028809</td>
      <td>-4.208212</td>
      <td>-8.477186</td>
      <td>-11.198517</td>
      <td>-0.045627</td>
      <td>-15.038566</td>
      <td>-17.904991</td>
      <td>-18.552409</td>
      <td>-21.857340</td>
      <td>...</td>
      <td>-51.723718</td>
      <td>-33.960902</td>
      <td>-10.257109</td>
      <td>-44.762890</td>
      <td>-14.551430</td>
      <td>-39.407927</td>
      <td>-19.153194</td>
      <td>-23.939039</td>
      <td>-20.574386</td>
      <td>-12.959658</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.910266</td>
      <td>11.350533</td>
      <td>9.098249</td>
      <td>13.966880</td>
      <td>12.849950</td>
      <td>7.788853</td>
      <td>15.116773</td>
      <td>15.941690</td>
      <td>16.505702</td>
      <td>21.206498</td>
      <td>...</td>
      <td>32.337977</td>
      <td>26.232385</td>
      <td>11.654654</td>
      <td>19.123402</td>
      <td>12.439727</td>
      <td>24.797665</td>
      <td>18.520023</td>
      <td>14.018539</td>
      <td>14.918876</td>
      <td>15.186188</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>24.831137</td>
      <td>30.624768</td>
      <td>20.080692</td>
      <td>34.691298</td>
      <td>36.989578</td>
      <td>14.108556</td>
      <td>38.314134</td>
      <td>48.802779</td>
      <td>44.789405</td>
      <td>61.852105</td>
      <td>...</td>
      <td>90.494208</td>
      <td>70.006349</td>
      <td>31.044141</td>
      <td>72.560377</td>
      <td>34.567967</td>
      <td>69.291110</td>
      <td>46.861316</td>
      <td>44.512713</td>
      <td>42.978186</td>
      <td>36.997789</td>
    </tr>
    <tr>
      <th>max</th>
      <td>96.501237</td>
      <td>107.337960</td>
      <td>67.145289</td>
      <td>129.834084</td>
      <td>142.494672</td>
      <td>46.949729</td>
      <td>122.423706</td>
      <td>198.931634</td>
      <td>149.044927</td>
      <td>272.632123</td>
      <td>...</td>
      <td>305.092811</td>
      <td>297.279641</td>
      <td>101.286836</td>
      <td>238.649787</td>
      <td>109.591127</td>
      <td>223.668584</td>
      <td>188.696853</td>
      <td>143.329078</td>
      <td>139.121244</td>
      <td>132.465799</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 128 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">]</span>
<span class="n">corrs</span> <span class="o">=</span> <span class="n">get_corrs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7f2f06f720a0&gt;
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_18_1.png" src="_images/play_kmeans_parcellation-128_18_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_corrs</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">],</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_19_0.png" src="_images/play_kmeans_parcellation-128_19_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_corr_hist</span><span class="p">(</span>
    <span class="n">corr_list</span><span class="o">=</span><span class="p">[</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">],</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman_corr&#39;</span><span class="p">]],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_21_0.png" src="_images/play_kmeans_parcellation-128_21_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 864x576 with 1 Axes&gt;,
 &lt;AxesSubplot:title={&#39;center&#39;:&#39;Histogram plot of correlations&#39;}, ylabel=&#39;Probability&#39;&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphs</span> <span class="o">=</span> <span class="p">{</span><span class="n">th</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">th</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_louvain</span> <span class="o">=</span> <span class="n">run_louvain</span><span class="p">(</span><span class="n">graphs</span><span class="p">[</span><span class="mf">0.86</span><span class="p">],</span> <span class="n">res</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">420</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">580</span><span class="p">,</span> <span class="mi">650</span><span class="p">]</span>
<span class="n">plot_louvain_results</span><span class="p">(</span><span class="n">results_louvain</span><span class="p">,</span> <span class="n">selected_idxs</span><span class="o">=</span><span class="n">selected_idxs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_25_0.png" src="_images/play_kmeans_parcellation-128_25_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_louvain_communities</span><span class="p">(</span>
    <span class="n">pearson</span><span class="o">=</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">],</span>
    <span class="n">spearman</span><span class="o">=</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">],</span>
    <span class="n">atlas</span><span class="o">=</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">],</span>
    <span class="n">modularities</span><span class="o">=</span><span class="n">results_louvain</span><span class="p">[</span><span class="s1">&#39;modularities&#39;</span><span class="p">],</span>
    <span class="n">selected_idxs</span><span class="o">=</span><span class="n">selected_idxs</span><span class="p">,</span>
    <span class="n">pearson_th</span><span class="o">=</span><span class="mf">0.88</span><span class="p">,</span>
    <span class="n">spearman_th</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_28_0.png" src="_images/play_kmeans_parcellation-128_28_0.png" />
</div>
</div>
</section>
<section id="concanenate">
<h1>Concanenate<a class="headerlink" href="#concanenate" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_all</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
    <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_organized_data</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;atlas-128_unfiltered_unnormalized&#39;</span><span class="p">,</span><span class="c1">#&#39;filtered_low-0.001_high-4.000_ord-2_normalized&#39;,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">subject</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">session</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">run</span><span class="o">=</span><span class="n">run</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">time_series</span> <span class="ow">in</span> <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">num_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">num_nan</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">num_nan</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">x</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
    
    <span class="n">t</span> <span class="o">=</span> <span class="mi">1800</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">_slice</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">+</span> <span class="n">res</span> <span class="o">*</span> <span class="mi">120</span><span class="p">]</span>
    <span class="n">vminmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_slice</span><span class="p">))</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_slice</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">res</span><span class="p">):</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">idx</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">idx</span><span class="o">%</span><span class="k">ncols</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">_slice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span> <span class="o">*</span> <span class="n">res</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">vminmax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vminmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;RUN: </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">run</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_33_0.png" src="_images/play_kmeans_parcellation-128_33_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_33_2.png" src="_images/play_kmeans_parcellation-128_33_2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_33_4.png" src="_images/play_kmeans_parcellation-128_33_4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_33_6.png" src="_images/play_kmeans_parcellation-128_33_6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">run</span><span class="p">,</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">data_all</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">x_dict</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">item</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">x_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">x_dict_normalized</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">x_dict_normalized</span><span class="p">)])</span>

<span class="n">node_labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node_labels</span><span class="p">)}</span>

<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>119</th>
      <th>120</th>
      <th>121</th>
      <th>122</th>
      <th>123</th>
      <th>124</th>
      <th>125</th>
      <th>126</th>
      <th>127</th>
      <th>128</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>...</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.016388</td>
      <td>-0.017893</td>
      <td>-0.017069</td>
      <td>-0.011585</td>
      <td>-0.014656</td>
      <td>-0.015102</td>
      <td>-0.017255</td>
      <td>-0.010344</td>
      <td>-0.023025</td>
      <td>-0.006268</td>
      <td>...</td>
      <td>-0.035847</td>
      <td>-0.020918</td>
      <td>-0.016273</td>
      <td>-0.037038</td>
      <td>-0.024403</td>
      <td>-0.040073</td>
      <td>-0.022786</td>
      <td>-0.029370</td>
      <td>-0.026138</td>
      <td>-0.014972</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.272262</td>
      <td>0.317607</td>
      <td>0.218333</td>
      <td>0.321354</td>
      <td>0.368238</td>
      <td>0.160138</td>
      <td>0.396327</td>
      <td>0.498329</td>
      <td>0.455019</td>
      <td>0.579010</td>
      <td>...</td>
      <td>0.964880</td>
      <td>0.740199</td>
      <td>0.311767</td>
      <td>0.776854</td>
      <td>0.343247</td>
      <td>0.740836</td>
      <td>0.485066</td>
      <td>0.468669</td>
      <td>0.443533</td>
      <td>0.363329</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.982600</td>
      <td>-1.168274</td>
      <td>-0.866468</td>
      <td>-1.294176</td>
      <td>-1.266538</td>
      <td>-0.596770</td>
      <td>-1.418697</td>
      <td>-1.754094</td>
      <td>-1.755064</td>
      <td>-2.095558</td>
      <td>...</td>
      <td>-3.591648</td>
      <td>-2.762908</td>
      <td>-1.117423</td>
      <td>-2.491523</td>
      <td>-1.235266</td>
      <td>-2.643039</td>
      <td>-1.706743</td>
      <td>-1.657538</td>
      <td>-1.706881</td>
      <td>-1.342029</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.194560</td>
      <td>-0.229806</td>
      <td>-0.154681</td>
      <td>-0.225522</td>
      <td>-0.268099</td>
      <td>-0.114941</td>
      <td>-0.274737</td>
      <td>-0.355402</td>
      <td>-0.323958</td>
      <td>-0.401146</td>
      <td>...</td>
      <td>-0.613654</td>
      <td>-0.465713</td>
      <td>-0.227147</td>
      <td>-0.554875</td>
      <td>-0.250611</td>
      <td>-0.521864</td>
      <td>-0.338272</td>
      <td>-0.341294</td>
      <td>-0.322809</td>
      <td>-0.253642</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.017450</td>
      <td>-0.016082</td>
      <td>-0.021818</td>
      <td>-0.014653</td>
      <td>-0.025611</td>
      <td>-0.020104</td>
      <td>-0.006007</td>
      <td>-0.025109</td>
      <td>-0.009366</td>
      <td>-0.017682</td>
      <td>...</td>
      <td>0.008502</td>
      <td>0.006448</td>
      <td>-0.019744</td>
      <td>-0.034133</td>
      <td>-0.022015</td>
      <td>-0.027322</td>
      <td>-0.024536</td>
      <td>-0.027346</td>
      <td>-0.025669</td>
      <td>-0.022515</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.157393</td>
      <td>0.189779</td>
      <td>0.113866</td>
      <td>0.196925</td>
      <td>0.224398</td>
      <td>0.078664</td>
      <td>0.240798</td>
      <td>0.313531</td>
      <td>0.281884</td>
      <td>0.373030</td>
      <td>...</td>
      <td>0.585951</td>
      <td>0.433232</td>
      <td>0.182956</td>
      <td>0.473879</td>
      <td>0.198987</td>
      <td>0.441731</td>
      <td>0.275617</td>
      <td>0.275472</td>
      <td>0.254116</td>
      <td>0.206903</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.296868</td>
      <td>1.456478</td>
      <td>1.127696</td>
      <td>1.459808</td>
      <td>1.787117</td>
      <td>0.884699</td>
      <td>1.884244</td>
      <td>2.448247</td>
      <td>2.100702</td>
      <td>2.712541</td>
      <td>...</td>
      <td>6.417246</td>
      <td>5.977250</td>
      <td>1.744478</td>
      <td>4.805378</td>
      <td>1.725743</td>
      <td>4.612843</td>
      <td>3.824357</td>
      <td>2.780379</td>
      <td>2.913108</td>
      <td>2.410052</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 128 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">]</span>
<span class="n">corrs</span> <span class="o">=</span> <span class="n">get_corrs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7f2f06ed1f70&gt;
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_39_1.png" src="_images/play_kmeans_parcellation-128_39_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_corrs</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">],</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_41_0.png" src="_images/play_kmeans_parcellation-128_41_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_corr_hist</span><span class="p">(</span>
    <span class="n">corr_list</span><span class="o">=</span><span class="p">[</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">],</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman_corr&#39;</span><span class="p">]],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_43_0.png" src="_images/play_kmeans_parcellation-128_43_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 864x576 with 1 Axes&gt;,
 &lt;AxesSubplot:title={&#39;center&#39;:&#39;Histogram plot of correlations&#39;}, ylabel=&#39;Probability&#39;&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphs</span> <span class="o">=</span> <span class="p">{</span><span class="n">th</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">th</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_louvain</span> <span class="o">=</span> <span class="n">run_louvain</span><span class="p">(</span><span class="n">graphs</span><span class="p">[</span><span class="mf">0.82</span><span class="p">],</span> <span class="n">res</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">450</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">700</span><span class="p">]</span>
<span class="n">plot_louvain_results</span><span class="p">(</span><span class="n">results_louvain</span><span class="p">,</span> <span class="n">selected_idxs</span><span class="o">=</span><span class="n">selected_idxs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_47_0.png" src="_images/play_kmeans_parcellation-128_47_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">450</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">620</span><span class="p">]</span> <span class="c1"># [440, 520, 530, 590]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_louvain_communities</span><span class="p">(</span>
    <span class="n">pearson</span><span class="o">=</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">],</span>
    <span class="n">spearman</span><span class="o">=</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">],</span>
    <span class="n">atlas</span><span class="o">=</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">],</span>
    <span class="n">modularities</span><span class="o">=</span><span class="n">results_louvain</span><span class="p">[</span><span class="s1">&#39;modularities&#39;</span><span class="p">],</span>
    <span class="n">selected_idxs</span><span class="o">=</span><span class="n">selected_idxs</span><span class="p">,</span>
    <span class="n">pearson_th</span><span class="o">=</span><span class="mf">0.83</span><span class="p">,</span>
    <span class="n">spearman_th</span><span class="o">=</span><span class="mf">0.82</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_49_0.png" src="_images/play_kmeans_parcellation-128_49_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;louvain.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spearman_th</span> <span class="o">=</span> <span class="mf">0.82</span>
<span class="n">selected_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">450</span><span class="p">,</span> <span class="mi">476</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">620</span><span class="p">]</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">final_partition_cmaps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selected_idxs</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">][</span><span class="n">spearman_th</span><span class="p">])</span>
    <span class="n">coms</span> <span class="o">=</span> <span class="n">cdlib_algorithms</span><span class="o">.</span><span class="n">louvain</span><span class="p">(</span>
        <span class="n">g_original</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
        <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="n">x0</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">partition</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="s1">&#39;community&#39;</span><span class="p">,</span> <span class="s1">&#39;partition&#39;</span><span class="p">,</span> <span class="n">community</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">filter_islands</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">],</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">min_com_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">nx_comm</span><span class="o">.</span><span class="n">modularity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">communities</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_idxs</span><span class="p">),</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;idx = </span><span class="si">{:d}</span><span class="se">\n</span><span class="s2">q = </span><span class="si">{:.2f}</span><span class="se">\n</span><span class="s2">num_comm = </span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">values</span><span class="p">()))),</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
    
    <span class="n">num_comm</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">partition</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">final_partition_cmaps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">node_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span> <span class="p">(</span><span class="n">comm_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_comm</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">comm_idx</span> <span class="ow">in</span> <span class="n">partition</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_51_0.png" src="_images/play_kmeans_parcellation-128_51_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>

<span class="n">load</span> <span class="o">=</span> <span class="n">load_organized_data</span><span class="p">(</span>
    <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;atlas-128_unfiltered_unnormalized&#39;</span><span class="p">,</span><span class="c1">#&#39;filtered_low-0.001_high-4.000_ord-2_normalized&#39;,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">subject</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">session</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">run</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;kmeans_centers&#39;</span><span class="p">]:</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;flag_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># plt.savefig(&#39;kmeans_atlas.png&#39;, dpi=300)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_54_0.png" src="_images/play_kmeans_parcellation-128_54_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_regions</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">((</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">])))</span>
<span class="n">num_regions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>128
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping_degenerate</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_regions</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">region_ids</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">][</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ii</span><span class="p">]</span>
    <span class="n">region_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">region_ids</span> <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">selected_target</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">region_ids</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mapping_degenerate</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_target</span>

<span class="n">targets_counter</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">mapping_degenerate</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="n">_counters</span> <span class="o">=</span> <span class="p">{</span><span class="n">region_id</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">region_id</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">mapping_degenerate</span><span class="o">.</span><span class="n">values</span><span class="p">())}</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">region_id</span> <span class="ow">in</span> <span class="n">mapping_degenerate</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mapping</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">_</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">region_id</span><span class="p">],</span> <span class="n">_counters</span><span class="p">[</span><span class="n">region_id</span><span class="p">])</span>
    <span class="n">_counters</span><span class="p">[</span><span class="n">region_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;R-Secondary motor area (MOs,993)_0&#39;,
 2: &#39;R-Primary motor area (MOp,985)_0&#39;,
 3: &#39;R-Secondary motor area (MOs,993)_1&#39;,
 4: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 5: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 6: &#39;R-Secondary motor area (MOs,993)_2&#39;,
 7: &#39;R-Secondary motor area (MOs,993)_3&#39;,
 8: &#39;R-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 9: &#39;R-Primary motor area (MOp,985)_1&#39;,
 10: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 11: &#39;R-Secondary motor area (MOs,993)_4&#39;,
 12: &#39;R-Prelimbic area (PL,972)_0&#39;,
 13: &#39;R-Primary motor area (MOp,985)_2&#39;,
 14: &#39;R-Secondary motor area (MOs,993)_5&#39;,
 15: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 16: &#39;L-Secondary motor area (MOs,993)_0&#39;,
 17: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_0&#39;,
 18: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 19: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 20: &#39;R-Secondary motor area (MOs,993)_6&#39;,
 21: &#39;R-Primary motor area (MOp,985)_3&#39;,
 22: &#39;R-Supplemental somatosensory area (SSs,378)_0&#39;,
 23: &#39;L-Secondary motor area (MOs,993)_1&#39;,
 24: &#39;L-Secondary motor area (MOs,993)_2&#39;,
 25: &#39;R-Secondary motor area (MOs,993)_7&#39;,
 26: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 27: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 28: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_1&#39;,
 29: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 30: &#39;L-Secondary motor area (MOs,993)_3&#39;,
 31: &#39;R-Dorsal auditory area (AUDd,1011)_0&#39;,
 32: &#39;L-Secondary motor area (MOs,993)_4&#39;,
 33: &#39;R-Primary motor area (MOp,985)_4&#39;,
 34: &#39;L-Secondary motor area (MOs,993)_5&#39;,
 35: &#39;R-Secondary motor area (MOs,993)_8&#39;,
 36: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 37: &#39;R-Secondary motor area (MOs,993)_9&#39;,
 38: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 39: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 40: &#39;L-Secondary motor area (MOs,993)_6&#39;,
 41: &#39;R-Rostrolateral visual area (VISrl,417)_0&#39;,
 42: &#39;L-Primary motor area (MOp,985)_0&#39;,
 43: &#39;L-Secondary motor area (MOs,993)_7&#39;,
 44: &#39;R-Lateral visual area (VISl,409)_0&#39;,
 45: &#39;L-Primary motor area (MOp,985)_1&#39;,
 46: &#39;R-Rostrolateral visual area (VISrl,417)_1&#39;,
 47: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 48: &#39;R-Secondary motor area (MOs,993)_10&#39;,
 49: &#39;R-Anterior area (VISa,312782546)_0&#39;,
 50: &#39;L-Secondary motor area (MOs,993)_8&#39;,
 51: &#39;R-Anterior area (VISa,312782546)_1&#39;,
 52: &#39;L-Primary motor area (MOp,985)_2&#39;,
 53: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 54: &#39;L-Primary motor area (MOp,985)_3&#39;,
 55: &#39;R-Primary visual area (VISp,385)_0&#39;,
 56: &#39;R-Lateral visual area (VISl,409)_1&#39;,
 57: &#39;L-Primary motor area (MOp,985)_4&#39;,
 58: &#39;R-Primary visual area (VISp,385)_1&#39;,
 59: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 60: &#39;L-Primary motor area (MOp,985)_5&#39;,
 61: &#39;L-Primary motor area (MOp,985)_6&#39;,
 62: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 63: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 64: &#39;R-Primary visual area (VISp,385)_2&#39;,
 65: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 66: &#39;R-Primary visual area (VISp,385)_3&#39;,
 67: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 68: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 69: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 70: &#39;R-Primary visual area (VISp,385)_4&#39;,
 71: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 72: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 73: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 74: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 75: &#39;R-Primary visual area (VISp,385)_5&#39;,
 76: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 77: &#39;R-Primary visual area (VISp,385)_6&#39;,
 78: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 79: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 80: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 81: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 82: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 83: &#39;R-Primary visual area (VISp,385)_7&#39;,
 84: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 85: &#39;R-Primary visual area (VISp,385)_8&#39;,
 86: &#39;L-Anterior area (VISa,312782546)_0&#39;,
 87: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 88: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 89: &#39;R-Primary visual area (VISp,385)_9&#39;,
 90: &#39;R-Primary visual area (VISp,385)_10&#39;,
 91: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 92: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 93: &#39;L-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 94: &#39;L-Anteromedial visual area (VISam,394)_0&#39;,
 95: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 96: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 97: &#39;R-Primary visual area (VISp,385)_11&#39;,
 98: &#39;L-Anterior area (VISa,312782546)_1&#39;,
 99: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 100: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 101: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 102: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 103: &#39;L-posteromedial visual area (VISpm,533)_0&#39;,
 104: &#39;L-Anteromedial visual area (VISam,394)_1&#39;,
 105: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 106: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 107: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 108: &#39;L-Rostrolateral visual area (VISrl,417)_0&#39;,
 109: &#39;L-Supplemental somatosensory area (SSs,378)_0&#39;,
 110: &#39;L-Primary visual area (VISp,385)_0&#39;,
 111: &#39;L-Primary visual area (VISp,385)_1&#39;,
 112: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 113: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 114: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 115: &#39;L-Dorsal auditory area (AUDd,1011)_0&#39;,
 116: &#39;L-Primary visual area (VISp,385)_2&#39;,
 117: &#39;L-Anterolateral visual area (VISal,402)_0&#39;,
 118: &#39;L-Primary visual area (VISp,385)_3&#39;,
 119: &#39;L-Primary visual area (VISp,385)_4&#39;,
 120: &#39;L-Primary visual area (VISp,385)_5&#39;,
 121: &#39;L-Primary auditory area (AUDp,1002)_0&#39;,
 122: &#39;L-Primary visual area (VISp,385)_6&#39;,
 123: &#39;L-Posterior auditory area (AUDpo,1027)_0&#39;,
 124: &#39;L-Primary visual area (VISp,385)_7&#39;,
 125: &#39;L-Primary visual area (VISp,385)_8&#39;,
 126: &#39;L-Lateral visual area (VISl,409)_0&#39;,
 127: &#39;L-Lateral visual area (VISl,409)_1&#39;,
 128: &#39;L-Primary visual area (VISp,385)_9&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extract_info</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;R-&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">hemisphere</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hemisphere</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">shortened_name</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">processed_name</span> <span class="o">=</span> <span class="n">shortened_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hemisphere</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">shortened_name</span><span class="p">,</span> <span class="n">processed_name</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_r</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">hemisphere</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">shortened_name</span><span class="p">,</span> <span class="n">processed_name</span> <span class="o">=</span> <span class="n">extract_info</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
        <span class="n">all_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">all_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_name</span><span class="p">)</span>
        
<span class="n">all_regions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_r</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_l</span><span class="p">))</span>
<span class="n">all_regions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_regions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_heads</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">all_regions</span><span class="p">])</span>
<span class="n">region_heads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">region_heads</span><span class="p">)</span>
<span class="n">region_heads</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;SSp-tr&#39;,
 &#39;MOp&#39;,
 &#39;VISrl&#39;,
 &#39;VISl&#39;,
 &#39;SSp-bfd&#39;,
 &#39;RSPd&#39;,
 &#39;SSp-ul&#39;,
 &#39;RSPagl&#39;,
 &#39;VISp&#39;,
 &#39;MOs&#39;,
 &#39;AUDd&#39;,
 &#39;SSp-ll&#39;,
 &#39;SSs&#39;,
 &#39;SSp-m&#39;,
 &#39;SSp-n&#39;,
 &#39;VISa&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">region_heads</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_regions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(16, 52)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_regions</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;SSp-n\t353_0&#39;,
 &#39;MOp\t985_0&#39;,
 &#39;AUDd\t1011_0&#39;,
 &#39;MOp\t985_4&#39;,
 &#39;SSp-m\t345_1&#39;,
 &#39;MOs\t993_8&#39;,
 &#39;VISrl\t417_0&#39;,
 &#39;VISa\t312782546_0&#39;,
 &#39;VISp\t385_7&#39;,
 &#39;MOp\t985_2&#39;,
 &#39;MOs\t993_0&#39;,
 &#39;VISl\t409_0&#39;,
 &#39;SSp-bfd\t329_1&#39;,
 &#39;SSp-ul\t369_1&#39;,
 &#39;MOs\t993_6&#39;,
 &#39;RSPagl\t894_1&#39;,
 &#39;MOs\t993_3&#39;,
 &#39;VISl\t409_1&#39;,
 &#39;RSPd\t879_2&#39;,
 &#39;MOp\t985_1&#39;,
 &#39;RSPd\t879_3&#39;,
 &#39;VISp\t385_2&#39;,
 &#39;VISp\t385_0&#39;,
 &#39;MOs\t993_4&#39;,
 &#39;SSp-bfd\t329_2&#39;,
 &#39;VISp\t385_3&#39;,
 &#39;MOs\t993_2&#39;,
 &#39;MOs\t993_1&#39;,
 &#39;SSp-ll\t337_0&#39;,
 &#39;RSPd\t879_1&#39;,
 &#39;MOp\t985_3&#39;,
 &#39;SSp-bfd\t329_0&#39;,
 &#39;VISp\t385_4&#39;,
 &#39;SSp-ul\t369_0&#39;,
 &#39;SSp-ll\t337_1&#39;,
 &#39;SSp-m\t345_0&#39;,
 &#39;SSs\t378_0&#39;,
 &#39;MOs\t993_7&#39;,
 &#39;VISp\t385_8&#39;,
 &#39;VISp\t385_9&#39;,
 &#39;RSPd\t879_0&#39;,
 &#39;SSp-bfd\t329_3&#39;,
 &#39;RSPd\t879_4&#39;,
 &#39;SSp-ul\t369_2&#39;,
 &#39;SSp-tr\t361_0&#39;,
 &#39;VISp\t385_6&#39;,
 &#39;VISp\t385_1&#39;,
 &#39;RSPd\t879_5&#39;,
 &#39;RSPagl\t894_0&#39;,
 &#39;VISa\t312782546_1&#39;,
 &#39;MOs\t993_5&#39;,
 &#39;VISp\t385_5&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r2i</span><span class="p">,</span> <span class="n">i2r</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">processed_name</span> <span class="o">=</span> <span class="n">extract_info</span><span class="p">(</span><span class="n">string</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">processed_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_regions</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r2i</span><span class="p">[</span><span class="n">processed_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ii</span>

<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">r2i</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">i2r</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">region</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">r2i</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(52, 52)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="n">num_regions</span><span class="p">)</span>
<span class="n">colors_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

<span class="n">colors_rgb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_list</span><span class="p">:</span>
    <span class="n">colors_rgb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">255</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">color</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<span class="n">lines_map</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">long_name</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">hemisphere</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">shortened_name</span><span class="p">,</span> <span class="n">processed_name</span> <span class="o">=</span> <span class="n">extract_info</span><span class="p">(</span><span class="n">long_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hemisphere</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="n">line</span> <span class="o">=</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="n">processed_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">processed_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">colors_rgb</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">colors_rgb</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">colors_rgb</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">final_partition_cmaps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ii</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">final_partition_cmaps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ii</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">final_partition_cmaps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ii</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">final_partition_cmaps</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ii</span><span class="p">]),</span>
         <span class="nb">str</span><span class="p">(</span><span class="n">final_partition_cmaps</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ii</span><span class="p">]),]</span>
    <span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">lines_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">lines_map</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lines_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">lines_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>63
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circos_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Documents/workspaces/circos/circos-projects/mouse&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pjoin</span><span class="p">(</span><span class="n">circos_dir</span><span class="p">,</span> <span class="s1">&#39;map.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines_map</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">viz_th</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">a</span><span class="p">[</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">viz_th</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines_links</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">long_name_i</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">node_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">long_name_j</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">node_labels</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
    
    <span class="n">hemisphere_i</span><span class="p">,</span> <span class="n">name_i</span><span class="p">,</span> <span class="n">shortened_name_i</span><span class="p">,</span> <span class="n">processed_name_i</span> <span class="o">=</span> <span class="n">extract_info</span><span class="p">(</span><span class="n">long_name_i</span><span class="p">)</span>
    <span class="n">hemisphere_j</span><span class="p">,</span> <span class="n">name_j</span><span class="p">,</span> <span class="n">shortened_name_j</span><span class="p">,</span> <span class="n">processed_name_j</span> <span class="o">=</span> <span class="n">extract_info</span><span class="p">(</span><span class="n">long_name_j</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="mf">0.7</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.9</span><span class="p">:</span>
        <span class="n">edge_type</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="mf">0.9</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]:</span>
        <span class="n">edge_type</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">line</span> <span class="o">=</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="n">hemisphere_i</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="n">processed_name_i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">hemisphere_j</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="n">processed_name_j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">edge_type</span><span class="p">),</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]),]</span>
    <span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    
    <span class="n">cond_i</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed_name_i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">lines_map</span><span class="p">))</span>
    <span class="n">cond_j</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed_name_j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">lines_map</span><span class="p">))</span>
    <span class="n">cond_inter_region_1</span> <span class="o">=</span> <span class="n">processed_name_i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">processed_name_j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cond_inter_region_2</span> <span class="o">=</span> <span class="n">processed_name_i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">processed_name_j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cond_inter_hemisphere</span> <span class="o">=</span> <span class="n">hemisphere_i</span> <span class="o">!=</span> <span class="n">hemisphere_j</span>

    <span class="k">if</span> <span class="n">cond_i</span> <span class="ow">and</span> <span class="n">cond_j</span> <span class="ow">and</span> <span class="n">cond_inter_region_1</span> <span class="ow">and</span> <span class="n">cond_inter_region_2</span> <span class="ow">and</span> <span class="n">cond_inter_hemisphere</span><span class="p">:</span>
        <span class="n">lines_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">lines_links</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>511
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circos_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Documents/workspaces/circos/circos-projects/mouse&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pjoin</span><span class="p">(</span><span class="n">circos_dir</span><span class="p">,</span> <span class="s1">&#39;map.links.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines_links</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;R-Secondary motor area (MOs,993)_0&#39;,
 2: &#39;R-Primary motor area (MOp,985)_0&#39;,
 3: &#39;R-Primary motor area (MOp,985)_1&#39;,
 4: &#39;R-Secondary motor area (MOs,993)_1&#39;,
 5: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 6: &#39;R-Secondary motor area (MOs,993)_2&#39;,
 7: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 8: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_2&#39;,
 9: &#39;R-Secondary motor area (MOs,993)_3&#39;,
 10: &#39;R-Primary motor area (MOp,985)_2&#39;,
 11: &#39;R-Primary motor area (MOp,985)_3&#39;,
 12: &#39;R-Secondary motor area (MOs,993)_4&#39;,
 13: &#39;R-Secondary motor area (MOs,993)_5&#39;,
 14: &#39;R-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 15: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 16: &#39;R-Secondary motor area (MOs,993)_6&#39;,
 17: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 18: &#39;R-Secondary motor area (MOs,993)_7&#39;,
 19: &#39;R-Primary motor area (MOp,985)_4&#39;,
 20: &#39;R-Prelimbic area (PL,972)_0&#39;,
 21: &#39;R-Secondary motor area (MOs,993)_8&#39;,
 22: &#39;R-Primary somatosensory area, nose (SSp-n,353)_1&#39;,
 23: &#39;R-Primary somatosensory area, nose (SSp-n,353)_2&#39;,
 24: &#39;R-Primary motor area (MOp,985)_5&#39;,
 25: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 26: &#39;R-Secondary motor area (MOs,993)_9&#39;,
 27: &#39;R-Secondary motor area (MOs,993)_10&#39;,
 28: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 29: &#39;L-Secondary motor area (MOs,993)_0&#39;,
 30: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 31: &#39;R-Secondary motor area (MOs,993)_11&#39;,
 32: &#39;R-Secondary motor area (MOs,993)_12&#39;,
 33: &#39;R-Primary motor area (MOp,985)_6&#39;,
 34: &#39;L-Secondary motor area (MOs,993)_1&#39;,
 35: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_3&#39;,
 36: &#39;R-Primary somatosensory area, unassigned (SSp-un,182305689)_0&#39;,
 37: &#39;R-Supplemental somatosensory area (SSs,378)_0&#39;,
 38: &#39;L-Secondary motor area (MOs,993)_2&#39;,
 39: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 40: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_0&#39;,
 41: &#39;R-Secondary motor area (MOs,993)_13&#39;,
 42: &#39;L-Secondary motor area (MOs,993)_3&#39;,
 43: &#39;R-Primary motor area (MOp,985)_7&#39;,
 44: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 45: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 46: &#39;R-Supplemental somatosensory area (SSs,378)_1&#39;,
 47: &#39;L-Secondary motor area (MOs,993)_4&#39;,
 48: &#39;R-Secondary motor area (MOs,993)_14&#39;,
 49: &#39;L-Secondary motor area (MOs,993)_5&#39;,
 50: &#39;R-Secondary motor area (MOs,993)_15&#39;,
 51: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_4&#39;,
 52: &#39;L-Secondary motor area (MOs,993)_6&#39;,
 53: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 54: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 55: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 56: &#39;L-Secondary motor area (MOs,993)_7&#39;,
 57: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_1&#39;,
 58: &#39;R-Dorsal auditory area (AUDd,1011)_0&#39;,
 59: &#39;L-Secondary motor area (MOs,993)_8&#39;,
 60: &#39;R-Primary motor area (MOp,985)_8&#39;,
 61: &#39;R-Secondary motor area (MOs,993)_16&#39;,
 62: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_2&#39;,
 63: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_6&#39;,
 64: &#39;L-Secondary motor area (MOs,993)_9&#39;,
 65: &#39;L-Secondary motor area (MOs,993)_10&#39;,
 66: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_7&#39;,
 67: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_8&#39;,
 68: &#39;R-Dorsal auditory area (AUDd,1011)_1&#39;,
 69: &#39;L-Secondary motor area (MOs,993)_11&#39;,
 70: &#39;L-Secondary motor area (MOs,993)_12&#39;,
 71: &#39;R-Secondary motor area (MOs,993)_17&#39;,
 72: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_3&#39;,
 73: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_4&#39;,
 74: &#39;L-Secondary motor area (MOs,993)_13&#39;,
 75: &#39;L-Secondary motor area (MOs,993)_14&#39;,
 76: &#39;R-Primary motor area (MOp,985)_9&#39;,
 77: &#39;R-Anterolateral visual area (VISal,402)_0&#39;,
 78: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_2&#39;,
 79: &#39;R-Anterior area (VISa,312782546)_0&#39;,
 80: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_9&#39;,
 81: &#39;R-Posterior auditory area (AUDpo,1027)_0&#39;,
 82: &#39;L-Primary motor area (MOp,985)_0&#39;,
 83: &#39;L-Primary motor area (MOp,985)_1&#39;,
 84: &#39;L-Secondary motor area (MOs,993)_15&#39;,
 85: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 86: &#39;L-Secondary motor area (MOs,993)_16&#39;,
 87: &#39;R-Secondary motor area (MOs,993)_18&#39;,
 88: &#39;L-Secondary motor area (MOs,993)_17&#39;,
 89: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 90: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_1&#39;,
 91: &#39;R-Anterolateral visual area (VISal,402)_1&#39;,
 92: &#39;L-Secondary motor area (MOs,993)_18&#39;,
 93: &#39;L-Secondary motor area (MOs,993)_19&#39;,
 94: &#39;R-Rostrolateral visual area (VISrl,417)_0&#39;,
 95: &#39;R-Secondary motor area (MOs,993)_19&#39;,
 96: &#39;R-Anterior area (VISa,312782546)_1&#39;,
 97: &#39;R-Primary visual area (VISp,385)_0&#39;,
 98: &#39;R-Lateral visual area (VISl,409)_0&#39;,
 99: &#39;L-Primary motor area (MOp,985)_2&#39;,
 100: &#39;L-Secondary motor area (MOs,993)_20&#39;,
 101: &#39;R-Anterior area (VISa,312782546)_2&#39;,
 102: &#39;L-Primary motor area (MOp,985)_3&#39;,
 103: &#39;L-Primary motor area (MOp,985)_4&#39;,
 104: &#39;L-Primary motor area (MOp,985)_5&#39;,
 105: &#39;L-Primary motor area (MOp,985)_6&#39;,
 106: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_3&#39;,
 107: &#39;L-Secondary motor area (MOs,993)_21&#39;,
 108: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 109: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 110: &#39;R-Primary visual area (VISp,385)_1&#39;,
 111: &#39;L-Primary motor area (MOp,985)_7&#39;,
 112: &#39;L-Secondary motor area (MOs,993)_22&#39;,
 113: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 114: &#39;R-Primary visual area (VISp,385)_2&#39;,
 115: &#39;R-Primary visual area (VISp,385)_3&#39;,
 116: &#39;R-Lateral visual area (VISl,409)_1&#39;,
 117: &#39;R-Anteromedial visual area (VISam,394)_0&#39;,
 118: &#39;R-Primary visual area (VISp,385)_4&#39;,
 119: &#39;L-Primary motor area (MOp,985)_8&#39;,
 120: &#39;L-Primary motor area (MOp,985)_9&#39;,
 121: &#39;L-Secondary motor area (MOs,993)_23&#39;,
 122: &#39;R-Anteromedial visual area (VISam,394)_1&#39;,
 123: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 124: &#39;L-Primary motor area (MOp,985)_10&#39;,
 125: &#39;L-Primary motor area (MOp,985)_11&#39;,
 126: &#39;R-Primary visual area (VISp,385)_5&#39;,
 127: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 128: &#39;R-Primary visual area (VISp,385)_6&#39;,
 129: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 130: &#39;R-Retrosplenial area, ventral part (RSPv,886)_0&#39;,
 131: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 132: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 133: &#39;R-Primary visual area (VISp,385)_7&#39;,
 134: &#39;R-posteromedial visual area (VISpm,533)_0&#39;,
 135: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 136: &#39;L-Primary motor area (MOp,985)_12&#39;,
 137: &#39;R-Anteromedial visual area (VISam,394)_2&#39;,
 138: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 139: &#39;R-Primary visual area (VISp,385)_8&#39;,
 140: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 141: &#39;R-Primary visual area (VISp,385)_9&#39;,
 142: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 143: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_2&#39;,
 144: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 145: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 146: &#39;R-Primary visual area (VISp,385)_10&#39;,
 147: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 148: &#39;R-Primary visual area (VISp,385)_11&#39;,
 149: &#39;R-Retrosplenial area, ventral part (RSPv,886)_1&#39;,
 150: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 151: &#39;R-posteromedial visual area (VISpm,533)_1&#39;,
 152: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 153: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 154: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_3&#39;,
 155: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 156: &#39;R-Primary visual area (VISp,385)_12&#39;,
 157: &#39;R-Primary visual area (VISp,385)_13&#39;,
 158: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_2&#39;,
 159: &#39;R-Primary visual area (VISp,385)_14&#39;,
 160: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_3&#39;,
 161: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 162: &#39;L-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 163: &#39;R-Primary visual area (VISp,385)_15&#39;,
 164: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 165: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 166: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_1&#39;,
 167: &#39;R-Primary visual area (VISp,385)_16&#39;,
 168: &#39;R-Retrosplenial area, ventral part (RSPv,886)_2&#39;,
 169: &#39;L-Primary somatosensory area, unassigned (SSp-un,182305689)_0&#39;,
 170: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 171: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 172: &#39;R-posteromedial visual area (VISpm,533)_2&#39;,
 173: &#39;R-Primary visual area (VISp,385)_17&#39;,
 174: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 175: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_4&#39;,
 176: &#39;L-Anterior area (VISa,312782546)_0&#39;,
 177: &#39;R-Primary visual area (VISp,385)_18&#39;,
 178: &#39;L-Primary somatosensory area, nose (SSp-n,353)_1&#39;,
 179: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 180: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 181: &#39;L-Primary somatosensory area, nose (SSp-n,353)_2&#39;,
 182: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_2&#39;,
 183: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 184: &#39;R-Primary visual area (VISp,385)_19&#39;,
 185: &#39;R-Midbrain, sensory related (MBsen,339)_0&#39;,
 186: &#39;L-Retrosplenial area, ventral part (RSPv,886)_0&#39;,
 187: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 188: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_9&#39;,
 189: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 190: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 191: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 192: &#39;L-Anterior area (VISa,312782546)_1&#39;,
 193: &#39;L-Anteromedial visual area (VISam,394)_0&#39;,
 194: &#39;R-Midbrain, sensory related (MBsen,339)_1&#39;,
 195: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 196: &#39;L-Primary somatosensory area, nose (SSp-n,353)_3&#39;,
 197: &#39;L-Anteromedial visual area (VISam,394)_1&#39;,
 198: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 199: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 200: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_4&#39;,
 201: &#39;L-Anterior area (VISa,312782546)_2&#39;,
 202: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 203: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 204: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 205: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_1&#39;,
 206: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 207: &#39;L-Primary visual area (VISp,385)_0&#39;,
 208: &#39;L-posteromedial visual area (VISpm,533)_0&#39;,
 209: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 210: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_6&#39;,
 211: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_7&#39;,
 212: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 213: &#39;L-Rostrolateral visual area (VISrl,417)_0&#39;,
 214: &#39;L-posteromedial visual area (VISpm,533)_1&#39;,
 215: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_1&#39;,
 216: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_8&#39;,
 217: &#39;L-posteromedial visual area (VISpm,533)_2&#39;,
 218: &#39;L-Supplemental somatosensory area (SSs,378)_0&#39;,
 219: &#39;L-Primary visual area (VISp,385)_1&#39;,
 220: &#39;L-Primary visual area (VISp,385)_2&#39;,
 221: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_4&#39;,
 222: &#39;L-Supplemental somatosensory area (SSs,378)_1&#39;,
 223: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_9&#39;,
 224: &#39;L-Rostrolateral visual area (VISrl,417)_1&#39;,
 225: &#39;L-posteromedial visual area (VISpm,533)_3&#39;,
 226: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_2&#39;,
 227: &#39;L-Primary visual area (VISp,385)_3&#39;,
 228: &#39;L-Dorsal auditory area (AUDd,1011)_0&#39;,
 229: &#39;L-Primary visual area (VISp,385)_4&#39;,
 230: &#39;L-Primary visual area (VISp,385)_5&#39;,
 231: &#39;L-Primary visual area (VISp,385)_6&#39;,
 232: &#39;L-Primary visual area (VISp,385)_7&#39;,
 233: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_5&#39;,
 234: &#39;L-Dorsal auditory area (AUDd,1011)_1&#39;,
 235: &#39;L-Anterolateral visual area (VISal,402)_0&#39;,
 236: &#39;L-Primary visual area (VISp,385)_8&#39;,
 237: &#39;L-Primary auditory area (AUDp,1002)_0&#39;,
 238: &#39;L-Primary visual area (VISp,385)_9&#39;,
 239: &#39;L-Primary visual area (VISp,385)_10&#39;,
 240: &#39;L-Primary visual area (VISp,385)_11&#39;,
 241: &#39;L-Primary visual area (VISp,385)_12&#39;,
 242: &#39;L-Lateral visual area (VISl,409)_0&#39;,
 243: &#39;L-Primary visual area (VISp,385)_13&#39;,
 244: &#39;L-Primary auditory area (AUDp,1002)_1&#39;,
 245: &#39;L-Lateral visual area (VISl,409)_1&#39;,
 246: &#39;L-Posterior auditory area (AUDpo,1027)_0&#39;,
 247: &#39;L-Primary visual area (VISp,385)_14&#39;,
 248: &#39;L-Lateral visual area (VISl,409)_2&#39;,
 249: &#39;L-Primary visual area (VISp,385)_15&#39;,
 250: &#39;L-Primary visual area (VISp,385)_16&#39;,
 251: &#39;L-Temporal association areas (TEa,541)_0&#39;,
 252: &#39;L-Lateral visual area (VISl,409)_3&#39;,
 253: &#39;L-Primary visual area (VISp,385)_17&#39;,
 254: &#39;L-Primary visual area (VISp,385)_18&#39;,
 255: &#39;L-Lateral visual area (VISl,409)_4&#39;,
 256: &#39;L-Posterolateral visual area (VISpl,425)_0&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">region_head</span> <span class="ow">in</span> <span class="n">region_heads</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">region_head</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SSs
MOs
AUDpo
RSPd
VISl
RSPagl
SSp-n
VISal
SSp-m
VISp
VISa
VISpm
SSp-bfd
AUDd
SSp-un
SSp-ll
SSp-ul
RSPv
VISam
MOp
SSp-tr
VISrl
SCsg
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="c1">#line = &quot;{:s}{:s}{:s}\t{:s}\t{:d}\t{:.4f}&quot;</span>
    <span class="c1">#line = line.format(</span>
        <span class="n">hemisphere_i</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="n">processed_name_i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">hemisphere_j</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="n">processed_name_j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">edge_type</span><span class="p">,</span>
        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hemisphere_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;L&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pjoin</span><span class="p">(</span><span class="n">dirdir</span><span class="p">,</span> <span class="s1">&#39;map.links.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">read_lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">read_lines</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r SbCG/S r SupTGLp 1 0.45523726797073
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;R-Secondary motor area (MOs,993)_0&#39;,
 2: &#39;R-Primary motor area (MOp,985)_0&#39;,
 3: &#39;R-Primary motor area (MOp,985)_1&#39;,
 4: &#39;R-Secondary motor area (MOs,993)_1&#39;,
 5: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 6: &#39;R-Secondary motor area (MOs,993)_2&#39;,
 7: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 8: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_2&#39;,
 9: &#39;R-Secondary motor area (MOs,993)_3&#39;,
 10: &#39;R-Primary motor area (MOp,985)_2&#39;,
 11: &#39;R-Primary motor area (MOp,985)_3&#39;,
 12: &#39;R-Secondary motor area (MOs,993)_4&#39;,
 13: &#39;R-Secondary motor area (MOs,993)_5&#39;,
 14: &#39;R-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 15: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 16: &#39;R-Secondary motor area (MOs,993)_6&#39;,
 17: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 18: &#39;R-Secondary motor area (MOs,993)_7&#39;,
 19: &#39;R-Primary motor area (MOp,985)_4&#39;,
 20: &#39;R-Prelimbic area (PL,972)_0&#39;,
 21: &#39;R-Secondary motor area (MOs,993)_8&#39;,
 22: &#39;R-Primary somatosensory area, nose (SSp-n,353)_1&#39;,
 23: &#39;R-Primary somatosensory area, nose (SSp-n,353)_2&#39;,
 24: &#39;R-Primary motor area (MOp,985)_5&#39;,
 25: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 26: &#39;R-Secondary motor area (MOs,993)_9&#39;,
 27: &#39;R-Secondary motor area (MOs,993)_10&#39;,
 28: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 29: &#39;L-Secondary motor area (MOs,993)_0&#39;,
 30: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 31: &#39;R-Secondary motor area (MOs,993)_11&#39;,
 32: &#39;R-Secondary motor area (MOs,993)_12&#39;,
 33: &#39;R-Primary motor area (MOp,985)_6&#39;,
 34: &#39;L-Secondary motor area (MOs,993)_1&#39;,
 35: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_3&#39;,
 36: &#39;R-Primary somatosensory area, unassigned (SSp-un,182305689)_0&#39;,
 37: &#39;R-Supplemental somatosensory area (SSs,378)_0&#39;,
 38: &#39;L-Secondary motor area (MOs,993)_2&#39;,
 39: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 40: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_0&#39;,
 41: &#39;R-Secondary motor area (MOs,993)_13&#39;,
 42: &#39;L-Secondary motor area (MOs,993)_3&#39;,
 43: &#39;R-Primary motor area (MOp,985)_7&#39;,
 44: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 45: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 46: &#39;R-Supplemental somatosensory area (SSs,378)_1&#39;,
 47: &#39;L-Secondary motor area (MOs,993)_4&#39;,
 48: &#39;R-Secondary motor area (MOs,993)_14&#39;,
 49: &#39;L-Secondary motor area (MOs,993)_5&#39;,
 50: &#39;R-Secondary motor area (MOs,993)_15&#39;,
 51: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_4&#39;,
 52: &#39;L-Secondary motor area (MOs,993)_6&#39;,
 53: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 54: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 55: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 56: &#39;L-Secondary motor area (MOs,993)_7&#39;,
 57: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_1&#39;,
 58: &#39;R-Dorsal auditory area (AUDd,1011)_0&#39;,
 59: &#39;L-Secondary motor area (MOs,993)_8&#39;,
 60: &#39;R-Primary motor area (MOp,985)_8&#39;,
 61: &#39;R-Secondary motor area (MOs,993)_16&#39;,
 62: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_2&#39;,
 63: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_6&#39;,
 64: &#39;L-Secondary motor area (MOs,993)_9&#39;,
 65: &#39;L-Secondary motor area (MOs,993)_10&#39;,
 66: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_7&#39;,
 67: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_8&#39;,
 68: &#39;R-Dorsal auditory area (AUDd,1011)_1&#39;,
 69: &#39;L-Secondary motor area (MOs,993)_11&#39;,
 70: &#39;L-Secondary motor area (MOs,993)_12&#39;,
 71: &#39;R-Secondary motor area (MOs,993)_17&#39;,
 72: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_3&#39;,
 73: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_4&#39;,
 74: &#39;L-Secondary motor area (MOs,993)_13&#39;,
 75: &#39;L-Secondary motor area (MOs,993)_14&#39;,
 76: &#39;R-Primary motor area (MOp,985)_9&#39;,
 77: &#39;R-Anterolateral visual area (VISal,402)_0&#39;,
 78: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_2&#39;,
 79: &#39;R-Anterior area (VISa,312782546)_0&#39;,
 80: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_9&#39;,
 81: &#39;R-Posterior auditory area (AUDpo,1027)_0&#39;,
 82: &#39;L-Primary motor area (MOp,985)_0&#39;,
 83: &#39;L-Primary motor area (MOp,985)_1&#39;,
 84: &#39;L-Secondary motor area (MOs,993)_15&#39;,
 85: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 86: &#39;L-Secondary motor area (MOs,993)_16&#39;,
 87: &#39;R-Secondary motor area (MOs,993)_18&#39;,
 88: &#39;L-Secondary motor area (MOs,993)_17&#39;,
 89: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 90: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_1&#39;,
 91: &#39;R-Anterolateral visual area (VISal,402)_1&#39;,
 92: &#39;L-Secondary motor area (MOs,993)_18&#39;,
 93: &#39;L-Secondary motor area (MOs,993)_19&#39;,
 94: &#39;R-Rostrolateral visual area (VISrl,417)_0&#39;,
 95: &#39;R-Secondary motor area (MOs,993)_19&#39;,
 96: &#39;R-Anterior area (VISa,312782546)_1&#39;,
 97: &#39;R-Primary visual area (VISp,385)_0&#39;,
 98: &#39;R-Lateral visual area (VISl,409)_0&#39;,
 99: &#39;L-Primary motor area (MOp,985)_2&#39;,
 100: &#39;L-Secondary motor area (MOs,993)_20&#39;,
 101: &#39;R-Anterior area (VISa,312782546)_2&#39;,
 102: &#39;L-Primary motor area (MOp,985)_3&#39;,
 103: &#39;L-Primary motor area (MOp,985)_4&#39;,
 104: &#39;L-Primary motor area (MOp,985)_5&#39;,
 105: &#39;L-Primary motor area (MOp,985)_6&#39;,
 106: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_3&#39;,
 107: &#39;L-Secondary motor area (MOs,993)_21&#39;,
 108: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 109: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 110: &#39;R-Primary visual area (VISp,385)_1&#39;,
 111: &#39;L-Primary motor area (MOp,985)_7&#39;,
 112: &#39;L-Secondary motor area (MOs,993)_22&#39;,
 113: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 114: &#39;R-Primary visual area (VISp,385)_2&#39;,
 115: &#39;R-Primary visual area (VISp,385)_3&#39;,
 116: &#39;R-Lateral visual area (VISl,409)_1&#39;,
 117: &#39;R-Anteromedial visual area (VISam,394)_0&#39;,
 118: &#39;R-Primary visual area (VISp,385)_4&#39;,
 119: &#39;L-Primary motor area (MOp,985)_8&#39;,
 120: &#39;L-Primary motor area (MOp,985)_9&#39;,
 121: &#39;L-Secondary motor area (MOs,993)_23&#39;,
 122: &#39;R-Anteromedial visual area (VISam,394)_1&#39;,
 123: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 124: &#39;L-Primary motor area (MOp,985)_10&#39;,
 125: &#39;L-Primary motor area (MOp,985)_11&#39;,
 126: &#39;R-Primary visual area (VISp,385)_5&#39;,
 127: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 128: &#39;R-Primary visual area (VISp,385)_6&#39;,
 129: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 130: &#39;R-Retrosplenial area, ventral part (RSPv,886)_0&#39;,
 131: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 132: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 133: &#39;R-Primary visual area (VISp,385)_7&#39;,
 134: &#39;R-posteromedial visual area (VISpm,533)_0&#39;,
 135: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 136: &#39;L-Primary motor area (MOp,985)_12&#39;,
 137: &#39;R-Anteromedial visual area (VISam,394)_2&#39;,
 138: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 139: &#39;R-Primary visual area (VISp,385)_8&#39;,
 140: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 141: &#39;R-Primary visual area (VISp,385)_9&#39;,
 142: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 143: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_2&#39;,
 144: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 145: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 146: &#39;R-Primary visual area (VISp,385)_10&#39;,
 147: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 148: &#39;R-Primary visual area (VISp,385)_11&#39;,
 149: &#39;R-Retrosplenial area, ventral part (RSPv,886)_1&#39;,
 150: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 151: &#39;R-posteromedial visual area (VISpm,533)_1&#39;,
 152: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 153: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 154: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_3&#39;,
 155: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 156: &#39;R-Primary visual area (VISp,385)_12&#39;,
 157: &#39;R-Primary visual area (VISp,385)_13&#39;,
 158: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_2&#39;,
 159: &#39;R-Primary visual area (VISp,385)_14&#39;,
 160: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_3&#39;,
 161: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 162: &#39;L-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 163: &#39;R-Primary visual area (VISp,385)_15&#39;,
 164: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 165: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 166: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_1&#39;,
 167: &#39;R-Primary visual area (VISp,385)_16&#39;,
 168: &#39;R-Retrosplenial area, ventral part (RSPv,886)_2&#39;,
 169: &#39;L-Primary somatosensory area, unassigned (SSp-un,182305689)_0&#39;,
 170: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 171: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 172: &#39;R-posteromedial visual area (VISpm,533)_2&#39;,
 173: &#39;R-Primary visual area (VISp,385)_17&#39;,
 174: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 175: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_4&#39;,
 176: &#39;L-Anterior area (VISa,312782546)_0&#39;,
 177: &#39;R-Primary visual area (VISp,385)_18&#39;,
 178: &#39;L-Primary somatosensory area, nose (SSp-n,353)_1&#39;,
 179: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 180: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 181: &#39;L-Primary somatosensory area, nose (SSp-n,353)_2&#39;,
 182: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_2&#39;,
 183: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 184: &#39;R-Primary visual area (VISp,385)_19&#39;,
 185: &#39;R-Midbrain, sensory related (MBsen,339)_0&#39;,
 186: &#39;L-Retrosplenial area, ventral part (RSPv,886)_0&#39;,
 187: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 188: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_9&#39;,
 189: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 190: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 191: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 192: &#39;L-Anterior area (VISa,312782546)_1&#39;,
 193: &#39;L-Anteromedial visual area (VISam,394)_0&#39;,
 194: &#39;R-Midbrain, sensory related (MBsen,339)_1&#39;,
 195: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 196: &#39;L-Primary somatosensory area, nose (SSp-n,353)_3&#39;,
 197: &#39;L-Anteromedial visual area (VISam,394)_1&#39;,
 198: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 199: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 200: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_4&#39;,
 201: &#39;L-Anterior area (VISa,312782546)_2&#39;,
 202: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 203: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 204: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 205: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_1&#39;,
 206: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 207: &#39;L-Primary visual area (VISp,385)_0&#39;,
 208: &#39;L-posteromedial visual area (VISpm,533)_0&#39;,
 209: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 210: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_6&#39;,
 211: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_7&#39;,
 212: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 213: &#39;L-Rostrolateral visual area (VISrl,417)_0&#39;,
 214: &#39;L-posteromedial visual area (VISpm,533)_1&#39;,
 215: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_1&#39;,
 216: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_8&#39;,
 217: &#39;L-posteromedial visual area (VISpm,533)_2&#39;,
 218: &#39;L-Supplemental somatosensory area (SSs,378)_0&#39;,
 219: &#39;L-Primary visual area (VISp,385)_1&#39;,
 220: &#39;L-Primary visual area (VISp,385)_2&#39;,
 221: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_4&#39;,
 222: &#39;L-Supplemental somatosensory area (SSs,378)_1&#39;,
 223: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_9&#39;,
 224: &#39;L-Rostrolateral visual area (VISrl,417)_1&#39;,
 225: &#39;L-posteromedial visual area (VISpm,533)_3&#39;,
 226: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_2&#39;,
 227: &#39;L-Primary visual area (VISp,385)_3&#39;,
 228: &#39;L-Dorsal auditory area (AUDd,1011)_0&#39;,
 229: &#39;L-Primary visual area (VISp,385)_4&#39;,
 230: &#39;L-Primary visual area (VISp,385)_5&#39;,
 231: &#39;L-Primary visual area (VISp,385)_6&#39;,
 232: &#39;L-Primary visual area (VISp,385)_7&#39;,
 233: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_5&#39;,
 234: &#39;L-Dorsal auditory area (AUDd,1011)_1&#39;,
 235: &#39;L-Anterolateral visual area (VISal,402)_0&#39;,
 236: &#39;L-Primary visual area (VISp,385)_8&#39;,
 237: &#39;L-Primary auditory area (AUDp,1002)_0&#39;,
 238: &#39;L-Primary visual area (VISp,385)_9&#39;,
 239: &#39;L-Primary visual area (VISp,385)_10&#39;,
 240: &#39;L-Primary visual area (VISp,385)_11&#39;,
 241: &#39;L-Primary visual area (VISp,385)_12&#39;,
 242: &#39;L-Lateral visual area (VISl,409)_0&#39;,
 243: &#39;L-Primary visual area (VISp,385)_13&#39;,
 244: &#39;L-Primary auditory area (AUDp,1002)_1&#39;,
 245: &#39;L-Lateral visual area (VISl,409)_1&#39;,
 246: &#39;L-Posterior auditory area (AUDpo,1027)_0&#39;,
 247: &#39;L-Primary visual area (VISp,385)_14&#39;,
 248: &#39;L-Lateral visual area (VISl,409)_2&#39;,
 249: &#39;L-Primary visual area (VISp,385)_15&#39;,
 250: &#39;L-Primary visual area (VISp,385)_16&#39;,
 251: &#39;L-Temporal association areas (TEa,541)_0&#39;,
 252: &#39;L-Lateral visual area (VISl,409)_3&#39;,
 253: &#39;L-Primary visual area (VISp,385)_17&#39;,
 254: &#39;L-Primary visual area (VISp,385)_18&#39;,
 255: &#39;L-Lateral visual area (VISl,409)_4&#39;,
 256: &#39;L-Posterolateral visual area (VISpl,425)_0&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node_labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: 1,
 1: 2,
 2: 3,
 3: 4,
 4: 5,
 5: 6,
 6: 7,
 7: 8,
 8: 9,
 9: 10,
 10: 11,
 11: 12,
 12: 13,
 13: 14,
 14: 15,
 15: 16,
 16: 17,
 17: 18,
 18: 19,
 19: 20,
 20: 21,
 21: 22,
 22: 23,
 23: 24,
 24: 25,
 25: 26,
 26: 27,
 27: 28,
 28: 29,
 29: 30,
 30: 31,
 31: 32,
 32: 33,
 33: 34,
 34: 35,
 35: 36,
 36: 37,
 37: 38,
 38: 39,
 39: 40,
 40: 41,
 41: 42,
 42: 43,
 43: 44,
 44: 45,
 45: 46,
 46: 47,
 47: 48,
 48: 49,
 49: 50,
 50: 51,
 51: 52,
 52: 53,
 53: 54,
 54: 55,
 55: 56,
 56: 57,
 57: 58,
 58: 59,
 59: 60,
 60: 61,
 61: 62,
 62: 63,
 63: 64,
 64: 65,
 65: 66,
 66: 67,
 67: 68,
 68: 69,
 69: 70,
 70: 71,
 71: 72,
 72: 73,
 73: 74,
 74: 75,
 75: 76,
 76: 77,
 77: 78,
 78: 79,
 79: 80,
 80: 81,
 81: 82,
 82: 83,
 83: 84,
 84: 85,
 85: 86,
 86: 87,
 87: 88,
 88: 89,
 89: 90,
 90: 91,
 91: 92,
 92: 93,
 93: 94,
 94: 95,
 95: 96,
 96: 97,
 97: 98,
 98: 99,
 99: 100,
 100: 101,
 101: 102,
 102: 103,
 103: 104,
 104: 105,
 105: 106,
 106: 107,
 107: 108,
 108: 109,
 109: 110,
 110: 111,
 111: 112,
 112: 113,
 113: 114,
 114: 115,
 115: 116,
 116: 117,
 117: 118,
 118: 119,
 119: 120,
 120: 121,
 121: 122,
 122: 123,
 123: 124,
 124: 125,
 125: 126,
 126: 127,
 127: 128,
 128: 129,
 129: 130,
 130: 131,
 131: 132,
 132: 133,
 133: 134,
 134: 135,
 135: 136,
 136: 137,
 137: 138,
 138: 139,
 139: 140,
 140: 141,
 141: 142,
 142: 143,
 143: 144,
 144: 145,
 145: 146,
 146: 147,
 147: 148,
 148: 149,
 149: 150,
 150: 151,
 151: 152,
 152: 153,
 153: 154,
 154: 155,
 155: 156,
 156: 157,
 157: 158,
 158: 159,
 159: 160,
 160: 161,
 161: 162,
 162: 163,
 163: 164,
 164: 165,
 165: 166,
 166: 167,
 167: 168,
 168: 169,
 169: 170,
 170: 171,
 171: 172,
 172: 173,
 173: 174,
 174: 175,
 175: 176,
 176: 177,
 177: 178,
 178: 179,
 179: 180,
 180: 181,
 181: 182,
 182: 183,
 183: 184,
 184: 185,
 185: 186,
 186: 187,
 187: 188,
 188: 189,
 189: 190,
 190: 191,
 191: 192,
 192: 193,
 193: 194,
 194: 195,
 195: 196,
 196: 197,
 197: 198,
 198: 199,
 199: 200,
 200: 201,
 201: 202,
 202: 203,
 203: 204,
 204: 205,
 205: 206,
 206: 207,
 207: 208,
 208: 209,
 209: 210,
 210: 211,
 211: 212,
 212: 213,
 213: 214,
 214: 215,
 215: 216,
 216: 217,
 217: 218,
 218: 219,
 219: 220,
 220: 221,
 221: 222,
 222: 223,
 223: 224,
 224: 225,
 225: 226,
 226: 227,
 227: 228,
 228: 229,
 229: 230,
 230: 231,
 231: 232,
 232: 233,
 233: 234,
 234: 235,
 235: 236,
 236: 237,
 237: 238,
 238: 239,
 239: 240,
 240: 241,
 241: 242,
 242: 243,
 243: 244,
 244: 245,
 245: 246,
 246: 247,
 247: 248,
 248: 249,
 249: 250,
 250: 251,
 251: 252,
 252: 253,
 253: 254,
 254: 255,
 255: 256}
</pre></div>
</div>
</div>
</div>
</section>
<section id="todo-add-anatomical-distance-based-on-center-of-k-means">
<h1>TODO: add anatomical distance based on center of k means<a class="headerlink" href="#todo-add-anatomical-distance-based-on-center-of-k-means" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">extract_info</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="mi">19</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;R-Primary motor area (MOp,985)_4&#39;, (&#39;R&#39;, &#39;(MOp,985)_4&#39;, &#39;MOp\t985_4&#39;))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;R-Secondary motor area (MOs,993)_0&#39;,
 2: &#39;R-Primary motor area (MOp,985)_0&#39;,
 3: &#39;R-Primary motor area (MOp,985)_1&#39;,
 4: &#39;R-Secondary motor area (MOs,993)_1&#39;,
 5: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 6: &#39;R-Secondary motor area (MOs,993)_2&#39;,
 7: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 8: &#39;R-Primary somatosensory area, mouth (SSp-m,345)_2&#39;,
 9: &#39;R-Secondary motor area (MOs,993)_3&#39;,
 10: &#39;R-Primary motor area (MOp,985)_2&#39;,
 11: &#39;R-Primary motor area (MOp,985)_3&#39;,
 12: &#39;R-Secondary motor area (MOs,993)_4&#39;,
 13: &#39;R-Secondary motor area (MOs,993)_5&#39;,
 14: &#39;R-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 15: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 16: &#39;R-Secondary motor area (MOs,993)_6&#39;,
 17: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 18: &#39;R-Secondary motor area (MOs,993)_7&#39;,
 19: &#39;R-Primary motor area (MOp,985)_4&#39;,
 20: &#39;R-Prelimbic area (PL,972)_0&#39;,
 21: &#39;R-Secondary motor area (MOs,993)_8&#39;,
 22: &#39;R-Primary somatosensory area, nose (SSp-n,353)_1&#39;,
 23: &#39;R-Primary somatosensory area, nose (SSp-n,353)_2&#39;,
 24: &#39;R-Primary motor area (MOp,985)_5&#39;,
 25: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 26: &#39;R-Secondary motor area (MOs,993)_9&#39;,
 27: &#39;R-Secondary motor area (MOs,993)_10&#39;,
 28: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 29: &#39;L-Secondary motor area (MOs,993)_0&#39;,
 30: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 31: &#39;R-Secondary motor area (MOs,993)_11&#39;,
 32: &#39;R-Secondary motor area (MOs,993)_12&#39;,
 33: &#39;R-Primary motor area (MOp,985)_6&#39;,
 34: &#39;L-Secondary motor area (MOs,993)_1&#39;,
 35: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_3&#39;,
 36: &#39;R-Primary somatosensory area, unassigned (SSp-un,182305689)_0&#39;,
 37: &#39;R-Supplemental somatosensory area (SSs,378)_0&#39;,
 38: &#39;L-Secondary motor area (MOs,993)_2&#39;,
 39: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 40: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_0&#39;,
 41: &#39;R-Secondary motor area (MOs,993)_13&#39;,
 42: &#39;L-Secondary motor area (MOs,993)_3&#39;,
 43: &#39;R-Primary motor area (MOp,985)_7&#39;,
 44: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 45: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 46: &#39;R-Supplemental somatosensory area (SSs,378)_1&#39;,
 47: &#39;L-Secondary motor area (MOs,993)_4&#39;,
 48: &#39;R-Secondary motor area (MOs,993)_14&#39;,
 49: &#39;L-Secondary motor area (MOs,993)_5&#39;,
 50: &#39;R-Secondary motor area (MOs,993)_15&#39;,
 51: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)_4&#39;,
 52: &#39;L-Secondary motor area (MOs,993)_6&#39;,
 53: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 54: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 55: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 56: &#39;L-Secondary motor area (MOs,993)_7&#39;,
 57: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_1&#39;,
 58: &#39;R-Dorsal auditory area (AUDd,1011)_0&#39;,
 59: &#39;L-Secondary motor area (MOs,993)_8&#39;,
 60: &#39;R-Primary motor area (MOp,985)_8&#39;,
 61: &#39;R-Secondary motor area (MOs,993)_16&#39;,
 62: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_2&#39;,
 63: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_6&#39;,
 64: &#39;L-Secondary motor area (MOs,993)_9&#39;,
 65: &#39;L-Secondary motor area (MOs,993)_10&#39;,
 66: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_7&#39;,
 67: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_8&#39;,
 68: &#39;R-Dorsal auditory area (AUDd,1011)_1&#39;,
 69: &#39;L-Secondary motor area (MOs,993)_11&#39;,
 70: &#39;L-Secondary motor area (MOs,993)_12&#39;,
 71: &#39;R-Secondary motor area (MOs,993)_17&#39;,
 72: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_3&#39;,
 73: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)_4&#39;,
 74: &#39;L-Secondary motor area (MOs,993)_13&#39;,
 75: &#39;L-Secondary motor area (MOs,993)_14&#39;,
 76: &#39;R-Primary motor area (MOp,985)_9&#39;,
 77: &#39;R-Anterolateral visual area (VISal,402)_0&#39;,
 78: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_2&#39;,
 79: &#39;R-Anterior area (VISa,312782546)_0&#39;,
 80: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)_9&#39;,
 81: &#39;R-Posterior auditory area (AUDpo,1027)_0&#39;,
 82: &#39;L-Primary motor area (MOp,985)_0&#39;,
 83: &#39;L-Primary motor area (MOp,985)_1&#39;,
 84: &#39;L-Secondary motor area (MOs,993)_15&#39;,
 85: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 86: &#39;L-Secondary motor area (MOs,993)_16&#39;,
 87: &#39;R-Secondary motor area (MOs,993)_18&#39;,
 88: &#39;L-Secondary motor area (MOs,993)_17&#39;,
 89: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 90: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)_1&#39;,
 91: &#39;R-Anterolateral visual area (VISal,402)_1&#39;,
 92: &#39;L-Secondary motor area (MOs,993)_18&#39;,
 93: &#39;L-Secondary motor area (MOs,993)_19&#39;,
 94: &#39;R-Rostrolateral visual area (VISrl,417)_0&#39;,
 95: &#39;R-Secondary motor area (MOs,993)_19&#39;,
 96: &#39;R-Anterior area (VISa,312782546)_1&#39;,
 97: &#39;R-Primary visual area (VISp,385)_0&#39;,
 98: &#39;R-Lateral visual area (VISl,409)_0&#39;,
 99: &#39;L-Primary motor area (MOp,985)_2&#39;,
 100: &#39;L-Secondary motor area (MOs,993)_20&#39;,
 101: &#39;R-Anterior area (VISa,312782546)_2&#39;,
 102: &#39;L-Primary motor area (MOp,985)_3&#39;,
 103: &#39;L-Primary motor area (MOp,985)_4&#39;,
 104: &#39;L-Primary motor area (MOp,985)_5&#39;,
 105: &#39;L-Primary motor area (MOp,985)_6&#39;,
 106: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)_3&#39;,
 107: &#39;L-Secondary motor area (MOs,993)_21&#39;,
 108: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 109: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 110: &#39;R-Primary visual area (VISp,385)_1&#39;,
 111: &#39;L-Primary motor area (MOp,985)_7&#39;,
 112: &#39;L-Secondary motor area (MOs,993)_22&#39;,
 113: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 114: &#39;R-Primary visual area (VISp,385)_2&#39;,
 115: &#39;R-Primary visual area (VISp,385)_3&#39;,
 116: &#39;R-Lateral visual area (VISl,409)_1&#39;,
 117: &#39;R-Anteromedial visual area (VISam,394)_0&#39;,
 118: &#39;R-Primary visual area (VISp,385)_4&#39;,
 119: &#39;L-Primary motor area (MOp,985)_8&#39;,
 120: &#39;L-Primary motor area (MOp,985)_9&#39;,
 121: &#39;L-Secondary motor area (MOs,993)_23&#39;,
 122: &#39;R-Anteromedial visual area (VISam,394)_1&#39;,
 123: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_0&#39;,
 124: &#39;L-Primary motor area (MOp,985)_10&#39;,
 125: &#39;L-Primary motor area (MOp,985)_11&#39;,
 126: &#39;R-Primary visual area (VISp,385)_5&#39;,
 127: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_0&#39;,
 128: &#39;R-Primary visual area (VISp,385)_6&#39;,
 129: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 130: &#39;R-Retrosplenial area, ventral part (RSPv,886)_0&#39;,
 131: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 132: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 133: &#39;R-Primary visual area (VISp,385)_7&#39;,
 134: &#39;R-posteromedial visual area (VISpm,533)_0&#39;,
 135: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_0&#39;,
 136: &#39;L-Primary motor area (MOp,985)_12&#39;,
 137: &#39;R-Anteromedial visual area (VISam,394)_2&#39;,
 138: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_1&#39;,
 139: &#39;R-Primary visual area (VISp,385)_8&#39;,
 140: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_0&#39;,
 141: &#39;R-Primary visual area (VISp,385)_9&#39;,
 142: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_1&#39;,
 143: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_2&#39;,
 144: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_1&#39;,
 145: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_1&#39;,
 146: &#39;R-Primary visual area (VISp,385)_10&#39;,
 147: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_2&#39;,
 148: &#39;R-Primary visual area (VISp,385)_11&#39;,
 149: &#39;R-Retrosplenial area, ventral part (RSPv,886)_1&#39;,
 150: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_2&#39;,
 151: &#39;R-posteromedial visual area (VISpm,533)_1&#39;,
 152: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 153: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 154: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_3&#39;,
 155: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_0&#39;,
 156: &#39;R-Primary visual area (VISp,385)_12&#39;,
 157: &#39;R-Primary visual area (VISp,385)_13&#39;,
 158: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)_2&#39;,
 159: &#39;R-Primary visual area (VISp,385)_14&#39;,
 160: &#39;L-Primary somatosensory area, mouth (SSp-m,345)_3&#39;,
 161: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_3&#39;,
 162: &#39;L-Primary somatosensory area, nose (SSp-n,353)_0&#39;,
 163: &#39;R-Primary visual area (VISp,385)_15&#39;,
 164: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_0&#39;,
 165: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_4&#39;,
 166: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_1&#39;,
 167: &#39;R-Primary visual area (VISp,385)_16&#39;,
 168: &#39;R-Retrosplenial area, ventral part (RSPv,886)_2&#39;,
 169: &#39;L-Primary somatosensory area, unassigned (SSp-un,182305689)_0&#39;,
 170: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 171: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 172: &#39;R-posteromedial visual area (VISpm,533)_2&#39;,
 173: &#39;R-Primary visual area (VISp,385)_17&#39;,
 174: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_0&#39;,
 175: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)_4&#39;,
 176: &#39;L-Anterior area (VISa,312782546)_0&#39;,
 177: &#39;R-Primary visual area (VISp,385)_18&#39;,
 178: &#39;L-Primary somatosensory area, nose (SSp-n,353)_1&#39;,
 179: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_1&#39;,
 180: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_5&#39;,
 181: &#39;L-Primary somatosensory area, nose (SSp-n,353)_2&#39;,
 182: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)_2&#39;,
 183: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_6&#39;,
 184: &#39;R-Primary visual area (VISp,385)_19&#39;,
 185: &#39;R-Midbrain, sensory related (MBsen,339)_0&#39;,
 186: &#39;L-Retrosplenial area, ventral part (RSPv,886)_0&#39;,
 187: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 188: &#39;R-Retrosplenial area, dorsal part (RSPd,879)_9&#39;,
 189: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 190: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_1&#39;,
 191: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_2&#39;,
 192: &#39;L-Anterior area (VISa,312782546)_1&#39;,
 193: &#39;L-Anteromedial visual area (VISam,394)_0&#39;,
 194: &#39;R-Midbrain, sensory related (MBsen,339)_1&#39;,
 195: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_3&#39;,
 196: &#39;L-Primary somatosensory area, nose (SSp-n,353)_3&#39;,
 197: &#39;L-Anteromedial visual area (VISam,394)_1&#39;,
 198: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 199: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_7&#39;,
 200: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)_4&#39;,
 201: &#39;L-Anterior area (VISa,312782546)_2&#39;,
 202: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_2&#39;,
 203: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_4&#39;,
 204: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_0&#39;,
 205: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)_1&#39;,
 206: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_5&#39;,
 207: &#39;L-Primary visual area (VISp,385)_0&#39;,
 208: &#39;L-posteromedial visual area (VISpm,533)_0&#39;,
 209: &#39;L-Retrosplenial area, dorsal part (RSPd,879)_8&#39;,
 210: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_6&#39;,
 211: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_7&#39;,
 212: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_3&#39;,
 213: &#39;L-Rostrolateral visual area (VISrl,417)_0&#39;,
 214: &#39;L-posteromedial visual area (VISpm,533)_1&#39;,
 215: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_1&#39;,
 216: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_8&#39;,
 217: &#39;L-posteromedial visual area (VISpm,533)_2&#39;,
 218: &#39;L-Supplemental somatosensory area (SSs,378)_0&#39;,
 219: &#39;L-Primary visual area (VISp,385)_1&#39;,
 220: &#39;L-Primary visual area (VISp,385)_2&#39;,
 221: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_4&#39;,
 222: &#39;L-Supplemental somatosensory area (SSs,378)_1&#39;,
 223: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)_9&#39;,
 224: &#39;L-Rostrolateral visual area (VISrl,417)_1&#39;,
 225: &#39;L-posteromedial visual area (VISpm,533)_3&#39;,
 226: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)_2&#39;,
 227: &#39;L-Primary visual area (VISp,385)_3&#39;,
 228: &#39;L-Dorsal auditory area (AUDd,1011)_0&#39;,
 229: &#39;L-Primary visual area (VISp,385)_4&#39;,
 230: &#39;L-Primary visual area (VISp,385)_5&#39;,
 231: &#39;L-Primary visual area (VISp,385)_6&#39;,
 232: &#39;L-Primary visual area (VISp,385)_7&#39;,
 233: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)_5&#39;,
 234: &#39;L-Dorsal auditory area (AUDd,1011)_1&#39;,
 235: &#39;L-Anterolateral visual area (VISal,402)_0&#39;,
 236: &#39;L-Primary visual area (VISp,385)_8&#39;,
 237: &#39;L-Primary auditory area (AUDp,1002)_0&#39;,
 238: &#39;L-Primary visual area (VISp,385)_9&#39;,
 239: &#39;L-Primary visual area (VISp,385)_10&#39;,
 240: &#39;L-Primary visual area (VISp,385)_11&#39;,
 241: &#39;L-Primary visual area (VISp,385)_12&#39;,
 242: &#39;L-Lateral visual area (VISl,409)_0&#39;,
 243: &#39;L-Primary visual area (VISp,385)_13&#39;,
 244: &#39;L-Primary auditory area (AUDp,1002)_1&#39;,
 245: &#39;L-Lateral visual area (VISl,409)_1&#39;,
 246: &#39;L-Posterior auditory area (AUDpo,1027)_0&#39;,
 247: &#39;L-Primary visual area (VISp,385)_14&#39;,
 248: &#39;L-Lateral visual area (VISl,409)_2&#39;,
 249: &#39;L-Primary visual area (VISp,385)_15&#39;,
 250: &#39;L-Primary visual area (VISp,385)_16&#39;,
 251: &#39;L-Temporal association areas (TEa,541)_0&#39;,
 252: &#39;L-Lateral visual area (VISl,409)_3&#39;,
 253: &#39;L-Primary visual area (VISp,385)_17&#39;,
 254: &#39;L-Primary visual area (VISp,385)_18&#39;,
 255: &#39;L-Lateral visual area (VISl,409)_4&#39;,
 256: &#39;L-Posterolateral visual area (VISpl,425)_0&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="n">num_regions</span><span class="p">)</span>
<span class="n">colors_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

<span class="n">colors_rgb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors_list</span><span class="p">:</span>
    <span class="n">colors_rgb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">255</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">color</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">190</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;kmeans_centers&#39;</span><span class="p">]:</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">655</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;flag_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># plt.savefig(&#39;kmeans_atlas.png&#39;, dpi=300)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_117_0.png" src="_images/play_kmeans_parcellation-128_117_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11880
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inconsistent_pixels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">inconsistent_pixels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([100, 106, 107, 108, 108, 109, 109, 109, 109, 110, 110, 110, 110,
        110, 111, 111, 111, 111, 111, 111, 111, 112, 112, 112, 112, 112,
        112, 112, 112, 112, 113, 113, 113, 113, 113, 113, 113, 113, 113,
        114, 114, 114, 114, 114, 114, 114, 114, 114, 114, 115, 115, 115,
        115, 115, 115, 115, 115, 115, 115, 116, 116, 116, 116, 116, 116,
        116, 116, 116, 117, 117, 117, 117, 117, 117, 117, 117, 118, 118,
        118, 118, 118, 119, 119, 119, 120, 135, 137, 138, 138, 139, 139,
        139, 140, 140, 140, 141, 141, 141, 142, 142, 142, 142, 143, 143,
        143, 143, 143, 144, 144, 144, 144, 145, 145, 146, 148, 149, 150,
        153, 154, 154, 155, 155, 156, 156, 156, 157, 157, 158, 158, 159,
        159, 159, 160, 160, 160, 161, 161, 161, 162, 162, 162, 163, 163,
        163, 164, 164, 165, 165, 166, 166, 166, 167, 167, 167, 168, 168,
        168, 169, 169, 169, 170, 171, 171, 171, 171, 172, 172, 172, 172,
        172, 173, 173, 173, 173, 173, 173, 174, 174, 174, 174, 174, 175,
        175, 175, 175, 177, 178, 179, 180, 181, 182, 182, 182, 182, 183,
        183, 183, 183, 183, 183, 183, 183, 184, 184, 184, 184, 184, 184,
        184, 184, 184, 184, 184, 184, 184, 184, 185, 185, 185, 185, 185,
        185, 185, 185, 185, 185, 185, 185, 185, 186, 186, 186, 186, 186,
        186, 187, 187, 187, 187, 187, 188, 188, 188, 188, 188, 189, 189,
        189]),
 array([  0, 183, 182, 181, 182, 180, 181, 182, 183, 179, 180, 181, 182,
        183, 177, 178, 179, 180, 181, 182, 183, 176, 177, 178, 179, 180,
        181, 182, 183, 184, 175, 176, 177, 178, 179, 180, 181, 182, 183,
        174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 173, 174, 175,
        176, 177, 178, 179, 180, 181, 182, 172, 173, 174, 175, 176, 177,
        179, 180, 181, 170, 171, 172, 173, 174, 175, 176, 180, 170, 171,
        172, 173, 174, 171, 172, 173, 172,  15,  16,  16,  17,  16,  17,
         18,  17,  18,  19,  18,  19,  20,  18,  19,  20,  21,  18,  19,
         20,  21,  22,  19,  20,  21,  22,  20,  21,  20,  21,  21,  22,
         25,  25,  26,  26,  27,  26,  27,  28,  27,  28,  28,  29,  28,
         29,  30,  29,  30,  31,  30,  31,  32,  31,  32,  33,  32,  33,
         34,  33,  34,  34,  35,  34,  35,  36,  35,  36,  37,  36,  37,
         38,  37,  38,  39, 103,  41, 102, 103, 104,  46,  47, 101, 102,
        103,  45,  46,  47,  48, 102, 103,  45,  46,  47,  48, 102,  46,
         47,  48,  49, 101, 100,  99,  98,  97,  66,  71,  77,  96,  70,
         71,  72,  76,  77,  82,  83,  95,  70,  71,  72,  73,  75,  76,
         77,  78,  81,  82,  83,  84,  93,  94,  74,  75,  76,  77,  78,
         79,  80,  81,  82,  83,  84,  85,  92,  81,  82,  83,  84,  85,
         91,  83,  84,  85,  86,  90,  84,  85,  86,  87,  89,  86,  87,
         88]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">][</span><span class="n">inconsistent_pixels</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">][</span><span class="n">inconsistent_pixels</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pixels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([179, 180, 180, 180, 181, 181, 181, 181, 181, 181, 182, 182, 182,
        182, 182, 182, 182, 182, 182, 183, 183, 183, 183, 183, 183, 183,
        183, 183, 183, 183, 184, 184, 184, 184, 184, 184, 184, 184, 184,
        184, 184, 184, 185, 185, 185, 185, 185, 185, 185, 185, 185, 185,
        185, 185, 185, 186, 186, 186, 186, 186, 186, 186, 186, 186, 186,
        186, 187, 187, 187, 187, 187, 187, 187, 187, 188, 188, 188, 188,
        188, 188, 189, 189, 189]),
 array([88, 86, 87, 88, 84, 85, 86, 87, 88, 89, 82, 83, 84, 85, 86, 87, 88,
        89, 90, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 80, 81, 82, 83,
        84, 85, 86, 87, 88, 89, 90, 91, 80, 81, 82, 83, 84, 85, 86, 87, 88,
        89, 90, 91, 92, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 83, 84,
        85, 86, 87, 88, 89, 90, 84, 85, 86, 87, 88, 89, 86, 87, 88]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;R-Frontal pole, cerebral cortex (FRP,184)&#39;,
 2: &#39;R-Primary motor area (MOp,985)&#39;,
 3: &#39;R-Secondary motor area (MOs,993)&#39;,
 4: &#39;R-Primary somatosensory area, nose (SSp-n,353)&#39;,
 5: &#39;R-Primary somatosensory area, barrel field (SSp-bfd,329)&#39;,
 6: &#39;R-Primary somatosensory area, lower limb (SSp-ll,337)&#39;,
 7: &#39;R-Primary somatosensory area, mouth (SSp-m,345)&#39;,
 8: &#39;R-Primary somatosensory area, upper limb (SSp-ul,369)&#39;,
 9: &#39;R-Primary somatosensory area, trunk (SSp-tr,361)&#39;,
 10: &#39;R-Primary somatosensory area, unassigned (SSp-un,182305689)&#39;,
 11: &#39;R-Supplemental somatosensory area (SSs,378)&#39;,
 12: &#39;R-Gustatory areas (GU,1057)&#39;,
 13: &#39;R-Visceral area (VISC,677)&#39;,
 14: &#39;R-Dorsal auditory area (AUDd,1011)&#39;,
 15: &#39;R-Primary auditory area (AUDp,1002)&#39;,
 16: &#39;R-Posterior auditory area (AUDpo,1027)&#39;,
 17: &#39;R-Ventral auditory area (AUDv,1018)&#39;,
 18: &#39;R-Anterolateral visual area (VISal,402)&#39;,
 19: &#39;R-Anteromedial visual area (VISam,394)&#39;,
 20: &#39;R-Lateral visual area (VISl,409)&#39;,
 21: &#39;R-Primary visual area (VISp,385)&#39;,
 22: &#39;R-Posterolateral visual area (VISpl,425)&#39;,
 23: &#39;R-posteromedial visual area (VISpm,533)&#39;,
 24: &#39;R-Anterior area (VISa,312782546)&#39;,
 25: &#39;R-Laterointermediate area (VISli,312782574)&#39;,
 26: &#39;R-Rostrolateral visual area (VISrl,417)&#39;,
 27: &#39;R-Postrhinal area (VISpor,312782628)&#39;,
 28: &#39;R-Anterior cingulate area, dorsal part (ACAd,39)&#39;,
 29: &#39;R-Anterior cingulate area, ventral part (ACAv,48)&#39;,
 30: &#39;R-Prelimbic area (PL,972)&#39;,
 31: &#39;R-Infralimbic area (ILA,44)&#39;,
 32: &#39;R-Orbital area, lateral part (ORBl,723)&#39;,
 33: &#39;R-Orbital area, medial part (ORBm,731)&#39;,
 34: &#39;R-Orbital area, ventrolateral part (ORBvl,746)&#39;,
 35: &#39;R-Agranular insular area, dorsal part (AId,104)&#39;,
 36: &#39;R-Agranular insular area, posterior part (AIp,111)&#39;,
 37: &#39;R-Agranular insular area, ventral part (AIv,119)&#39;,
 38: &#39;R-Retrosplenial area, lateral agranular part (RSPagl,894)&#39;,
 39: &#39;R-Retrosplenial area, dorsal part (RSPd,879)&#39;,
 40: &#39;R-Retrosplenial area, ventral part (RSPv,886)&#39;,
 41: &#39;R-Temporal association areas (TEa,541)&#39;,
 42: &#39;R-Perirhinal area (PERI,922)&#39;,
 43: &#39;R-Ectorhinal area (ECT,895)&#39;,
 44: &#39;R-Main olfactory bulb (MOB,507)&#39;,
 45: &#39;R-Accessory olfactory bulb, glomerular layer (AOBgl,188)&#39;,
 46: &#39;R-Accessory olfactory bulb, granular layer (AOBgr,196)&#39;,
 47: &#39;R-Accessory olfactory bulb, mitral layer (AOBmi,204)&#39;,
 48: &#39;R-Nucleus of the lateral olfactory tract, layer 3 (NLOT3,1139)&#39;,
 49: &#39;R-Anterior olfactory nucleus (AON,159)&#39;,
 50: &#39;R-Nucleus of the lateral olfactory tract, molecular layer (NLOT1,260)&#39;,
 51: &#39;R-Postpiriform transition area (TR,566)&#39;,
 52: &#39;R-Taenia tecta (TT,589)&#39;,
 53: &#39;R-Cortical amygdalar area, anterior part (COAa,639)&#39;,
 54: &#39;R-Cortical amygdalar area, posterior part (COAp,647)&#39;,
 55: &#39;R-Piriform-amygdalar area (PAA,788)&#39;,
 56: &#39;R-Dorsal peduncular area (DP,814)&#39;,
 57: &#39;R-Piriform area (PIR,961)&#39;,
 58: &#39;R-Main olfactory bulb (MOB,507)&#39;,
 59: &#39;R-Field CA1 (CA1,382)&#39;,
 60: &#39;R-Field CA2 (CA2,423)&#39;,
 61: &#39;R-Field CA3 (CA3,463)&#39;,
 62: &#39;R-Dentate gyrus, molecular layer (DG-mo,10703)&#39;,
 63: &#39;R-Dentate gyrus, polymorph layer (DG-po,10704)&#39;,
 64: &#39;R-Dentate gyrus, granule cell layer (DG-sg,632)&#39;,
 65: &#39;R-Fasciola cinerea (FC,982)&#39;,
 66: &#39;R-Subiculum (SUB,502)&#39;,
 67: &#39;R-Parasubiculum (PAR,843)&#39;,
 68: &#39;R-Entorhinal area, lateral part (ENTl,918)&#39;,
 69: &#39;R-Entorhinal area, medial part, dorsal zone (ENTm,926)&#39;,
 70: &#39;R-Entorhinal area, medial part, ventral zone (ENTmv,934)&#39;,
 71: &#39;R-Postsubiculum (POST,1037)&#39;,
 72: &#39;R-Presubiculum (PRE,1084)&#39;,
 73: &#39;R-Claustrum (CLA,583)&#39;,
 74: &#39;R-Endopiriform nucleus (EP,942)&#39;,
 75: &#39;R-Lateral amygdalar nucleus (LA,131)&#39;,
 76: &#39;R-Basolateral amygdalar nucleus, anterior part (BLAa,303)&#39;,
 77: &#39;R-Basolateral amygdalar nucleus, posterior part (BLAp,311)&#39;,
 78: &#39;R-Basomedial amygdalar nucleus (BMA,319)&#39;,
 79: &#39;R-Basolateral amygdalar nucleus, ventral part (BLAv,451)&#39;,
 80: &#39;R-Posterior amygdalar nucleus (PA,780)&#39;,
 81: &#39;R-Caudoputamen (CP,672)&#39;,
 82: &#39;R-Nucleus accumbens (ACB,56)&#39;,
 83: &#39;R-Olfactory tubercle (OT,754)&#39;,
 84: &#39;R-Lateral septal nucleus, caudal (caudodorsal) part (LSc,250)&#39;,
 85: &#39;R-Septohippocampal nucleus (SH,333)&#39;,
 86: &#39;R-Striatum-like amygdalar nuclei (sAMY,278)&#39;,
 87: &#39;R-Lateral septal nucleus, rostral (rostroventral) part (LSr,258)&#39;,
 88: &#39;R-Lateral septal nucleus, ventral part (LSv,266)&#39;,
 89: &#39;R-Septofimbrial nucleus (SF,310)&#39;,
 90: &#39;R-Fundus of striatum (FS,998)&#39;,
 91: &#39;R-Globus pallidus, external segment (GPe,1022)&#39;,
 92: &#39;R-Globus pallidus, internal segment (GPi,1031)&#39;,
 93: &#39;R-Pallidum, caudal region (PALc,809)&#39;,
 94: &#39;R-Magnocellular nucleus (MA,298)&#39;,
 95: &#39;R-Substantia innominata (SI,342)&#39;,
 96: &#39;R-Medial septal nucleus (MS,564)&#39;,
 97: &#39;R-Triangular nucleus of septum (TRS,581)&#39;,
 98: &#39;R-Diagonal band nucleus (NDB,596)&#39;,
 99: &#39;R-Ventral anterior-lateral complex of the thalamus (VAL,629)&#39;,
 100: &#39;R-Ventral medial nucleus of the thalamus (VM,685)&#39;,
 101: &#39;R-Ventral posterolateral nucleus of the thalamus (VPL,718)&#39;,
 102: &#39;R-Ventral posteromedial nucleus of the thalamus (VPM,733)&#39;,
 103: &#39;R-Peripeduncular nucleus (PP,1044)&#39;,
 104: &#39;R-Medial geniculate complex (MG,475)&#39;,
 105: &#39;R-Dorsal part of the lateral geniculate complex (LGd,170)&#39;,
 106: &#39;R-Lateral posterior nucleus of the thalamus (LP,218)&#39;,
 107: &#39;R-Posterior complex of the thalamus (PO,1020)&#39;,
 108: &#39;R-Suprageniculate nucleus (SGN,325)&#39;,
 109: &#39;R-Anteroventral nucleus of thalamus (AV,255)&#39;,
 110: &#39;R-Anteromedial nucleus (AM,127)&#39;,
 111: &#39;R-Anterodorsal nucleus (AD,64)&#39;,
 112: &#39;R-Lateral dorsal nucleus of thalamus (LD,155)&#39;,
 113: &#39;R-Interanterodorsal nucleus of the thalamus (IAD,1113)&#39;,
 114: &#39;R-Interanteromedial nucleus of the thalamus (IAM,1120)&#39;,
 115: &#39;R-Intermediodorsal nucleus of the thalamus (IMD,59)&#39;,
 116: &#39;R-Mediodorsal nucleus of thalamus (MD,362)&#39;,
 117: &#39;R-Submedial nucleus of the thalamus (SMT,366)&#39;,
 118: &#39;R-Paraventricular nucleus of the thalamus (PVT,149)&#39;,
 119: &#39;R-Parataenial nucleus (PT,15)&#39;,
 120: &#39;R-Nucleus of reuniens (RE,181)&#39;,
 121: &#39;R-Rhomboid nucleus (RH,189)&#39;,
 122: &#39;R-Paracentral nucleus (PCN,907)&#39;,
 123: &#39;R-Central lateral nucleus of the thalamus (CL,575)&#39;,
 124: &#39;R-Central medial nucleus of the thalamus (CM,599)&#39;,
 125: &#39;R-Parafascicular nucleus (PF,930)&#39;,
 126: &#39;R-Reticular nucleus of the thalamus (RT,262)&#39;,
 127: &#39;R-Intergeniculate leaflet of the lateral geniculate complex (IGL,27)&#39;,
 128: &#39;R-Ventral part of the lateral geniculate complex (LGv,178)&#39;,
 129: &#39;R-Medial habenula (MH,483)&#39;,
 130: &#39;R-Lateral habenula (LH,186)&#39;,
 131: &#39;R-Subparafascicular nucleus, magnocellular part (SPFm,414)&#39;,
 132: &#39;R-Subparafascicular nucleus, parvicellular part (SPFp,422)&#39;,
 133: &#39;R-Subparafascicular area (SPA,609)&#39;,
 134: &#39;R-Ventral posterolateral nucleus of the thalamus, parvicellular part (VPLpc,725)&#39;,
 135: &#39;R-Ventral posteromedial nucleus of the thalamus, parvicellular part (VPMpc,741)&#39;,
 136: &#39;R-Posterior limiting nucleus of the thalamus (POL,1029)&#39;,
 137: &#39;R-Perireunensis nucleus (PR,1077)&#39;,
 138: &#39;R-Periventricular zone (PVZ,157)&#39;,
 139: &#39;R-Periventricular region (PVR,141)&#39;,
 140: &#39;R-Lateral mammillary nucleus (LM,210)&#39;,
 141: &#39;R-Medial mammillary nucleus (MM,491)&#39;,
 142: &#39;R-Hypothalamic lateral zone (LZ,290)&#39;,
 143: &#39;R-Tuberomammillary nucleus (TM,557)&#39;,
 144: &#39;R-Paraventricular hypothalamic nucleus, descending division (PVHd,63)&#39;,
 145: &#39;R-Anterior hypothalamic nucleus (AHN,88)&#39;,
 146: &#39;R-Medial preoptic nucleus (MPN,515)&#39;,
 147: &#39;R-Supramammillary nucleus (SUM,525)&#39;,
 148: &#39;R-Ventromedial hypothalamic nucleus (VMH,693)&#39;,
 149: &#39;R-Posterior hypothalamic nucleus (PH,946)&#39;,
 150: &#39;R-Dorsal premammillary nucleus (PMd,980)&#39;,
 151: &#39;R-Ventral premammillary nucleus (PMv,1004)&#39;,
 152: &#39;R-Periventricular zone (PVZ,157)&#39;,
 153: &#39;R-Periventricular region (PVR,141)&#39;,
 154: &#39;R-Superior colliculus, optic layer (SCop,851)&#39;,
 155: &#39;R-Superior colliculus, superficial gray layer (SCsg,842)&#39;,
 156: &#39;R-Midbrain, sensory related (MBsen,339)&#39;,
 157: &#39;R-Midbrain, motor related (MBmot,323)&#39;,
 158: &#39;R-Superior colliculus, motor related, deep gray layer (SCdg,26)&#39;,
 159: &#39;R-Superior colliculus, motor related, deep white layer (SCdw,42)&#39;,
 160: &#39;R-Superior colliculus, motor related, intermediate white layer (SCiw,17)&#39;,
 161: &#39;R-Superior colliculus, motor related, intermediate gray layer (SCig,10)&#39;,
 162: &#39;R-Anterior pretectal nucleus (APN,215)&#39;,
 163: &#39;R-Midbrain raphe nuclei (RAmb,165)&#39;,
 164: &#39;R-Midbrain, behavioral state related (MBsta,348)&#39;,
 165: &#39;R-Medial pretectal area (MPT,531)&#39;,
 166: &#39;R-Nucleus of the optic tract (NOT,628)&#39;,
 167: &#39;R-Nucleus of the posterior commissure (NPC,634)&#39;,
 168: &#39;R-Olivary pretectal nucleus (OP,706)&#39;,
 169: &#39;R-Posterior pretectal nucleus (PPT,1061)&#39;,
 170: &#39;R-Midbrain, behavioral state related (MBsta,348)&#39;,
 171: &#39;R-Midbrain, behavioral state related (MBsta,348)&#39;,
 172: &#39;R-Nucleus of the lateral lemniscus (NLL,612)&#39;,
 173: &#39;R-Principal sensory nucleus of the trigeminal (PSV,7)&#39;,
 174: &#39;R-Superior olivary complex, periolivary region (POR,122)&#39;,
 175: &#39;R-Superior olivary complex, medial part (SOCm,105)&#39;,
 176: &#39;R-Superior olivary complex, lateral part (SOCl,114)&#39;,
 177: &#39;R-Pons, motor related (P-mot,987)&#39;,
 178: &#39;R-Pons, behavioral state related (P-sat,1117)&#39;,
 179: &#39;R-Parabrachial nucleus (PB,867)&#39;,
 180: &#39;R-Pons, behavioral state related (P-sat,1117)&#39;,
 181: &#39;R-Pons, behavioral state related (P-sat,1117)&#39;,
 182: &#39;R-Area postrema (AP,207)&#39;,
 183: &#39;R-Dorsal cochlear nucleus (DCO,96)&#39;,
 184: &#39;R-Ventral cochlear nucleus (VCO,101)&#39;,
 185: &#39;R-Cuneate nucleus (CU,711)&#39;,
 186: &#39;R-Gracile nucleus (GR,1039)&#39;,
 187: &#39;R-External cuneate nucleus (ECU,903)&#39;,
 188: &#39;R-Nucleus of the trapezoid body (NTB,642)&#39;,
 189: &#39;R-Spinal nucleus of the trigeminal, caudal part (SPVC,429)&#39;,
 190: &#39;R-Spinal nucleus of the trigeminal, interpolar part (SPVI,437)&#39;,
 191: &#39;R-Spinal nucleus of the trigeminal, oral part (SPVO,445)&#39;,
 192: &#39;R-Medulla, motor related (MY-mot,370)&#39;,
 193: &#39;R-Nucleus ambiguus, dorsal division (AMBd,939)&#39;,
 194: &#39;R-Nucleus ambiguus, ventral division (AMBv,143)&#39;,
 195: &#39;R-Nucleus prepositus (PRP,169)&#39;,
 196: &#39;R-Lateral vestibular nucleus (LAV,209)&#39;,
 197: &#39;R-Medial vestibular nucleus (MV,202)&#39;,
 198: &#39;R-Spinal vestibular nucleus (SPIV,225)&#39;,
 199: &#39;R-Nucleus of Roller (NR,177)&#39;,
 200: &#39;R-Medulla, behavioral state related (MY-sat,379)&#39;,
 201: &#39;R-Superior vestibular nucleus (SUV,217)&#39;,
 202: &#39;R-Nucleus of the solitary tract (NTS,651)&#39;,
 203: &#39;R-Paragigantocellular reticular nucleus, dorsal part (PGRNd,970)&#39;,
 204: &#39;R-Paragigantocellular reticular nucleus, lateral part (PGRNl,978)&#39;,
 205: &#39;R-Medullary reticular nucleus, dorsal part (MDRNd,1098)&#39;,
 206: &#39;R-Medullary reticular nucleus, ventral part (MDRNv,1107)&#39;,
 207: &#39;R-Medulla, motor related (MY-mot,370)&#39;,
 208: &#39;R-Paraflocculus (PFL,1041)&#39;,
 209: &#39;R-Flocculus (FL,1049)&#39;,
 210: &#39;R-Fastigial nucleus (FN,989)&#39;,
 211: &#39;R-Interposed nucleus (IP,91)&#39;,
 212: &#39;R-Dentate nucleus (DN,846)&#39;,
 213: &#39;R-Lingula (I) (LING,912)&#39;,
 214: &#39;R-Central lobule (CENT,920)&#39;,
 215: &#39;R-Culmen (CUL,928)&#39;,
 216: &#39;R-Declive (VI) (DEC,936)&#39;,
 217: &#39;R-Folium-tuber vermis (VII) (FOTU,944)&#39;,
 218: &#39;R-Pyramus (VIII) (PYR,951)&#39;,
 219: &#39;R-Uvula (IX) (UVU,957)&#39;,
 220: &#39;R-Nodulus (X) (NOD,968)&#39;,
 221: &#39;R-Simple lobule (SIM,1007)&#39;,
 222: &#39;R-Ansiform lobule (AN,1017)&#39;,
 223: &#39;R-Paramedian lobule (PRM,1025)&#39;,
 224: &#39;R-Copula pyramidis (COPY,1033)&#39;,
 501: &#39;L-Frontal pole, cerebral cortex (FRP,184)&#39;,
 502: &#39;L-Primary motor area (MOp,985)&#39;,
 503: &#39;L-Secondary motor area (MOs,993)&#39;,
 504: &#39;L-Primary somatosensory area, nose (SSp-n,353)&#39;,
 505: &#39;L-Primary somatosensory area, barrel field (SSp-bfd,329)&#39;,
 506: &#39;L-Primary somatosensory area, lower limb (SSp-ll,337)&#39;,
 507: &#39;L-Primary somatosensory area, mouth (SSp-m,345)&#39;,
 508: &#39;L-Primary somatosensory area, upper limb (SSp-ul,369)&#39;,
 509: &#39;L-Primary somatosensory area, trunk (SSp-tr,361)&#39;,
 510: &#39;L-Primary somatosensory area, unassigned (SSp-un,182305689)&#39;,
 511: &#39;L-Supplemental somatosensory area (SSs,378)&#39;,
 512: &#39;L-Gustatory areas (GU,1057)&#39;,
 513: &#39;L-Visceral area (VISC,677)&#39;,
 514: &#39;L-Dorsal auditory area (AUDd,1011)&#39;,
 515: &#39;L-Primary auditory area (AUDp,1002)&#39;,
 516: &#39;L-Posterior auditory area (AUDpo,1027)&#39;,
 517: &#39;L-Ventral auditory area (AUDv,1018)&#39;,
 518: &#39;L-Anterolateral visual area (VISal,402)&#39;,
 519: &#39;L-Anteromedial visual area (VISam,394)&#39;,
 520: &#39;L-Lateral visual area (VISl,409)&#39;,
 521: &#39;L-Primary visual area (VISp,385)&#39;,
 522: &#39;L-Posterolateral visual area (VISpl,425)&#39;,
 523: &#39;L-posteromedial visual area (VISpm,533)&#39;,
 524: &#39;L-Anterior area (VISa,312782546)&#39;,
 525: &#39;L-Laterointermediate area (VISli,312782574)&#39;,
 526: &#39;L-Rostrolateral visual area (VISrl,417)&#39;,
 527: &#39;L-Postrhinal area (VISpor,312782628)&#39;,
 528: &#39;L-Anterior cingulate area, dorsal part (ACAd,39)&#39;,
 529: &#39;L-Anterior cingulate area, ventral part (ACAv,48)&#39;,
 530: &#39;L-Prelimbic area (PL,972)&#39;,
 531: &#39;L-Infralimbic area (ILA,44)&#39;,
 532: &#39;L-Orbital area, lateral part (ORBl,723)&#39;,
 533: &#39;L-Orbital area, medial part (ORBm,731)&#39;,
 534: &#39;L-Orbital area, ventrolateral part (ORBvl,746)&#39;,
 535: &#39;L-Agranular insular area, dorsal part (AId,104)&#39;,
 536: &#39;L-Agranular insular area, posterior part (AIp,111)&#39;,
 537: &#39;L-Agranular insular area, ventral part (AIv,119)&#39;,
 538: &#39;L-Retrosplenial area, lateral agranular part (RSPagl,894)&#39;,
 539: &#39;L-Retrosplenial area, dorsal part (RSPd,879)&#39;,
 540: &#39;L-Retrosplenial area, ventral part (RSPv,886)&#39;,
 541: &#39;L-Temporal association areas (TEa,541)&#39;,
 542: &#39;L-Perirhinal area (PERI,922)&#39;,
 543: &#39;L-Ectorhinal area (ECT,895)&#39;,
 544: &#39;L-Main olfactory bulb (MOB,507)&#39;,
 545: &#39;L-Accessory olfactory bulb, glomerular layer (AOBgl,188)&#39;,
 546: &#39;L-Accessory olfactory bulb, granular layer (AOBgr,196)&#39;,
 547: &#39;L-Accessory olfactory bulb, mitral layer (AOBmi,204)&#39;,
 548: &#39;L-Nucleus of the lateral olfactory tract, layer 3 (NLOT3,1139)&#39;,
 549: &#39;L-Anterior olfactory nucleus (AON,159)&#39;,
 550: &#39;L-Nucleus of the lateral olfactory tract, molecular layer (NLOT1,260)&#39;,
 551: &#39;L-Postpiriform transition area (TR,566)&#39;,
 552: &#39;L-Taenia tecta (TT,589)&#39;,
 553: &#39;L-Cortical amygdalar area, anterior part (COAa,639)&#39;,
 554: &#39;L-Cortical amygdalar area, posterior part (COAp,647)&#39;,
 555: &#39;L-Piriform-amygdalar area (PAA,788)&#39;,
 556: &#39;L-Dorsal peduncular area (DP,814)&#39;,
 557: &#39;L-Piriform area (PIR,961)&#39;,
 558: &#39;L-Main olfactory bulb (MOB,507)&#39;,
 559: &#39;L-Field CA1 (CA1,382)&#39;,
 560: &#39;L-Field CA2 (CA2,423)&#39;,
 561: &#39;L-Field CA3 (CA3,463)&#39;,
 562: &#39;L-Dentate gyrus, molecular layer (DG-mo,10703)&#39;,
 563: &#39;L-Dentate gyrus, polymorph layer (DG-po,10704)&#39;,
 564: &#39;L-Dentate gyrus, granule cell layer (DG-sg,632)&#39;,
 565: &#39;L-Fasciola cinerea (FC,982)&#39;,
 566: &#39;L-Subiculum (SUB,502)&#39;,
 567: &#39;L-Parasubiculum (PAR,843)&#39;,
 568: &#39;L-Entorhinal area, lateral part (ENTl,918)&#39;,
 569: &#39;L-Entorhinal area, medial part, dorsal zone (ENTm,926)&#39;,
 570: &#39;L-Entorhinal area, medial part, ventral zone (ENTmv,934)&#39;,
 571: &#39;L-Postsubiculum (POST,1037)&#39;,
 572: &#39;L-Presubiculum (PRE,1084)&#39;,
 573: &#39;L-Claustrum (CLA,583)&#39;,
 574: &#39;L-Endopiriform nucleus (EP,942)&#39;,
 575: &#39;L-Lateral amygdalar nucleus (LA,131)&#39;,
 576: &#39;L-Basolateral amygdalar nucleus, anterior part (BLAa,303)&#39;,
 577: &#39;L-Basolateral amygdalar nucleus, posterior part (BLAp,311)&#39;,
 578: &#39;L-Basomedial amygdalar nucleus (BMA,319)&#39;,
 579: &#39;L-Basolateral amygdalar nucleus, ventral part (BLAv,451)&#39;,
 580: &#39;L-Posterior amygdalar nucleus (PA,780)&#39;,
 581: &#39;L-Caudoputamen (CP,672)&#39;,
 582: &#39;L-Nucleus accumbens (ACB,56)&#39;,
 583: &#39;L-Olfactory tubercle (OT,754)&#39;,
 584: &#39;L-Lateral septal nucleus, caudal (caudodorsal) part (LSc,250)&#39;,
 585: &#39;L-Septohippocampal nucleus (SH,333)&#39;,
 586: &#39;L-Striatum-like amygdalar nuclei (sAMY,278)&#39;,
 587: &#39;L-Lateral septal nucleus, rostral (rostroventral) part (LSr,258)&#39;,
 588: &#39;L-Lateral septal nucleus, ventral part (LSv,266)&#39;,
 589: &#39;L-Septofimbrial nucleus (SF,310)&#39;,
 590: &#39;L-Fundus of striatum (FS,998)&#39;,
 591: &#39;L-Globus pallidus, external segment (GPe,1022)&#39;,
 592: &#39;L-Globus pallidus, internal segment (GPi,1031)&#39;,
 593: &#39;L-Pallidum, caudal region (PALc,809)&#39;,
 594: &#39;L-Magnocellular nucleus (MA,298)&#39;,
 595: &#39;L-Substantia innominata (SI,342)&#39;,
 596: &#39;L-Medial septal nucleus (MS,564)&#39;,
 597: &#39;L-Triangular nucleus of septum (TRS,581)&#39;,
 598: &#39;L-Diagonal band nucleus (NDB,596)&#39;,
 599: &#39;L-Ventral anterior-lateral complex of the thalamus (VAL,629)&#39;,
 600: &#39;L-Ventral medial nucleus of the thalamus (VM,685)&#39;,
 601: &#39;L-Ventral posterolateral nucleus of the thalamus (VPL,718)&#39;,
 602: &#39;L-Ventral posteromedial nucleus of the thalamus (VPM,733)&#39;,
 603: &#39;L-Peripeduncular nucleus (PP,1044)&#39;,
 604: &#39;L-Medial geniculate complex (MG,475)&#39;,
 605: &#39;L-Dorsal part of the lateral geniculate complex (LGd,170)&#39;,
 606: &#39;L-Lateral posterior nucleus of the thalamus (LP,218)&#39;,
 607: &#39;L-Posterior complex of the thalamus (PO,1020)&#39;,
 608: &#39;L-Suprageniculate nucleus (SGN,325)&#39;,
 609: &#39;L-Anteroventral nucleus of thalamus (AV,255)&#39;,
 610: &#39;L-Anteromedial nucleus (AM,127)&#39;,
 611: &#39;L-Anterodorsal nucleus (AD,64)&#39;,
 612: &#39;L-Lateral dorsal nucleus of thalamus (LD,155)&#39;,
 613: &#39;L-Interanterodorsal nucleus of the thalamus (IAD,1113)&#39;,
 614: &#39;L-Interanteromedial nucleus of the thalamus (IAM,1120)&#39;,
 615: &#39;L-Intermediodorsal nucleus of the thalamus (IMD,59)&#39;,
 616: &#39;L-Mediodorsal nucleus of thalamus (MD,362)&#39;,
 617: &#39;L-Submedial nucleus of the thalamus (SMT,366)&#39;,
 618: &#39;L-Paraventricular nucleus of the thalamus (PVT,149)&#39;,
 619: &#39;L-Parataenial nucleus (PT,15)&#39;,
 620: &#39;L-Nucleus of reuniens (RE,181)&#39;,
 621: &#39;L-Rhomboid nucleus (RH,189)&#39;,
 622: &#39;L-Paracentral nucleus (PCN,907)&#39;,
 623: &#39;L-Central lateral nucleus of the thalamus (CL,575)&#39;,
 624: &#39;L-Central medial nucleus of the thalamus (CM,599)&#39;,
 625: &#39;L-Parafascicular nucleus (PF,930)&#39;,
 626: &#39;L-Reticular nucleus of the thalamus (RT,262)&#39;,
 627: &#39;L-Intergeniculate leaflet of the lateral geniculate complex (IGL,27)&#39;,
 628: &#39;L-Ventral part of the lateral geniculate complex (LGv,178)&#39;,
 629: &#39;L-Medial habenula (MH,483)&#39;,
 630: &#39;L-Lateral habenula (LH,186)&#39;,
 631: &#39;L-Subparafascicular nucleus, magnocellular part (SPFm,414)&#39;,
 632: &#39;L-Subparafascicular nucleus, parvicellular part (SPFp,422)&#39;,
 633: &#39;L-Subparafascicular area (SPA,609)&#39;,
 634: &#39;L-Ventral posterolateral nucleus of the thalamus, parvicellular part (VPLpc,725)&#39;,
 635: &#39;L-Ventral posteromedial nucleus of the thalamus, parvicellular part (VPMpc,741)&#39;,
 636: &#39;L-Posterior limiting nucleus of the thalamus (POL,1029)&#39;,
 637: &#39;L-Perireunensis nucleus (PR,1077)&#39;,
 638: &#39;L-Periventricular zone (PVZ,157)&#39;,
 639: &#39;L-Periventricular region (PVR,141)&#39;,
 640: &#39;L-Lateral mammillary nucleus (LM,210)&#39;,
 641: &#39;L-Medial mammillary nucleus (MM,491)&#39;,
 642: &#39;L-Hypothalamic lateral zone (LZ,290)&#39;,
 643: &#39;L-Tuberomammillary nucleus (TM,557)&#39;,
 644: &#39;L-Paraventricular hypothalamic nucleus, descending division (PVHd,63)&#39;,
 645: &#39;L-Anterior hypothalamic nucleus (AHN,88)&#39;,
 646: &#39;L-Medial preoptic nucleus (MPN,515)&#39;,
 647: &#39;L-Supramammillary nucleus (SUM,525)&#39;,
 648: &#39;L-Ventromedial hypothalamic nucleus (VMH,693)&#39;,
 649: &#39;L-Posterior hypothalamic nucleus (PH,946)&#39;,
 650: &#39;L-Dorsal premammillary nucleus (PMd,980)&#39;,
 651: &#39;L-Ventral premammillary nucleus (PMv,1004)&#39;,
 652: &#39;L-Periventricular zone (PVZ,157)&#39;,
 653: &#39;L-Periventricular region (PVR,141)&#39;,
 654: &#39;L-Superior colliculus, optic layer (SCop,851)&#39;,
 655: &#39;L-Superior colliculus, superficial gray layer (SCsg,842)&#39;,
 656: &#39;L-Midbrain, sensory related (MBsen,339)&#39;,
 657: &#39;L-Midbrain, motor related (MBmot,323)&#39;,
 658: &#39;L-Superior colliculus, motor related, deep gray layer (SCdg,26)&#39;,
 659: &#39;L-Superior colliculus, motor related, deep white layer (SCdw,42)&#39;,
 660: &#39;L-Superior colliculus, motor related, intermediate white layer (SCiw,17)&#39;,
 661: &#39;L-Superior colliculus, motor related, intermediate gray layer (SCig,10)&#39;,
 662: &#39;L-Anterior pretectal nucleus (APN,215)&#39;,
 663: &#39;L-Midbrain raphe nuclei (RAmb,165)&#39;,
 664: &#39;L-Midbrain, behavioral state related (MBsta,348)&#39;,
 665: &#39;L-Medial pretectal area (MPT,531)&#39;,
 666: &#39;L-Nucleus of the optic tract (NOT,628)&#39;,
 667: &#39;L-Nucleus of the posterior commissure (NPC,634)&#39;,
 668: &#39;L-Olivary pretectal nucleus (OP,706)&#39;,
 669: &#39;L-Posterior pretectal nucleus (PPT,1061)&#39;,
 670: &#39;L-Midbrain, behavioral state related (MBsta,348)&#39;,
 671: &#39;L-Midbrain, behavioral state related (MBsta,348)&#39;,
 672: &#39;L-Nucleus of the lateral lemniscus (NLL,612)&#39;,
 673: &#39;L-Principal sensory nucleus of the trigeminal (PSV,7)&#39;,
 674: &#39;L-Superior olivary complex, periolivary region (POR,122)&#39;,
 675: &#39;L-Superior olivary complex, medial part (SOCm,105)&#39;,
 676: &#39;L-Superior olivary complex, lateral part (SOCl,114)&#39;,
 677: &#39;L-Pons, motor related (P-mot,987)&#39;,
 678: &#39;L-Pons, behavioral state related (P-sat,1117)&#39;,
 679: &#39;L-Parabrachial nucleus (PB,867)&#39;,
 680: &#39;L-Pons, behavioral state related (P-sat,1117)&#39;,
 681: &#39;L-Pons, behavioral state related (P-sat,1117)&#39;,
 682: &#39;L-Area postrema (AP,207)&#39;,
 683: &#39;L-Dorsal cochlear nucleus (DCO,96)&#39;,
 684: &#39;L-Ventral cochlear nucleus (VCO,101)&#39;,
 685: &#39;L-Cuneate nucleus (CU,711)&#39;,
 686: &#39;L-Gracile nucleus (GR,1039)&#39;,
 687: &#39;L-External cuneate nucleus (ECU,903)&#39;,
 688: &#39;L-Nucleus of the trapezoid body (NTB,642)&#39;,
 689: &#39;L-Spinal nucleus of the trigeminal, caudal part (SPVC,429)&#39;,
 690: &#39;L-Spinal nucleus of the trigeminal, interpolar part (SPVI,437)&#39;,
 691: &#39;L-Spinal nucleus of the trigeminal, oral part (SPVO,445)&#39;,
 692: &#39;L-Medulla, motor related (MY-mot,370)&#39;,
 693: &#39;L-Nucleus ambiguus, dorsal division (AMBd,939)&#39;,
 694: &#39;L-Nucleus ambiguus, ventral division (AMBv,143)&#39;,
 695: &#39;L-Nucleus prepositus (PRP,169)&#39;,
 696: &#39;L-Lateral vestibular nucleus (LAV,209)&#39;,
 697: &#39;L-Medial vestibular nucleus (MV,202)&#39;,
 698: &#39;L-Spinal vestibular nucleus (SPIV,225)&#39;,
 699: &#39;L-Nucleus of Roller (NR,177)&#39;,
 700: &#39;L-Medulla, behavioral state related (MY-sat,379)&#39;,
 701: &#39;L-Superior vestibular nucleus (SUV,217)&#39;,
 702: &#39;L-Nucleus of the solitary tract (NTS,651)&#39;,
 703: &#39;L-Paragigantocellular reticular nucleus, dorsal part (PGRNd,970)&#39;,
 704: &#39;L-Paragigantocellular reticular nucleus, lateral part (PGRNl,978)&#39;,
 705: &#39;L-Medullary reticular nucleus, dorsal part (MDRNd,1098)&#39;,
 706: &#39;L-Medullary reticular nucleus, ventral part (MDRNv,1107)&#39;,
 707: &#39;L-Medulla, motor related (MY-mot,370)&#39;,
 708: &#39;L-Paraflocculus (PFL,1041)&#39;,
 709: &#39;L-Flocculus (FL,1049)&#39;,
 710: &#39;L-Fastigial nucleus (FN,989)&#39;,
 711: &#39;L-Interposed nucleus (IP,91)&#39;,
 712: &#39;L-Dentate nucleus (DN,846)&#39;,
 713: &#39;L-Lingula (I) (LING,912)&#39;,
 714: &#39;L-Central lobule (CENT,920)&#39;,
 715: &#39;L-Culmen (CUL,928)&#39;,
 716: &#39;L-Declive (VI) (DEC,936)&#39;,
 717: &#39;L-Folium-tuber vermis (VII) (FOTU,944)&#39;,
 718: &#39;L-Pyramus (VIII) (PYR,951)&#39;,
 719: &#39;L-Uvula (IX) (UVU,957)&#39;,
 720: &#39;L-Nodulus (X) (NOD,968)&#39;,
 721: &#39;L-Simple lobule (SIM,1007)&#39;,
 722: &#39;L-Ansiform lobule (AN,1017)&#39;,
 723: &#39;L-Paramedian lobule (PRM,1025)&#39;,
 724: &#39;L-Copula pyramidis (COPY,1033)&#39;}
</pre></div>
</div>
</div>
</div>
<section id="finer-scale">
<h2>Finer scale<a class="headerlink" href="#finer-scale" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_all</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
    <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_organized_data</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;atlas-2048_unfiltered_unnormalized&#39;</span><span class="p">,</span><span class="c1">#&#39;filtered_low-0.001_high-4.000_ord-2_normalized&#39;,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">subject</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">session</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">run</span><span class="o">=</span><span class="n">run</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],))</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">time_series</span> <span class="ow">in</span> <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">num_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">num_nan</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">num_nan</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">x</span><span class="p">[</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
    
    <span class="n">t</span> <span class="o">=</span> <span class="mi">1800</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">_slice</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="o">+</span> <span class="n">res</span> <span class="o">*</span> <span class="mi">120</span><span class="p">]</span>
    <span class="n">vminmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_slice</span><span class="p">))</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_slice</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">res</span><span class="p">):</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">idx</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">idx</span><span class="o">%</span><span class="k">ncols</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">_slice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span> <span class="o">*</span> <span class="n">res</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">vminmax</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vminmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;RUN: </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">run</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_137_0.png" src="_images/play_kmeans_parcellation-128_137_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_137_2.png" src="_images/play_kmeans_parcellation-128_137_2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_137_4.png" src="_images/play_kmeans_parcellation-128_137_4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_137_6.png" src="_images/play_kmeans_parcellation-128_137_6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">run</span><span class="p">,</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">data_all</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="n">run</span><span class="p">][</span><span class="s1">&#39;ca&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">_df</span><span class="p">])</span>

<span class="n">node_labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node_labels</span><span class="p">)}</span>

<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
mean    18.729764
std     94.845306
dtype: float64



3
mean    -4.891482
std     69.669818
dtype: float64



5
mean     1.756480
std     83.384296
dtype: float64



7
mean     2.402372
std     67.622433
dtype: float64
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>2039</th>
      <th>2040</th>
      <th>2041</th>
      <th>2042</th>
      <th>2043</th>
      <th>2044</th>
      <th>2045</th>
      <th>2046</th>
      <th>2047</th>
      <th>2048</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>...</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
      <td>22000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.539600</td>
      <td>2.492350</td>
      <td>2.402239</td>
      <td>2.454531</td>
      <td>2.459049</td>
      <td>2.404069</td>
      <td>2.464216</td>
      <td>2.498584</td>
      <td>2.448209</td>
      <td>2.661953</td>
      <td>...</td>
      <td>2.486342</td>
      <td>2.648399</td>
      <td>2.226385</td>
      <td>3.090426</td>
      <td>3.118287</td>
      <td>3.467110</td>
      <td>2.769338</td>
      <td>3.547502</td>
      <td>3.450560</td>
      <td>3.686031</td>
    </tr>
    <tr>
      <th>std</th>
      <td>21.071502</td>
      <td>21.204419</td>
      <td>21.854102</td>
      <td>23.874212</td>
      <td>22.498945</td>
      <td>20.225628</td>
      <td>21.738131</td>
      <td>24.914106</td>
      <td>24.296303</td>
      <td>24.568039</td>
      <td>...</td>
      <td>35.609023</td>
      <td>35.577926</td>
      <td>35.091944</td>
      <td>30.230269</td>
      <td>31.308877</td>
      <td>32.673118</td>
      <td>29.448787</td>
      <td>27.927970</td>
      <td>27.071712</td>
      <td>27.213138</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-81.164087</td>
      <td>-77.025150</td>
      <td>-81.385529</td>
      <td>-80.835804</td>
      <td>-79.285951</td>
      <td>-69.821959</td>
      <td>-72.667626</td>
      <td>-91.017195</td>
      <td>-93.195370</td>
      <td>-93.439453</td>
      <td>...</td>
      <td>-140.849974</td>
      <td>-129.244875</td>
      <td>-153.813993</td>
      <td>-102.539254</td>
      <td>-112.790723</td>
      <td>-113.327305</td>
      <td>-119.016298</td>
      <td>-104.273515</td>
      <td>-91.550085</td>
      <td>-87.709121</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-11.604598</td>
      <td>-11.684879</td>
      <td>-12.269345</td>
      <td>-13.818012</td>
      <td>-12.727596</td>
      <td>-11.154096</td>
      <td>-12.128446</td>
      <td>-14.345256</td>
      <td>-13.916741</td>
      <td>-13.730839</td>
      <td>...</td>
      <td>-21.251384</td>
      <td>-21.031502</td>
      <td>-21.487150</td>
      <td>-16.989568</td>
      <td>-17.887082</td>
      <td>-18.712641</td>
      <td>-16.996166</td>
      <td>-15.117875</td>
      <td>-14.789124</td>
      <td>-14.466057</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.135894</td>
      <td>2.310709</td>
      <td>2.156601</td>
      <td>1.852993</td>
      <td>2.287265</td>
      <td>1.914692</td>
      <td>2.131674</td>
      <td>2.090989</td>
      <td>2.212126</td>
      <td>2.065520</td>
      <td>...</td>
      <td>1.208709</td>
      <td>0.643312</td>
      <td>1.008846</td>
      <td>2.009102</td>
      <td>1.852542</td>
      <td>1.593085</td>
      <td>1.495724</td>
      <td>2.515808</td>
      <td>1.911372</td>
      <td>2.174827</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>16.161393</td>
      <td>16.123364</td>
      <td>16.597939</td>
      <td>17.762278</td>
      <td>17.255288</td>
      <td>15.379847</td>
      <td>16.452061</td>
      <td>18.522957</td>
      <td>18.290226</td>
      <td>18.506764</td>
      <td>...</td>
      <td>24.823580</td>
      <td>24.342867</td>
      <td>24.836976</td>
      <td>22.336606</td>
      <td>22.875130</td>
      <td>23.848172</td>
      <td>21.132989</td>
      <td>21.277934</td>
      <td>20.259388</td>
      <td>20.343965</td>
    </tr>
    <tr>
      <th>max</th>
      <td>103.121706</td>
      <td>94.835361</td>
      <td>93.820520</td>
      <td>114.802198</td>
      <td>120.430579</td>
      <td>92.793580</td>
      <td>105.466415</td>
      <td>117.265454</td>
      <td>116.200744</td>
      <td>111.067106</td>
      <td>...</td>
      <td>212.469960</td>
      <td>200.734613</td>
      <td>213.529444</td>
      <td>181.323752</td>
      <td>179.041833</td>
      <td>169.631887</td>
      <td>222.316534</td>
      <td>165.333862</td>
      <td>187.587778</td>
      <td>169.166023</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 2048 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]</span>
<span class="n">corrs</span> <span class="o">=</span> <span class="n">get_corrs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7fc3ba983d60&gt;
</pre></div>
</div>
<img alt="_images/play_kmeans_parcellation-128_143_1.png" src="_images/play_kmeans_parcellation-128_143_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="n">reload</span><span class="p">(</span><span class="n">plotting</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_corrs</span><span class="p">(</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">],</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_146_0.png" src="_images/play_kmeans_parcellation-128_146_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_corr_hist</span><span class="p">(</span>
    <span class="n">corr_list</span><span class="o">=</span><span class="p">[</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson_corr&#39;</span><span class="p">],</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman_corr&#39;</span><span class="p">]],</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_149_0.png" src="_images/play_kmeans_parcellation-128_149_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphs</span> <span class="o">=</span> <span class="p">{</span><span class="n">th</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">th</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_louvain</span> <span class="o">=</span> <span class="n">run_louvain</span><span class="p">(</span><span class="n">graphs</span><span class="p">[</span><span class="mf">0.7</span><span class="p">],</span> <span class="n">res</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f0b74294aec9446fa3b53c38f5cb45a5", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">390</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">560</span><span class="p">,</span> <span class="mi">650</span><span class="p">]</span>
<span class="n">plot_louvain_results</span><span class="p">(</span><span class="n">results_louvain</span><span class="p">,</span> <span class="n">selected_idxs</span><span class="o">=</span><span class="n">selected_idxs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_153_0.png" src="_images/play_kmeans_parcellation-128_153_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_louvain_communities</span><span class="p">(</span>
    <span class="n">pearson</span><span class="o">=</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">],</span>
    <span class="n">spearman</span><span class="o">=</span><span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">],</span>
    <span class="n">atlas</span><span class="o">=</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;atlas_kmeans&#39;</span><span class="p">],</span>
    <span class="n">modularities</span><span class="o">=</span><span class="n">results_louvain</span><span class="p">[</span><span class="s1">&#39;modularities&#39;</span><span class="p">],</span>
    <span class="n">selected_idxs</span><span class="o">=</span><span class="n">selected_idxs</span><span class="p">,</span>
    <span class="n">pearson_th</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">spearman_th</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_155_0.png" src="_images/play_kmeans_parcellation-128_155_0.png" />
</div>
</div>
</section>
<section id="network-measures">
<h2>Network measures<a class="headerlink" href="#network-measures" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;session&#39;</span><span class="p">,</span> <span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;node_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;adjacency&#39;</span><span class="p">,</span> <span class="s1">&#39;graph&#39;</span><span class="p">,</span> <span class="s1">&#39;cfg&#39;</span><span class="p">)</span>

<span class="n">Data</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="n">typename</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span>
    <span class="n">field_names</span><span class="o">=</span><span class="n">field_names</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">]</span>

<span class="n">data_all</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">num_subjects</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">num_sessions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">num_runs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>

            <span class="n">load</span> <span class="o">=</span> <span class="n">load_organized_data</span><span class="p">(</span>
                <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;unfiltered_normalized&#39;</span><span class="p">,</span>
                <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
                <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span>
                <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
                <span class="n">run</span><span class="o">=</span><span class="n">run</span><span class="p">,</span>
            <span class="p">)</span>
            
            <span class="k">if</span> <span class="n">load</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">])</span>
            <span class="n">node_labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node_labels</span><span class="p">)}</span>
            <span class="n">corrs</span> <span class="o">=</span> <span class="n">get_corrs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span>

            <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;sub-SLC</span><span class="si">{:02d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">+=</span> <span class="s1">&#39;_ses-</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">+=</span> <span class="s1">&#39;_run-</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">corrs</span><span class="p">[</span><span class="s1">&#39;spearman&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">]</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                
                <span class="n">data_all</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">_th-</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">th</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span>
                    <span class="n">subject</span><span class="o">=</span><span class="n">subject</span><span class="p">,</span>
                    <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
                    <span class="n">run</span><span class="o">=</span><span class="n">run</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="n">th</span><span class="p">,</span>
                    <span class="n">node_labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span>
                    <span class="n">adjacency</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
                    <span class="n">graph</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
                    <span class="n">cfg</span><span class="o">=</span><span class="n">mk_config_model</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4c3fe42821274e07b54f6aeb047ec125", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning! File not found, moving on . . .
[&#39;sub-SLC03&#39;, &#39;ses-1&#39;, &#39;run-1&#39;, &#39;organized&#39;, &#39;ca&#39;]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning! File not found, moving on . . .
[&#39;sub-SLC05&#39;, &#39;ses-1&#39;, &#39;run-5&#39;, &#39;organized&#39;, &#39;ca&#39;]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning! File not found, moving on . . .
[&#39;sub-SLC06&#39;, &#39;ses-3&#39;, &#39;run-2&#39;, &#39;organized&#39;, &#39;ca&#39;]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning! File not found, moving on . . .
[&#39;sub-SLC08&#39;, &#39;ses-1&#39;, &#39;run-7&#39;, &#39;organized&#39;, &#39;ca&#39;]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning! File not found, moving on . . .
[&#39;sub-SLC10&#39;, &#39;ses-3&#39;, &#39;run-1&#39;, &#39;organized&#39;, &#39;ca&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># network measures</span>
<span class="kn">from</span> <span class="nn">networkx.algorithms.cluster</span> <span class="kn">import</span> <span class="n">transitivity</span><span class="p">,</span> <span class="n">average_clustering</span>
<span class="kn">from</span> <span class="nn">networkx.algorithms.assortativity</span> <span class="kn">import</span> <span class="n">degree_pearson_correlation_coefficient</span>
<span class="kn">from</span> <span class="nn">networkx.algorithms.efficiency_measures</span> <span class="kn">import</span> <span class="n">global_efficiency</span><span class="p">,</span> <span class="n">local_efficiency</span>
<span class="kn">from</span> <span class="nn">networkx.algorithms.approximation.clique</span> <span class="kn">import</span> <span class="n">large_clique_size</span>
<span class="kn">from</span> <span class="nn">networkx.algorithms.shortest_paths.generic</span> <span class="kn">import</span> <span class="n">average_shortest_path_length</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measures_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">dict_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data_all</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="c1"># nodes, degrees = list(zip(*g.degree()))</span>
    
    <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">node_labels</span><span class="p">)</span>
    
    <span class="c1"># the real graph</span>
    <span class="n">_avg_clustering</span> <span class="o">=</span> <span class="n">average_clustering</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
    <span class="n">_local_efficiency</span> <span class="o">=</span> <span class="n">local_efficiency</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">_large_clique_ratio</span> <span class="o">=</span> <span class="n">large_clique_size</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_avg_shortest_path_len</span> <span class="o">=</span> <span class="n">average_shortest_path_length</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">_avg_shortest_path_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">_global_efficiency</span> <span class="o">=</span> <span class="n">global_efficiency</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">_degree_corr_coef</span> <span class="o">=</span> <span class="n">degree_pearson_correlation_coefficient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">subject</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;session&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">session</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">run</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;num_regions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">num_nodes</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;lbl&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;avg_clustering&#39;</span><span class="p">,</span>
            <span class="s1">&#39;local_efficiency&#39;</span><span class="p">,</span>
            <span class="s1">&#39;large_clique_ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;avg_shortest_path_len&#39;</span><span class="p">,</span>
            <span class="s1">&#39;global_efficiency&#39;</span><span class="p">,</span>
            <span class="s1">&#39;degree_corr_coef&#39;</span><span class="p">,</span>  <span class="c1"># assortativity</span>
        <span class="p">],</span>
        <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">_avg_clustering</span><span class="p">,</span>
            <span class="n">_local_efficiency</span><span class="p">,</span>
            <span class="n">_large_clique_ratio</span><span class="p">,</span>
            <span class="n">_avg_shortest_path_len</span><span class="p">,</span>
            <span class="n">_global_efficiency</span><span class="p">,</span>
            <span class="n">_degree_corr_coef</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
    <span class="n">dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
    

    <span class="c1"># configuration model</span>
    <span class="n">_avg_clustering</span> <span class="o">=</span> <span class="n">average_clustering</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
    <span class="n">_local_efficiency</span> <span class="o">=</span> <span class="n">local_efficiency</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">_large_clique_ratio</span> <span class="o">=</span> <span class="n">large_clique_size</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_nodes</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_avg_shortest_path_len</span> <span class="o">=</span> <span class="n">average_shortest_path_length</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">_avg_shortest_path_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">_global_efficiency</span> <span class="o">=</span> <span class="n">global_efficiency</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">_degree_corr_coef</span> <span class="o">=</span> <span class="n">degree_pearson_correlation_coefficient</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cfg&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">subject</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;session&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">session</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">run</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;num_regions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">num_nodes</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;lbl&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;avg_clustering&#39;</span><span class="p">,</span>
            <span class="s1">&#39;local_efficiency&#39;</span><span class="p">,</span>
            <span class="s1">&#39;large_clique_ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;avg_shortest_path_len&#39;</span><span class="p">,</span>
            <span class="s1">&#39;global_efficiency&#39;</span><span class="p">,</span>
            <span class="s1">&#39;degree_corr_coef&#39;</span><span class="p">,</span>  <span class="c1"># assortativity</span>
        <span class="p">],</span>
        <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">_avg_clustering</span><span class="p">,</span>
            <span class="n">_local_efficiency</span><span class="p">,</span>
            <span class="n">_large_clique_ratio</span><span class="p">,</span>
            <span class="n">_avg_shortest_path_len</span><span class="p">,</span>
            <span class="n">_global_efficiency</span><span class="p">,</span>
            <span class="n">_degree_corr_coef</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
    <span class="n">dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

<span class="n">measures_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dict_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "64d5be6819ef489b8aba2a787bde6157", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measures_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tag</th>
      <th>subject</th>
      <th>session</th>
      <th>run</th>
      <th>threshold</th>
      <th>num_regions</th>
      <th>lbl</th>
      <th>val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>real</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.7</td>
      <td>66</td>
      <td>avg_clustering</td>
      <td>0.609992</td>
    </tr>
    <tr>
      <th>1</th>
      <td>real</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.7</td>
      <td>66</td>
      <td>local_efficiency</td>
      <td>0.839339</td>
    </tr>
    <tr>
      <th>2</th>
      <td>real</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.7</td>
      <td>66</td>
      <td>large_clique_ratio</td>
      <td>0.378788</td>
    </tr>
    <tr>
      <th>3</th>
      <td>real</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.7</td>
      <td>66</td>
      <td>avg_shortest_path_len</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>real</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.7</td>
      <td>66</td>
      <td>global_efficiency</td>
      <td>0.699184</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12295</th>
      <td>cfg</td>
      <td>10</td>
      <td>3</td>
      <td>7</td>
      <td>0.9</td>
      <td>62</td>
      <td>local_efficiency</td>
      <td>0.066340</td>
    </tr>
    <tr>
      <th>12296</th>
      <td>cfg</td>
      <td>10</td>
      <td>3</td>
      <td>7</td>
      <td>0.9</td>
      <td>62</td>
      <td>large_clique_ratio</td>
      <td>0.048387</td>
    </tr>
    <tr>
      <th>12297</th>
      <td>cfg</td>
      <td>10</td>
      <td>3</td>
      <td>7</td>
      <td>0.9</td>
      <td>62</td>
      <td>avg_shortest_path_len</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12298</th>
      <td>cfg</td>
      <td>10</td>
      <td>3</td>
      <td>7</td>
      <td>0.9</td>
      <td>62</td>
      <td>global_efficiency</td>
      <td>0.207673</td>
    </tr>
    <tr>
      <th>12299</th>
      <td>cfg</td>
      <td>10</td>
      <td>3</td>
      <td>7</td>
      <td>0.9</td>
      <td>62</td>
      <td>degree_corr_coef</td>
      <td>0.011740</td>
    </tr>
  </tbody>
</table>
<p>12300 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_ths</span> <span class="o">=</span> <span class="n">measures_df</span><span class="o">.</span><span class="n">threshold</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">_lbls</span> <span class="o">=</span> <span class="n">measures_df</span><span class="o">.</span><span class="n">lbl</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">_ths</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">_lbls</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">th</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_ths</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_lbls</span><span class="p">):</span>
        <span class="n">selected_df</span> <span class="o">=</span> <span class="n">measures_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">measures_df</span><span class="o">.</span><span class="n">threshold</span> <span class="o">==</span> <span class="n">th</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">measures_df</span><span class="o">.</span><span class="n">lbl</span> <span class="o">==</span> <span class="n">lbl</span><span class="p">)]</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">selected_df</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lbl</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;thres: </span><span class="si">{:.2f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;net_measures.pdf&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/play_kmeans_parcellation-128_176_0.png" src="_images/play_kmeans_parcellation-128_176_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: make this general</span>

<span class="k">def</span> <span class="nf">plot_louvain_communities</span><span class="p">(</span>
    <span class="n">graphs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="c1"># pearson: dict,</span>
    <span class="c1"># spearman: dict,</span>
    <span class="n">atlas</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="c1"># modularities: dict,</span>
    <span class="c1"># selected_idxs: list,</span>
    <span class="c1"># pearson_th: float = 0.7,</span>
    <span class="c1"># spearman_th: float = 0.8,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="p">):</span>

    <span class="c1"># x0, y0 = tuple(zip(*modularities.items()))</span>
    <span class="c1"># best_idx = np.argmax(y0)</span>
    <span class="c1"># max_mod = y0[best_idx]</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">plot_idxs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">selected_idxs</span> <span class="o">+</span> <span class="p">[</span><span class="n">best_idx</span><span class="p">])</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_idxs</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plot_idxs</span><span class="p">):</span>
        <span class="c1"># g = nx.from_numpy_matrix(spearman[spearman_th])</span>
        <span class="n">coms</span> <span class="o">=</span> <span class="n">cdlib_algorithms</span><span class="o">.</span><span class="n">louvain</span><span class="p">(</span>
            <span class="n">g_original</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
            <span class="n">resolution</span><span class="o">=</span><span class="n">best_idx</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
            <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="s1">&#39;community&#39;</span><span class="p">,</span> <span class="s1">&#39;partition&#39;</span><span class="p">,</span> <span class="n">community</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">filter_islands</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">atlas</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">,</span> <span class="n">min_com_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="c1"># comm_mat, comm_dict = filter_islands(partition, labels, scale=size, min_com_size=5)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">nx_comm</span><span class="o">.</span><span class="n">modularity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">communities</span><span class="o">=</span><span class="n">coms</span><span class="o">.</span><span class="n">communities</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;comm_mat&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;res = </span><span class="si">{:.3f}</span><span class="se">\n\n</span><span class="s1">Q = </span><span class="si">{:.3f}</span><span class="s1">,  # com = </span><span class="si">{:d}</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x0</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">comm_mat</span><span class="p">[</span><span class="n">comm_mat</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_matrix</span><span class="p">(</span><span class="n">pearson</span><span class="p">[</span><span class="mf">0.8</span><span class="p">])</span>
        <span class="n">partition</span> <span class="o">=</span> <span class="n">community_louvain</span><span class="o">.</span><span class="n">best_partition</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">x0</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">comm_mat</span><span class="p">,</span> <span class="n">comm_dict</span> <span class="o">=</span> <span class="n">filter_islands</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">min_com_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">nx_comm</span><span class="o">.</span><span class="n">modularity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">communities</span><span class="o">=</span><span class="n">comm_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">comm_mat</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Q = </span><span class="si">{:.3f}</span><span class="s1">,  # com = </span><span class="si">{:d}</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">comm_mat</span><span class="p">[</span><span class="n">comm_mat</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;spearman</span><span class="se">\n</span><span class="s1">(th = </span><span class="si">{:.2f}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spearman_th</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;pearson</span><span class="se">\n</span><span class="s1">(th = </span><span class="si">{:.2f}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pearson_th</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hadi Vafaii<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>