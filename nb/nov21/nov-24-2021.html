
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>November 24th, 2021 (corr distrs) &#8212; Ca-fMRI [Daily Progress]</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="November 26th, 2021 (identify spikes)" href="nov-26-2021.html" />
    <link rel="prev" title="November 13th, 2021" href="nov-13-2021.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Ca-fMRI [Daily Progress]</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/feb21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/feb21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-12-2021.html">
     February, 12th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-13-2021.html">
     February, 13th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-16-2021.html">
     February, 16th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-20-2021.html">
     February, 20th 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/mar21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/mar21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-10-2021.html">
     March 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-13-2021.html">
     March 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-15-2021.html">
     March 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-16-2021.html">
     March 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-18-2021.html">
     March 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-19-2021.html">
     March 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-26-2021.html">
     March 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-29-2021.html">
     March 29th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/apr21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/apr21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr21/apr-07-2021.html">
     April 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr21/apr-30-2021.html">
     April 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  May 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/may21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/may21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-08-2021.html">
     May 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-09-2021.html">
     May 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-11-2021.html">
     May 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-12-2021.html">
     May 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-20-2021.html">
     May 20th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-24-2021.html">
     May 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-31-2021.html">
     May 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  June 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jun21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/jun21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-05-2021.html">
     June 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-06-2021.html">
     June 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-07-2021.html">
     June 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-12-2021.html">
     June 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-13-2021.html">
     June 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-15-2021.html">
     June 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-17-2021.html">
     June 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-18-2021.html">
     June 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-19-2021.html">
     June 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-21-2021.html">
     June 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-24-2021.html">
     June 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-26-2021.html">
     June, 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-29-2021.html">
     June 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-30-2021.html">
     June 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  July 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jul21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/jul21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-01-2021.html">
     July 1st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-09-2021.html">
     July 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-11-2021.html">
     July 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-31-2021.html">
     July 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  August 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/aug21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/aug21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../aug21/aug-21-2021.html">
     Aug 21st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  September 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/sep21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/sep21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-07-2021.html">
     Sep 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-08-2021.html">
     Sep 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-15-2021.html">
     Sep 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-19-2021.html">
     Sep 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-24-2021.html">
     Sep 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-25-2021.html">
     Sep 25th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-27-2021.html">
     Sep 27th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  October 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/oct21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/oct21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-06-2021.html">
     October 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-10-2021.html">
     October 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-11-2021.html">
     October 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-12-2021.html">
     October 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-16-2021.html">
     October 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-17-2021.html">
     October 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-21-2021.html">
     October 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-26-2021.html">
     October 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-27-2021.html">
     October 27th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-29-2021.html">
     October 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-30-2021.html">
     October 30th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-31-2021.html">
     October 31th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  November 2021
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/nov21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../md/nov21_updates.html">
   Updates
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="nov-05-2021.html">
     November 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nov-06-2021.html">
     November 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nov-09-2021.html">
     November 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nov-13-2021.html">
     November 13th, 2021
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     November 24th, 2021 (corr distrs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nov-26-2021.html">
     November 26th, 2021 (identify spikes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nov-29-2021.html">
     November 29th, 2021 (figs 1 and 2)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  December 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/dec21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/dec21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-01-2021.html">
     Dec 1st, 2021 (topo dist)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/nb/nov21/nov-24-2021.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hadivafaii/Ca-fMRI"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/hadivafaii/Ca-fMRI/issues/new?title=Issue%20on%20page%20%2Fnb/nov21/nov-24-2021.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hadivafaii/Ca-fMRI/master?urlpath=tree/docs/nb/nov21/nov-24-2021.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#distribution-of-correaltion-values">
   Distribution of correaltion values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregate-fig-combine-runs">
     1) Aggregate fig (combine runs)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#each-run-separately">
     2) Each run separately
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-bookkeeping-purposes-i-make-the-same-plot-for-all-runs-below">
       For bookkeeping purposes, I make the same plot for all runs below:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-in-common-space-ignore">
   Data in common space (ignore)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="november-24th-2021-corr-distrs">
<h1>November 24th, 2021 (corr distrs)<a class="headerlink" href="#november-24th-2021-corr-distrs" title="Permalink to this headline">¶</a></h1>
<p><strong>Motivation</strong>: Visualizing distribution of correlation values, left/right hemisphere discrepacny in BOLD, some discussion on GSR <br></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span> <span class="k">as</span> <span class="n">dc</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="kn">from</span> <span class="nn">myterial</span> <span class="kn">import</span> <span class="n">orange</span><span class="p">,</span> <span class="n">blue_grey</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">rgb2hex</span><span class="p">,</span> <span class="n">to_rgb</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># set style &amp; no interpolalation</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.interpolation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/tmp&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/_extras&#39;</span><span class="p">)</span>
<span class="n">lfr_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Documents/workspaces/lfr/binary_overlapping&#39;</span><span class="p">)</span>


<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_Ca-fMRI&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">make_tree_graph</span>
<span class="kn">from</span> <span class="nn">register.parcellation</span> <span class="kn">import</span> <span class="n">Parcellation</span>
<span class="kn">from</span> <span class="nn">analysis.hierarchical</span> <span class="kn">import</span> <span class="n">Hierarchical</span>
<span class="kn">from</span> <span class="nn">analysis.fourier</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.bootstrap</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.svinet</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.group</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.lfr</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.render</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">model.mouse</span> <span class="kn">import</span> <span class="n">Mice</span>
<span class="kn">from</span> <span class="nn">model.configuration</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="c1"># warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="k">def</span> <span class="nf">show_corrs</span><span class="p">(</span><span class="n">adj_dict</span><span class="p">,</span> <span class="n">l_ids</span><span class="p">,</span> <span class="n">r_ids</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">)):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">adj_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">xl</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">l_ids</span><span class="p">][:,</span> <span class="n">l_ids</span><span class="p">]</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">r_ids</span><span class="p">][:,</span> <span class="n">r_ids</span><span class="p">]</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()])</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lbl</span><span class="si">}</span><span class="se">\n</span><span class="s2">(left hemis)&quot;</span><span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lbl</span><span class="si">}</span><span class="se">\n</span><span class="s2">(right hemis)&quot;</span><span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">xl</span><span class="p">[</span><span class="n">xl</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">xr</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lbl</span><span class="si">}</span><span class="s2"> hist&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">xl</span><span class="p">[</span><span class="n">xl</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">xr</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lbl</span><span class="si">}</span><span class="s2"> ecdf&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">((</span><span class="mi">192</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">mice</span><span class="o">.</span><span class="n">setup_func_data</span><span class="p">(</span><span class="n">bold_gsr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="n">adj_ca</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">adj_bold</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">adj_bold_nogsr</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">ses</span><span class="p">,</span> <span class="n">run</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">looper</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">run</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">net_ca</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;ca2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
        <span class="n">net_bold</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;bold-lite&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">continue</span>
        
    <span class="k">if</span> <span class="n">net_ca</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">net_bold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">continue</span>
        
    <span class="n">base</span> <span class="o">=</span> <span class="n">Base</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bold-lite&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">get_adj_mat</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;pearson&#39;</span><span class="p">)</span>

    <span class="n">adj_ca</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">net_ca</span><span class="o">.</span><span class="n">adj</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">adj_bold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">net_bold</span><span class="o">.</span><span class="n">adj</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">adj_bold_nogsr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">adj_ca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">adj_ca</span><span class="p">)</span>
<span class="n">adj_bold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">adj_bold</span><span class="p">)</span>
<span class="n">adj_bold_nogsr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">adj_bold_nogsr</span><span class="p">)</span>

<span class="n">adj_ca</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">adj_bold</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">adj_bold_nogsr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9dee4de4589248f4a547639058dbf5bb", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">sub-SLC03_ses-1_run-<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">((</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span><span style="font-weight: bold">))</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;sub-SLC02_ses-3_run-5&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;ca2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="distribution-of-correaltion-values">
<h2>Distribution of correaltion values<a class="headerlink" href="#distribution-of-correaltion-values" title="Permalink to this headline">¶</a></h2>
<p>The goal here is to take a look at how correaltion values are distributed.  I find that there is a clear shift in distribution of left vs. right intra-hemisphere correlations in BOLD.  I also show that GSR completely shifts the distribution of correaltions toward negative values.  This is a consequence of the “mathematical mandate” in GSR.</p>
<div class="section" id="aggregate-fig-combine-runs">
<h3>1) Aggregate fig (combine runs)<a class="headerlink" href="#aggregate-fig-combine-runs" title="Permalink to this headline">¶</a></h3>
<p>First let’s use data from all runs to visualize distribution of correlations.  To be clear: here I take adjacency matrices from all runs and lump all the correlation values together.  In the next section I will make the same plot for each run separately to compare.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">7.3</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">adj_bold</span><span class="p">,</span> <span class="n">adj_ca</span><span class="p">]):</span>
    <span class="n">xl</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="n">base</span><span class="o">.</span><span class="n">l_ids</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">l_ids</span><span class="p">]</span>
    <span class="n">xr</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="n">base</span><span class="o">.</span><span class="n">r_ids</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">r_ids</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">xl</span><span class="p">[</span><span class="n">xl</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span>
        <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;left hemis&#39;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">xr</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span>
        <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;right hemis&#39;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">xl</span><span class="p">[</span><span class="n">xl</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;left hemis&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">xr</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;right hemis&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
    <span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">adj_ca</span><span class="p">[</span><span class="n">adj_ca</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ca&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">adj_bold</span><span class="p">[</span><span class="n">adj_bold</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BOLD&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">adj_bold_nogsr</span><span class="p">[</span><span class="n">adj_bold_nogsr</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
    <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BOLD (no GSR)&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">adj_ca</span><span class="p">[</span><span class="n">adj_ca</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ca&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">adj_bold</span><span class="p">[</span><span class="n">adj_bold</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BOLD&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">ecdfplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">adj_bold_nogsr</span><span class="p">[</span><span class="n">adj_bold_nogsr</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BOLD (no GSR)&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
    
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BOLD&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ca&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BOLD &amp; Ca&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/nov-24-2021_12_0.png" src="../../_images/nov-24-2021_12_0.png" />
</div>
</div>
<p><strong>Figure description:</strong> I have plotted histogram (first row) and Empirical CDF (second row) plots using correlation values from all runs combined. In the first 2 columns of the figure, I have used different colors to show the intra-hemisphere correlation values from left and right hemispheres.  The goal is to visualize the discrepancy in BOLD.  To be clear: I just take the intra-hemisphere sub-blocks of the covariance matrix and make separate plots using different colors for each hemisphere.  Blue is used for left hemisphere, red is used for right heisphere.  More details:</p>
<ul class="simple">
<li><p>1st column: BOLD (left and right hemispheres separate)</p></li>
<li><p>2nd column: Ca (left and right hemispheres separate)</p></li>
<li><p>3d column: BOLD with and without GSR and Ca (left and right hemispheres not separated in this case)</p></li>
</ul>
<p><strong>Some observations:</strong></p>
<ol class="simple">
<li><p>There is a clear shift in the distribution of left and right correlation values in BOLD.  This could be due to many reasons.  I am waiting to see what Gabe finds, but this is not normal.  Could it be due to poor co-registration? Could it be due to the fact that the surgery was done on the left hemisphere?</p></li>
<li><p>Large difference in distribution of correlations in BOLD and Ca. This is not too troubling.  Appropriate thresholding the covariance matrix gets rid of this issue by achieving some sort of normalization across modalities.</p></li>
<li><p>Using GSR in BOLD has an enormous effect on the distribution of correlations.  We should do something about this.  Leaving noise in there is not good, but using GSR in its most general/simple form in not good either.</p></li>
</ol>
</div>
<div class="section" id="each-run-separately">
<h3>2) Each run separately<a class="headerlink" href="#each-run-separately" title="Permalink to this headline">¶</a></h3>
<p>Now let’s focus on a single run that shows significant discrepancy for BOLD.  For example here is run 5 from session 3 from animal # 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;sub-SLC02_ses-3_run-5&#39;</span>
<span class="n">net_ca</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;ca2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
<span class="n">net_bold</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;bold-lite&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">Base</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bold-lite&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">get_adj_mat</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;pearson&#39;</span><span class="p">)</span>

<span class="n">adj_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;BOLD&#39;</span><span class="p">:</span> <span class="n">net_bold</span><span class="o">.</span><span class="n">adj</span><span class="p">,</span> <span class="s1">&#39;BOLD (no GSR)&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Ca$^{2+}$&#39;</span><span class="p">:</span> <span class="n">net_ca</span><span class="o">.</span><span class="n">adj</span><span class="p">}</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">show_corrs</span><span class="p">(</span><span class="n">adj_dict</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">l_ids</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">r_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/nov-24-2021_16_0.png" src="../../_images/nov-24-2021_16_0.png" />
</div>
</div>
<p><strong>Observations:</strong> Please see first row.  These show intra-hemisphere adjacency matrices for each hemisphere separately for each data modality.  For BOLD (1st vs. 2nd columns), we see this extreme difference between left and right intra-hemisphere correlations.  Why does it have to be this extreme?  This can’t be real.  The difference is also visible in the histogram and ECDF plots in the second row.</p>
<p>We also see that not having GSR is not a good idea.  We should use a smarter version of GSR, looking forward to what Gabe comes up with.  Note that the left/right discrepancy is also visible in BOLD without GSR.</p>
<div class="section" id="for-bookkeeping-purposes-i-make-the-same-plot-for-all-runs-below">
<h4>For bookkeeping purposes, I make the same plot for all runs below:<a class="headerlink" href="#for-bookkeeping-purposes-i-make-the-same-plot-for-all-runs-below" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mice</span><span class="o">.</span><span class="n">looper</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">net_ca</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;ca2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
        <span class="n">net_bold</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;bold-lite&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">continue</span>
        
    <span class="k">if</span> <span class="n">net_ca</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">net_bold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">continue</span>
        
    <span class="n">base</span> <span class="o">=</span> <span class="n">Base</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bold-lite&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">get_adj_mat</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;pearson&#39;</span><span class="p">)</span>
    
    <span class="n">adj_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;BOLD&#39;</span><span class="p">:</span> <span class="n">net_bold</span><span class="o">.</span><span class="n">adj</span><span class="p">,</span> <span class="s1">&#39;BOLD (no GSR)&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Ca$^{2+}$&#39;</span><span class="p">:</span> <span class="n">net_ca</span><span class="o">.</span><span class="n">adj</span><span class="p">}</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">show_corrs</span><span class="p">(</span><span class="n">adj_dict</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">l_ids</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">r_ids</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/nov-24-2021_19_0.png" src="../../_images/nov-24-2021_19_0.png" />
<img alt="../../_images/nov-24-2021_19_1.png" src="../../_images/nov-24-2021_19_1.png" />
<img alt="../../_images/nov-24-2021_19_2.png" src="../../_images/nov-24-2021_19_2.png" />
<img alt="../../_images/nov-24-2021_19_3.png" src="../../_images/nov-24-2021_19_3.png" />
<img alt="../../_images/nov-24-2021_19_4.png" src="../../_images/nov-24-2021_19_4.png" />
<img alt="../../_images/nov-24-2021_19_5.png" src="../../_images/nov-24-2021_19_5.png" />
<img alt="../../_images/nov-24-2021_19_6.png" src="../../_images/nov-24-2021_19_6.png" />
<img alt="../../_images/nov-24-2021_19_7.png" src="../../_images/nov-24-2021_19_7.png" />
<img alt="../../_images/nov-24-2021_19_8.png" src="../../_images/nov-24-2021_19_8.png" />
<img alt="../../_images/nov-24-2021_19_9.png" src="../../_images/nov-24-2021_19_9.png" />
<img alt="../../_images/nov-24-2021_19_10.png" src="../../_images/nov-24-2021_19_10.png" />
<img alt="../../_images/nov-24-2021_19_11.png" src="../../_images/nov-24-2021_19_11.png" />
<img alt="../../_images/nov-24-2021_19_12.png" src="../../_images/nov-24-2021_19_12.png" />
<img alt="../../_images/nov-24-2021_19_13.png" src="../../_images/nov-24-2021_19_13.png" />
<img alt="../../_images/nov-24-2021_19_14.png" src="../../_images/nov-24-2021_19_14.png" />
<img alt="../../_images/nov-24-2021_19_15.png" src="../../_images/nov-24-2021_19_15.png" />
<img alt="../../_images/nov-24-2021_19_16.png" src="../../_images/nov-24-2021_19_16.png" />
<img alt="../../_images/nov-24-2021_19_17.png" src="../../_images/nov-24-2021_19_17.png" />
<img alt="../../_images/nov-24-2021_19_18.png" src="../../_images/nov-24-2021_19_18.png" />
<img alt="../../_images/nov-24-2021_19_19.png" src="../../_images/nov-24-2021_19_19.png" />
<img alt="../../_images/nov-24-2021_19_20.png" src="../../_images/nov-24-2021_19_20.png" />
<img alt="../../_images/nov-24-2021_19_21.png" src="../../_images/nov-24-2021_19_21.png" />
<img alt="../../_images/nov-24-2021_19_22.png" src="../../_images/nov-24-2021_19_22.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">sub-SLC03_ses-1_run-<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
</pre>
</div><img alt="../../_images/nov-24-2021_19_24.png" src="../../_images/nov-24-2021_19_24.png" />
<img alt="../../_images/nov-24-2021_19_25.png" src="../../_images/nov-24-2021_19_25.png" />
<img alt="../../_images/nov-24-2021_19_26.png" src="../../_images/nov-24-2021_19_26.png" />
<img alt="../../_images/nov-24-2021_19_27.png" src="../../_images/nov-24-2021_19_27.png" />
<img alt="../../_images/nov-24-2021_19_28.png" src="../../_images/nov-24-2021_19_28.png" />
<img alt="../../_images/nov-24-2021_19_29.png" src="../../_images/nov-24-2021_19_29.png" />
<img alt="../../_images/nov-24-2021_19_30.png" src="../../_images/nov-24-2021_19_30.png" />
<img alt="../../_images/nov-24-2021_19_31.png" src="../../_images/nov-24-2021_19_31.png" />
<img alt="../../_images/nov-24-2021_19_32.png" src="../../_images/nov-24-2021_19_32.png" />
<img alt="../../_images/nov-24-2021_19_33.png" src="../../_images/nov-24-2021_19_33.png" />
<img alt="../../_images/nov-24-2021_19_34.png" src="../../_images/nov-24-2021_19_34.png" />
<img alt="../../_images/nov-24-2021_19_35.png" src="../../_images/nov-24-2021_19_35.png" />
<img alt="../../_images/nov-24-2021_19_36.png" src="../../_images/nov-24-2021_19_36.png" />
<img alt="../../_images/nov-24-2021_19_37.png" src="../../_images/nov-24-2021_19_37.png" />
<img alt="../../_images/nov-24-2021_19_38.png" src="../../_images/nov-24-2021_19_38.png" />
<img alt="../../_images/nov-24-2021_19_39.png" src="../../_images/nov-24-2021_19_39.png" />
<img alt="../../_images/nov-24-2021_19_40.png" src="../../_images/nov-24-2021_19_40.png" />
<img alt="../../_images/nov-24-2021_19_41.png" src="../../_images/nov-24-2021_19_41.png" />
<img alt="../../_images/nov-24-2021_19_42.png" src="../../_images/nov-24-2021_19_42.png" />
<img alt="../../_images/nov-24-2021_19_43.png" src="../../_images/nov-24-2021_19_43.png" />
<img alt="../../_images/nov-24-2021_19_44.png" src="../../_images/nov-24-2021_19_44.png" />
<img alt="../../_images/nov-24-2021_19_45.png" src="../../_images/nov-24-2021_19_45.png" />
<img alt="../../_images/nov-24-2021_19_46.png" src="../../_images/nov-24-2021_19_46.png" />
<img alt="../../_images/nov-24-2021_19_47.png" src="../../_images/nov-24-2021_19_47.png" />
<img alt="../../_images/nov-24-2021_19_48.png" src="../../_images/nov-24-2021_19_48.png" />
<img alt="../../_images/nov-24-2021_19_49.png" src="../../_images/nov-24-2021_19_49.png" />
<img alt="../../_images/nov-24-2021_19_50.png" src="../../_images/nov-24-2021_19_50.png" />
<img alt="../../_images/nov-24-2021_19_51.png" src="../../_images/nov-24-2021_19_51.png" />
<img alt="../../_images/nov-24-2021_19_52.png" src="../../_images/nov-24-2021_19_52.png" />
<img alt="../../_images/nov-24-2021_19_53.png" src="../../_images/nov-24-2021_19_53.png" />
<img alt="../../_images/nov-24-2021_19_54.png" src="../../_images/nov-24-2021_19_54.png" />
<img alt="../../_images/nov-24-2021_19_55.png" src="../../_images/nov-24-2021_19_55.png" />
<img alt="../../_images/nov-24-2021_19_56.png" src="../../_images/nov-24-2021_19_56.png" />
<img alt="../../_images/nov-24-2021_19_57.png" src="../../_images/nov-24-2021_19_57.png" />
<img alt="../../_images/nov-24-2021_19_58.png" src="../../_images/nov-24-2021_19_58.png" />
<img alt="../../_images/nov-24-2021_19_59.png" src="../../_images/nov-24-2021_19_59.png" />
<img alt="../../_images/nov-24-2021_19_60.png" src="../../_images/nov-24-2021_19_60.png" />
<img alt="../../_images/nov-24-2021_19_61.png" src="../../_images/nov-24-2021_19_61.png" />
<img alt="../../_images/nov-24-2021_19_62.png" src="../../_images/nov-24-2021_19_62.png" />
<img alt="../../_images/nov-24-2021_19_63.png" src="../../_images/nov-24-2021_19_63.png" />
<img alt="../../_images/nov-24-2021_19_64.png" src="../../_images/nov-24-2021_19_64.png" />
<img alt="../../_images/nov-24-2021_19_65.png" src="../../_images/nov-24-2021_19_65.png" />
<img alt="../../_images/nov-24-2021_19_66.png" src="../../_images/nov-24-2021_19_66.png" />
<img alt="../../_images/nov-24-2021_19_67.png" src="../../_images/nov-24-2021_19_67.png" />
<img alt="../../_images/nov-24-2021_19_68.png" src="../../_images/nov-24-2021_19_68.png" />
<img alt="../../_images/nov-24-2021_19_69.png" src="../../_images/nov-24-2021_19_69.png" />
<img alt="../../_images/nov-24-2021_19_70.png" src="../../_images/nov-24-2021_19_70.png" />
<img alt="../../_images/nov-24-2021_19_71.png" src="../../_images/nov-24-2021_19_71.png" />
<img alt="../../_images/nov-24-2021_19_72.png" src="../../_images/nov-24-2021_19_72.png" />
<img alt="../../_images/nov-24-2021_19_73.png" src="../../_images/nov-24-2021_19_73.png" />
<img alt="../../_images/nov-24-2021_19_74.png" src="../../_images/nov-24-2021_19_74.png" />
<img alt="../../_images/nov-24-2021_19_75.png" src="../../_images/nov-24-2021_19_75.png" />
<img alt="../../_images/nov-24-2021_19_76.png" src="../../_images/nov-24-2021_19_76.png" />
<img alt="../../_images/nov-24-2021_19_77.png" src="../../_images/nov-24-2021_19_77.png" />
<img alt="../../_images/nov-24-2021_19_78.png" src="../../_images/nov-24-2021_19_78.png" />
<img alt="../../_images/nov-24-2021_19_79.png" src="../../_images/nov-24-2021_19_79.png" />
<img alt="../../_images/nov-24-2021_19_80.png" src="../../_images/nov-24-2021_19_80.png" />
<img alt="../../_images/nov-24-2021_19_81.png" src="../../_images/nov-24-2021_19_81.png" />
<img alt="../../_images/nov-24-2021_19_82.png" src="../../_images/nov-24-2021_19_82.png" />
<img alt="../../_images/nov-24-2021_19_83.png" src="../../_images/nov-24-2021_19_83.png" />
<img alt="../../_images/nov-24-2021_19_84.png" src="../../_images/nov-24-2021_19_84.png" />
<img alt="../../_images/nov-24-2021_19_85.png" src="../../_images/nov-24-2021_19_85.png" />
<img alt="../../_images/nov-24-2021_19_86.png" src="../../_images/nov-24-2021_19_86.png" />
<img alt="../../_images/nov-24-2021_19_87.png" src="../../_images/nov-24-2021_19_87.png" />
<img alt="../../_images/nov-24-2021_19_88.png" src="../../_images/nov-24-2021_19_88.png" />
<img alt="../../_images/nov-24-2021_19_89.png" src="../../_images/nov-24-2021_19_89.png" />
<img alt="../../_images/nov-24-2021_19_90.png" src="../../_images/nov-24-2021_19_90.png" />
<img alt="../../_images/nov-24-2021_19_91.png" src="../../_images/nov-24-2021_19_91.png" />
<img alt="../../_images/nov-24-2021_19_92.png" src="../../_images/nov-24-2021_19_92.png" />
<img alt="../../_images/nov-24-2021_19_93.png" src="../../_images/nov-24-2021_19_93.png" />
<img alt="../../_images/nov-24-2021_19_94.png" src="../../_images/nov-24-2021_19_94.png" />
<img alt="../../_images/nov-24-2021_19_95.png" src="../../_images/nov-24-2021_19_95.png" />
<img alt="../../_images/nov-24-2021_19_96.png" src="../../_images/nov-24-2021_19_96.png" />
<img alt="../../_images/nov-24-2021_19_97.png" src="../../_images/nov-24-2021_19_97.png" />
<img alt="../../_images/nov-24-2021_19_98.png" src="../../_images/nov-24-2021_19_98.png" />
<img alt="../../_images/nov-24-2021_19_99.png" src="../../_images/nov-24-2021_19_99.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-in-common-space-ignore">
<h2>Data in common space (ignore)<a class="headerlink" href="#data-in-common-space-ignore" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_house</span> <span class="o">=</span> <span class="s1">&#39;/home/hadi/Documents/Ca-fMRI/Yale/atlases_templates&#39;</span>
<span class="n">in_house</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">in_house</span><span class="p">,</span> <span class="s1">&#39;Symmetric_N162_0.20.nii.gz&#39;</span><span class="p">)</span>
<span class="n">in_house</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">in_house</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">in_house</span><span class="o">.</span><span class="n">get_mask</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="n">in_house</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type : float <span style="font-weight: bold">(</span>float32<span style="font-weight: bold">)</span>
         Components : <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
         Dimensions : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span><span style="font-weight: bold">)</span>
         Spacing    : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span><span style="font-weight: bold">)</span>
         Origin     : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-6.2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-7.8</span><span style="font-weight: bold">)</span>
         Direction  : <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.<span style="font-weight: bold">]</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
    <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">npy_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;N162&#39;</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-1_run-1_task-rest_space-N162_desc-gsr_bold.npy'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pjoin</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">npy_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
<span class="n">x</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">600</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7f1478450c70</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/nov-24-2021_30_1.png" src="../../_images/nov-24-2021_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="n">m_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="n">m_l</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">m_r</span><span class="p">[</span><span class="mi">30</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">m_l</span> <span class="o">*=</span> <span class="n">mask</span>
<span class="n">m_r</span> <span class="o">*=</span> <span class="n">mask</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">]</span> <span class="o">*</span> <span class="n">m_l</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7f1478425fa0</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/nov-24-2021_33_1.png" src="../../_images/nov-24-2021_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">id2vox</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">vox</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vox</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)))}</span>
<span class="n">vox2id</span> <span class="o">=</span> <span class="p">{</span><span class="n">vox</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vox</span> <span class="ow">in</span> <span class="n">id2vox</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">voxels_l</span> <span class="o">=</span> <span class="p">[</span><span class="n">vox2id</span><span class="p">[</span><span class="n">vox</span><span class="p">]</span> <span class="k">for</span> <span class="n">vox</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">m_l</span><span class="p">))]</span>
<span class="n">voxels_r</span> <span class="o">=</span> <span class="p">[</span><span class="n">vox2id</span><span class="p">[</span><span class="n">vox</span><span class="p">]</span> <span class="k">for</span> <span class="n">vox</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">m_r</span><span class="p">))]</span>

<span class="nb">len</span><span class="p">(</span><span class="n">id2vox</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">voxels_l</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">voxels_r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53520</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26760</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26760</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">vox</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vox</span> <span class="ow">in</span> <span class="n">id2vox</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>53511</th>
      <th>53512</th>
      <th>53513</th>
      <th>53514</th>
      <th>53515</th>
      <th>53516</th>
      <th>53517</th>
      <th>53518</th>
      <th>53519</th>
      <th>53520</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>...</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.000037</td>
      <td>0.000029</td>
      <td>0.000031</td>
      <td>0.000024</td>
      <td>0.000031</td>
      <td>0.000022</td>
      <td>0.000017</td>
      <td>0.000028</td>
      <td>0.000041</td>
      <td>0.000045</td>
      <td>...</td>
      <td>0.000011</td>
      <td>0.000012</td>
      <td>0.000009</td>
      <td>0.000013</td>
      <td>0.000018</td>
      <td>0.000013</td>
      <td>0.000011</td>
      <td>0.000012</td>
      <td>0.000018</td>
      <td>0.000016</td>
    </tr>
    <tr>
      <th>std</th>
      <td>58.042798</td>
      <td>58.805388</td>
      <td>63.608059</td>
      <td>60.762439</td>
      <td>47.452730</td>
      <td>41.243117</td>
      <td>35.756546</td>
      <td>42.862502</td>
      <td>46.623635</td>
      <td>48.308633</td>
      <td>...</td>
      <td>43.970124</td>
      <td>50.056729</td>
      <td>44.312437</td>
      <td>45.960689</td>
      <td>51.093260</td>
      <td>44.219592</td>
      <td>35.289095</td>
      <td>33.442775</td>
      <td>35.815545</td>
      <td>31.557447</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-191.426010</td>
      <td>-167.515213</td>
      <td>-218.461212</td>
      <td>-199.534576</td>
      <td>-163.278275</td>
      <td>-136.379990</td>
      <td>-126.089241</td>
      <td>-155.784683</td>
      <td>-176.994507</td>
      <td>-194.143387</td>
      <td>...</td>
      <td>-130.044159</td>
      <td>-162.013046</td>
      <td>-152.768066</td>
      <td>-157.051498</td>
      <td>-162.126602</td>
      <td>-138.608429</td>
      <td>-122.436371</td>
      <td>-100.622383</td>
      <td>-86.119919</td>
      <td>-104.292145</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-36.532259</td>
      <td>-36.199161</td>
      <td>-37.891979</td>
      <td>-39.854692</td>
      <td>-29.016917</td>
      <td>-26.259252</td>
      <td>-22.240885</td>
      <td>-28.871258</td>
      <td>-31.871924</td>
      <td>-29.183022</td>
      <td>...</td>
      <td>-30.408812</td>
      <td>-36.101402</td>
      <td>-30.158387</td>
      <td>-30.356061</td>
      <td>-36.120829</td>
      <td>-30.081787</td>
      <td>-24.755870</td>
      <td>-21.581811</td>
      <td>-25.588388</td>
      <td>-20.321587</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.453899</td>
      <td>0.383753</td>
      <td>1.686752</td>
      <td>3.184936</td>
      <td>-3.439319</td>
      <td>-1.425998</td>
      <td>-1.707476</td>
      <td>0.824457</td>
      <td>1.439943</td>
      <td>1.092670</td>
      <td>...</td>
      <td>0.313891</td>
      <td>0.167545</td>
      <td>-1.739955</td>
      <td>-0.205414</td>
      <td>-1.154967</td>
      <td>-0.876468</td>
      <td>-0.680155</td>
      <td>0.915859</td>
      <td>-0.450799</td>
      <td>-0.960745</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>37.906370</td>
      <td>37.211691</td>
      <td>41.442319</td>
      <td>39.472029</td>
      <td>30.741082</td>
      <td>26.477701</td>
      <td>22.287672</td>
      <td>28.246827</td>
      <td>33.366884</td>
      <td>31.124300</td>
      <td>...</td>
      <td>32.417554</td>
      <td>32.288509</td>
      <td>28.775416</td>
      <td>30.716470</td>
      <td>33.035935</td>
      <td>31.113621</td>
      <td>24.254929</td>
      <td>22.871938</td>
      <td>25.080108</td>
      <td>19.142567</td>
    </tr>
    <tr>
      <th>max</th>
      <td>199.813751</td>
      <td>230.878967</td>
      <td>236.490997</td>
      <td>219.589157</td>
      <td>180.673935</td>
      <td>143.476425</td>
      <td>100.445480</td>
      <td>130.473618</td>
      <td>120.074951</td>
      <td>142.677170</td>
      <td>...</td>
      <td>129.769867</td>
      <td>131.983063</td>
      <td>119.165550</td>
      <td>151.100464</td>
      <td>153.407257</td>
      <td>120.982765</td>
      <td>108.582024</td>
      <td>111.842331</td>
      <td>120.046127</td>
      <td>120.129410</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 53520 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">get_adj_mat</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;pearson&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 38min 25s, sys: 16min 12s, total: 54min 37s
Wall time: 1h 19min 28s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">save_obj</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;adj_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">tmp_dir</span><span class="p">,</span> <span class="s1">&#39;npy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'adj_sub-SLC02_ses-1_run-1.npy'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">tmp</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'/home/hadi/Dropbox/git/jb-Ca-fMRI/tmp/adj_sub-SLC02_ses-1_run-1.npy'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;/home/hadi/Dropbox/git/jb-Ca-fMRI/tmp/adj_sub-SLC02_ses-1_run-1.npy&#39;</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53520</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53520</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">id2vox</span><span class="p">),</span> <span class="n">voxels_l</span><span class="p">)</span>
<span class="n">r_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">id2vox</span><span class="p">),</span> <span class="n">voxels_r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_l</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">l_ids</span><span class="p">][:,</span> <span class="n">l_ids</span><span class="p">]</span>
<span class="n">a_r</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">r_ids</span><span class="p">][:,</span> <span class="n">r_ids</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">a_l</span><span class="p">[</span><span class="n">a_l</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">a_r</span><span class="p">[</span><span class="n">a_r</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Percent'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/nov-24-2021_47_1.png" src="../../_images/nov-24-2021_47_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/nov-24-2021_49_0.png" src="../../_images/nov-24-2021_49_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nb/nov21"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="nov-13-2021.html" title="previous page">November 13th, 2021</a>
    <a class='right-next' id="next-link" href="nov-26-2021.html" title="next page">November 26th, 2021 (identify spikes)</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hadi Vafaii<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>