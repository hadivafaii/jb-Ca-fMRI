

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Aug ??st, 2021 &#8212; Ca-fMRI [Daily Progress]</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nb/aug21/Fig2-k12';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../md/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../md/intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">February 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/feb21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/feb21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../feb21/feb-12-2021.html">February, 12th 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb21/feb-13-2021.html">February, 13th 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb21/feb-16-2021.html">February, 16th 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb21/feb-20-2021.html">February, 20th 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">March 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/mar21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/mar21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-10-2021.html">March 10th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-13-2021.html">March 13th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-15-2021.html">March 15th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-16-2021.html">March 16th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-18-2021.html">March 18th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-19-2021.html">March 19th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-26-2021.html">March 26th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar21/mar-29-2021.html">March 29th, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">April 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/apr21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/apr21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apr21/apr-07-2021.html">April 7th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr21/apr-30-2021.html">April 30th, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">May 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/may21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/may21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-08-2021.html">May 8th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-09-2021.html">May 9th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-11-2021.html">May 11th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-12-2021.html">May 12th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-20-2021.html">May 20th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-24-2021.html">May 24th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may21/may-31-2021.html">May 31st, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">June 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/jun21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/jun21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-05-2021.html">June 5th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-06-2021.html">June 6th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-07-2021.html">June 7th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-12-2021.html">June 12th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-13-2021.html">June 13th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-15-2021.html">June 15th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-17-2021.html">June 17th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-18-2021.html">June 18th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-19-2021.html">June 19th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-21-2021.html">June 21st, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-24-2021.html">June 24th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-26-2021.html">June, 26th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-29-2021.html">June 29th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun21/jun-30-2021.html">June 30th, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">July 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/jul21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/jul21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jul21/jul-01-2021.html">July 1st, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul21/jul-09-2021.html">July 9th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul21/jul-11-2021.html">July 11th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul21/jul-31-2021.html">July 31st, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">August 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/aug21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/aug21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="aug-21-2021.html">Aug 21st, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">September 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/sep21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/sep21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-07-2021.html">Sep 7th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-08-2021.html">Sep 8th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-15-2021.html">Sep 15th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-19-2021.html">Sep 19th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-24-2021.html">Sep 24th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-25-2021.html">Sep 25th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep21/sep-27-2021.html">Sep 27th, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">October 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/oct21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/oct21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-06-2021.html">October 6th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-10-2021.html">October 10th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-11-2021.html">October 11th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-12-2021.html">October 12th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-16-2021.html">October 16th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-17-2021.html">October 17th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-21-2021.html">October 21st, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-26-2021.html">October 26th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-27-2021.html">October 27th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-29-2021.html">October 29th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-30-2021.html">October 30th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oct21/oct-31-2021.html">October 31th, 2021</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">November 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/nov21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/nov21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-05-2021.html">November 5th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-06-2021.html">November 6th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-09-2021.html">November 9th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-13-2021.html">November 13th, 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-24-2021.html">November 24th, 2021 (corr distrs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-26-2021.html">November 26th, 2021 (identify spikes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov21/nov-29-2021.html">November 29th, 2021 (figs 1 and 2)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">December 2021</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/dec21.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/dec21_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-01-2021.html">Dec 1st, 2021 (topo dist)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-04-2021.html">Dec 4th, 2021 (Binary vs Sample)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-06-2021.html">Dec 6th, 2021 (tSNR: Ca all plots)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-07-2021.html">Dec 7th, 2021 (tSNR: Ca)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-08-2021.html">Dec 8th, 2021 (scp2raw2npy)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-09-2021.html">Dec 9th, 2021 (tSNR: BOLD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-10-2021.html">Dec 10th, 2021 (tSNR: identify bad areas)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-17-2021.html">Dec 17th, 2021 (GS all plots)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-18-2021.html">Dec 18th, 2021 (rabies)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-21-2021.html">Dec 21st, 2021 (ROI layers: concept)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-22-2021.html">Dec 22nd, 2021 (3-depths + render fns)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-24-2021.html">Dec 24th, 2021 (ROI layers: compare)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec21/dec-27-2021.html">Dec 27th, 2021 (Parcel viz 3D)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/jan22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/jan22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-03-2022.html">Jan 3rd, 2022 (Coreg ses play; fix 10_3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-04-2022.html">Jan 4th, 2022 (Coreg ses)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-07-2022.html">Jan 7th, 2022 (rabies: 2nd stage)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-12-2022.html">Jan 12th, 2022 (voxel sz plots)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-13-2022.html">Jan 13th, 2022 (topo dist, best density)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-17-2022.html">Jan 17th, 2022 (Results at various thresholds, discussion on topology)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-19-2022.html">Jan 19th, 2022 (Hierarchical)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-22-2022.html">Jan 22nd, 2022 (degree dist, cartography)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-25-2022.html">Jan 25th, 2022 (debug boot + 2 anim draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-26-2022.html">Jan 26th, 2022 (cleaner figs, SE bug)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-27-2022.html">Jan 27th, 2022 (SE debug)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-28-2022.html">Jan 28th, 2022 (SE debug: cont.)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-29-2022.html">Jan 29th, 2022 (seed filter: draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-30-2022.html">Jan 30th, 2022 (seed filter)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jan22/jan-31-2022.html">Jan 31st, 2022 (small memship vote: draft)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">February 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/feb22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/feb22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-01-2022.html">Feb 1st, 2022 (small memship vote)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-02-2022.html">Feb 2nd, 2022 (Mouse ICA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-04-2022.html">Feb 4th, 2022 (plot bold+ca)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-06-2022.html">Feb 6th, 2022 (rabies: 3rd stage)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-07-2022.html">Feb 7th, 2022 (Structural Connectome)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-08-2022.html">Feb 08, 2022 (LED vs. REST; avg over runs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-14-2022.html">Feb 14th, 2022 (pruned in grp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-15a-2022.html">Feb 15th, 2022 (Smart adj plot)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-15b-2022.html">Feb 15th, 2022 (Smart adj plot; better)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-18-2022.html">Feb 18th, 2022 (upsample bold; corr timeseries)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-22-2022.html">Feb 22nd, 2022 (GLM Ca)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-24-2022.html">Feb 24th, 2022 (grant finalize)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-25a-2022.html">Feb 25th, 2022 (Figs 4 the talk)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-25b-2022.html">Feb 25th, 2022 (compare cosine, DMN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-25c-2022.html">Feb 25th, 2022 (Entropy, carto)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-25d-2022.html">Feb 25th, 2022 (LFR reboot)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-25e-2022.html">Feb 25th, 2022 (ovp score, C_i; pie charts)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feb22/feb-25f-2022.html">Feb 25th, 2022 (ROI plots)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">March 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/mar22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/mar22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mar22/mar-05-2022.html">Mar 5th, 2022 (debug net; spearman &gt; pearson)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mar22/mar-06-2022.html">Mar 6th, 2022 (Cartography, explored)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">April 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/apr22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/apr22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-01-2022.html">Apr 1st, 2022 (props, pie, entropy, contour, carto)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-02-2022.html">Apr 2nd, 2022 (quality control: both modalities)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-03-2022.html">Apr 3rd, 2022 (copy files: rabies + ca)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-04-2022.html">Apr 4th, 2022 (ca ref; viz some t)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-05-2022.html">Apr 5th, 2022 (check co-registration perf)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-07-2022.html">Apr 7th, 2022 (Fig 4, OCs, cosine sim, DMN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-11-2022.html">Apr 11th, 2022 (fix: affiliation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-12-2022.html">Apr 12th, 2022 (ent fixed + some supp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-13-2022.html">Apr 13th, 2022 (node &amp; oc overlap scores)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-14-2022.html">Apr 14th, 2022 (carto fixed + some supp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-15-2022.html">Apr 15th, 2022 (parcellation fix)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-16-2022.html">Apr 16th, 2022 (register RABIES)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-17-2022.html">Apr 17th, 2022 (a new beginning)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-20-2022.html">Apr 20th, 2022 (tSNR masks, many plot funcs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-21-2022.html">Apr 21st, 2022 (Ca clean, many adj plots, Yale comare RABIES)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-24-2022.html">Apr 24th, 2022 (findk both 128 and 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-25-2022.html">Apr 25th, 2022 (x-valid, both 128 and 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-26-2022.html">Apr 26th, 2022 (fix svinet, fix group)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-28-2022.html">Apr 28th, 2022 (plot ca node discont. + grey bg motion)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-29-2022.html">Apr 29th, 2022 (ROI sizes 2d &amp; 3d)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-30a-2022.html">Apr 30th, 2022 (Misc KABA, 128 * 3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apr22/apr-30b-2022.html">Apr 30th, 2022 (Misc GABAN, 512 * 3)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">May 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/may22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/may22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-02-2022.html">May 2nd, 2022 (global order or not? – prelim)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-05-2022.html">May 5th, 2022 (global order or not? + sample vs. binary)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-06-2022.html">May 6th, 2022 (REST vs LED)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-08-2022.html">May 8th, 2022 (x-valid, binary vs sample)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-15-2022.html">May 15th, 2022 (rabies highpass: copy + plot n_t removed)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-16-2022.html">May 16th, 2022 (ca bp, lombscargle_fill)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-17-2022.html">May 17th, 2022 (ca bp, lombscargle_fill, finalize)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-24-2022.html">May 24th, 2022 (new results w/ bp: 192 * 3, k = 7)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-26-2022.html">May 26th, 2022 (task = all, info on good_nodes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-27-2022.html">May 27th, 2022 (plot degree dist; adj on ctx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-31a-2022.html">May 31st, 2022 (Results so far: KABA, 128 * 3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../may22/may-31b-2022.html">May 31st, 2022 (Results so far: GABAN, 512 * 3)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">June 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/jun22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/jun22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-02-2022.html">Jun 2nd, 2022 (prune finalized – almost)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-03-2022.html">Jun 3rd, 2022 (global node selection (automatic now))</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-06a-2022.html">Jun 6th, 2022 (results so far, prune, mg)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-06b-2022.html">Jun 6th, 2022 (results so far, prune, mg)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-08a-2022.html">Jun 8th, 2022 (plot pi together for all: KABA 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-08b-2022.html">Jun 8th, 2022 (plot pi together for all: GABAN 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-09a-2022.html">Jun 9th, 2022 (entropy (clean) k=7,10,14: KABA 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-09b-2022.html">Jun 9th, 2022 (entropy (clean) k=7,10,14: GABAN 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-12a-2022.html">Jun 12th, 2022 (full brain bold: KABA 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-12b-2022.html">Jun 12th, 2022 (full brain bold: GABAN 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-13-2022.html">Jun 13th, 2022 (Node presnece figs for N=512 ROIs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-14a-2022.html">Jun 14th, 2022 (ttest + ovp score new: KABA 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-14b-2022.html">Jun 14th, 2022 (ttest + ovp score new: GABAN 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-18a-2022.html">Jun 18th, 2022 (boot parallel: 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-18b-2022.html">Jun 18th, 2022 (boot parallel: 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-21-2022.html">Jun 21st, 2022 (effect of mu and alpha on prune)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-22-2022.html">Jun 22nd, 2022 (Debug degree + anomalous run 9-2-1 detected)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-23-2022.html">Jun 23rd, 2022 (save fixed run_deg)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-27a-2022.html">Jun 27th, 2022 (Carto not working: 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-27b-2022.html">Jun 27th, 2022 (Carto not working: 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-28-2022.html">Jun 28th, 2022 (full brain bold: KABA 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-29a-2022.html">Jun 29th, 2022 (plot pi together for all: 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-29b-2022.html">Jun 29th, 2022 (plot pi together for all: 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-30a-2022.html">Jun 30th, 2022 (find max pi sym - seeds, prune or not: 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jun22/jun-30b-2022.html">Jun 30th, 2022 (find max pi sym - seeds, prune or not: 512)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">July 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/jul22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/jul22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-deg-2022.html">Jul 3rd, 2022 (Fig-2: Degree)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-04-2022.html">Jul 4th, 2022 (Fig-7: Entropy – draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ent-2022.html">Jul 5th, 2022 (Fig-7: Entropy)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-05-2022.html">Jul 5th, 2022 (Fig-3 OCs – draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs3-2022.html">Jul 6th, 2022 (Fig-3 OCs; K=3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs7-2022.html">Jul 6th, 2022 (Fig-3 OCs; K=7)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs20-2022.html">Jul 6th, 2022 (Fig-3 OCs; K=20)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs-2022.html">Jul 7th, 2022 (Fig-3 OCs; combined)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-prop-2022.html">Jul 8th, 2022 (Fig-5 proportion plot)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-09-2022.html">Jul 9th, 2022 (Fig-6 mem plots – draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-mem-2022.html">Jul 9th, 2022 (Fig-6 mem plots)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-cbar-2022.html">Jul 10th, 2022 (cbar for figs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-sup-2022.html">Jul 11th, 2022 (Fig-sup: Deg/Ent Percentile)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-12-2022.html">Jul 12th, 2022 (perc = 15 is better)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-deg-final-2022.html">Jul 15th, 2022 (Fig-7: Degree)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ent-final-2022.html">Jul 15th, 2022 (Fig-6: Entropy)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs3-final-2022.html">Jul 15th, 2022 (Fig-2 OCs; K=3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs7-final-2022.html">Jul 15th, 2022 (Fig-2 OCs; K=7)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs20-final-2022.html">Jul 15th, 2022 (Fig-3 OCs; K=20)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs-final-2022.html">Jul 15th, 2022 (Fig-2 OCs; combined)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-prop-final-2022.html">Jul 15th, 2022 (Fig-4 proportion)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-mem-final-2022.html">Jul 15th, 2022 (Fig-5 mem plots)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-sup-final-2022.html">Jul 16th, 2022 (Fig-sup: Deg/Ent perc + carto + n128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-cbar-final-2022.html">Jul 16th, 2022 (cbar for figs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-allen-2022.html">Jul 21st, 2022 (Allen Ctx + parc top)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs3-n128-2022.html">Jul 21st, 2022 (Fig-2 OCs; K=3; n=128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs7-n128-2022.html">Jul 21st, 2022 (Fig-2 OCs; K=7; n=128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs-n128-2022.html">Jul 21st, 2022 (Fig-2 OCs; combined; n=128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs7-p25-2022.html">Jul 21st, 2022 (Fig-2 OCs; K=7; p=25)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ocs-p25-2022.html">Jul 21st, 2022 (Fig-2 OCs; combined; p=25)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-22-2022.html">Jul 22nd, 2022 (Fig2, add indiv circles)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-deg-n128-2022.html">Jul 24th, 2022 (Fig-2: Degree; n=128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-ent-n128-2022.html">Jul 24th, 2022 (Fig-6: Entropy)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jul22/jul-27-2022.html">Jul 27th, 2022 (Ent dist nonzero + Deg perm)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">August 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/aug22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/aug22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-09-2022.html">Aug 9th, 2022 (Perm: OCs / overall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-10a-2022.html">Aug 10th, 2022 (cos sim 8 x conds: 128)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-10b-2022.html">Aug 10th, 2022 (cos sim 8 x conds: 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-11-2022.html">Aug 11th, 2022 (render + ROI presence)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-12-2022.html">Aug 12th, 2022 (cos sim 8 x conds: 512)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-17-2022.html">Aug 17th, 2022 (Degree: 0 –&gt; NaN; zscore)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-19a-2022.html">Aug 19th, 2022 (Degree: w/o regression, KABA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-19b-2022.html">Aug 19th, 2022 (Degree: w/o regression, GABAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-20-2022.html">Aug 20th, 2022 (Degree: re-calculate save group)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-21-2022.html">Aug 21st, 2022 (Degree: w/o regression, final)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-24-2022.html">Aug 24th, 2022 (LFR reboot 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aug22/aug-31-2022.html">Aug 31th, 2022 (Particip. Coeff.)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">September 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/sep22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/sep22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../sep22/sep-13-2022.html">Sep 13th, 2022 (Fig1: ROI plots, layer plots 10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep22/sep-29-2022.html">Sep 29th, 2022 (Generate data Fig 2E, Fig 3)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">November 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/nov22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/nov22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../nov22/nov-10-2022.html">Nov 10th, 2022 (AD: copy data)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov22/nov-11-2022.html">Nov 11th, 2022 (AD: co-reg)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov22/nov-16-2022.html">Nov 16th, 2022 (AD: mega animal)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nov22/nov-28-2022.html">Nov 28th, 2022 (SLC: indiv)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">December 2022</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/dec22.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/dec22_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-05-2022.html">Dec 5th, 2022 (SLC: export OCs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-11-2022.html">Dec 11th, 2022 (AD: copy BOLD + correct rename)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-12-2022.html">Dec 12th, 2022 (AD: register N162)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-17-2022.html">Dec 17th, 2022 (AD: new results, draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-18-2022.html">Dec 18th, 2022 (AD: new results)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-21-2022.html">Dec 21st, 2022 (Parc: subctx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-23-2022.html">Dec 23rd, 2022 (Parc: subctx, render)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-24-2022.html">Dec 24th, 2022 (AD: full brain, draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-25-2022.html">Dec 25th, 2022 (AD: full brain, save a+g)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-26-2022.html">Dec 26th, 2022 (AD: full brn, FC cos dist, mega)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-27-2022.html">Dec 27th, 2022 (AD: full brn, FC cos dist, run)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-prop-2022.html">Dec 28th, 2022 (SLC: props different bin)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-mem-2022.html">Dec 28th, 2022 (SLC: mem + different thres)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-ocs7-2022.html">Dec 28th, 2022 (SLC: cosine bluered)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-carto-2022.html">Dec 28th, 2022 (SLC: Carto)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-deg-2022.html">Dec 28th, 2022 (SLC: degree fix <span class="math notranslate nohighlight">\(\rho\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-ent-2022.html">Dec 28th, 2022 (SLC: entropy fix <span class="math notranslate nohighlight">\(\rho\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-particip-2022.html">Dec 28th, 2022 (SLC: particip. coeff. fix <span class="math notranslate nohighlight">\(\rho\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-29-2022.html">Dec 29th, 2022 (AD: full brain, draft)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-30-2022.html">Dec 30th, 2022 (AD: full brain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-31a-2022.html">Dec 31st, 2022 (AD: register N162, round 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dec22/dec-31b-2022.html">Dec 31st, 2022 (AD: register using S2PT, <span class="math notranslate nohighlight">\(25\mu m\)</span>)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">January 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-01.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-01_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/01_parcel-erode.html">(01) Parcel: erode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/02_ad-save.html">(02) AD: save data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/25_ocs7.html">(25) OCs7 – colormap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-01/30_slc128.html">(30) SLC: full-brn-begin</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">February 2023</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../md/2023-02.html">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../md/2023-02_updates.html">Updates</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/04_AD-SVINET.html">(04) AD – SVINET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/06-SLC-ent.html">(06) SLC: entropy rank + shared colorbars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/15_SCL-particip.html">(15) SLC: particip. coeff. shared colorbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023-02/22_ROI.html">(22) ROI – Create figs, document everything</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hadivafaii/_Ca-fMRI" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hadivafaii/_Ca-fMRI/issues/new?title=Issue%20on%20page%20%2Fnb/aug21/Fig2-k12.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/nb/aug21/Fig2-k12.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Aug ??st, 2021</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-results">Group results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-light">BOOTSTRAP (light)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-boot">SciPy Boot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-correct-fig">New, correct Fig</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrate-out-communities">Integrate out communities</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="aug-st-2021">
<h1>Aug ??st, 2021<a class="headerlink" href="#aug-st-2021" title="Permalink to this headline">#</a></h1>
<p><strong>Motivation</strong>: fig 2 <br></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span> <span class="k">as</span> <span class="n">dc</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="kn">from</span> <span class="nn">myterial</span> <span class="kn">import</span> <span class="n">orange</span><span class="p">,</span> <span class="n">blue_grey</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">rgb2hex</span><span class="p">,</span> <span class="n">to_rgb</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># set style &amp; no interpolalation</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.interpolation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/tmp&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/_extras&#39;</span><span class="p">)</span>


<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_Ca-fMRI&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">load_allen</span><span class="p">,</span> <span class="n">make_tree_graph</span>
<span class="kn">from</span> <span class="nn">register.parcellation</span> <span class="kn">import</span> <span class="n">Parcellation</span>
<span class="kn">from</span> <span class="nn">analysis.hierarchical</span> <span class="kn">import</span> <span class="n">Hierarchical</span>
<span class="kn">from</span> <span class="nn">analysis.svinet</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.render</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">model.mouse</span> <span class="kn">import</span> <span class="n">Mice</span>
<span class="kn">from</span> <span class="nn">model.configuration</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="c1"># warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bottleneck</span> <span class="k">as</span> <span class="nn">bn</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span><span class="o">.</span><span class="n">bench_detailed</span><span class="p">(</span><span class="s2">&quot;nanmean&quot;</span><span class="p">,</span> <span class="n">fraction_nan</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nanmean benchmark
    Bottleneck 1.3.2; Numpy 1.20.3
    Speed is NumPy time divided by Bottleneck time
    1.0% of the array elements are NaN (on average)

   Speed  Call                          Array
   195.9  nanmean(a)                    rand(1)
   185.7  nanmean(a)                    rand(10)
   106.2  nanmean(a)                    rand(100)
    21.7  nanmean(a)                    rand(1000)
     3.2  nanmean(a)                    rand(1000000)
   109.5  nanmean(a)                    rand(10, 10)
     4.1  nanmean(a)                    rand(100, 100)
     3.4  nanmean(a)                    rand(1000, 1000)
    94.9  nanmean(a, 1)                 rand(10, 10)
     4.9  nanmean(a, 1)                 rand(100, 100)
     3.3  nanmean(a, 1)                 rand(1000, 1000)
     9.9  nanmean(a, 1)                 rand(100000, 2)
    96.3  nanmean(a, 0)                 rand(10, 10)
     4.6  nanmean(a, 0)                 rand(100, 100)
     2.6  nanmean(a, 0)                 rand(1000, 1000)
     2.7  nanmean(a, 0)                 rand(100, 100, 100)
     3.2  nanmean(a, 1)                 rand(100, 100, 100)
     4.0  nanmean(a, 2)                 rand(100, 100, 100)
   229.9  nanmean(a)                    array(1.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span><span class="o">.</span><span class="n">bench_detailed</span><span class="p">(</span><span class="s2">&quot;nanmean&quot;</span><span class="p">,</span> <span class="n">fraction_nan</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nanmean benchmark
    Bottleneck 1.3.2; Numpy 1.20.3
    Speed is NumPy time divided by Bottleneck time
    20.0% of the array elements are NaN (on average)

   Speed  Call                          Array
   196.3  nanmean(a)                    rand(1)
   188.7  nanmean(a)                    rand(10)
   116.6  nanmean(a)                    rand(100)
    26.5  nanmean(a)                    rand(1000)
     2.7  nanmean(a)                    rand(1000000)
   118.1  nanmean(a)                    rand(10, 10)
     3.8  nanmean(a)                    rand(100, 100)
     2.6  nanmean(a)                    rand(1000, 1000)
    97.8  nanmean(a, 1)                 rand(10, 10)
     4.2  nanmean(a, 1)                 rand(100, 100)
     2.5  nanmean(a, 1)                 rand(1000, 1000)
     5.8  nanmean(a, 1)                 rand(100000, 2)
    96.5  nanmean(a, 0)                 rand(10, 10)
     4.0  nanmean(a, 0)                 rand(100, 100)
     2.2  nanmean(a, 0)                 rand(1000, 1000)
     2.3  nanmean(a, 0)                 rand(100, 100, 100)
     2.5  nanmean(a, 1)                 rand(100, 100, 100)
     2.6  nanmean(a, 2)                 rand(100, 100, 100)
   229.8  nanmean(a)                    array(1.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span><span class="o">.</span><span class="n">bench</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bottleneck performance benchmark
    Bottleneck 1.3.2; Numpy 1.20.3
    Speed is NumPy time divided by Bottleneck time
    NaN means approx one-fifth NaNs; float64 used

              no NaN     no NaN      NaN       no NaN      NaN    
               (100,)  (1000,1000)(1000,1000)(1000,1000)(1000,1000)
               axis=0     axis=0     axis=0     axis=1     axis=1  
nansum         39.2        1.8        1.7        2.0        1.9
nanmean       104.8        2.5        2.3        3.1        2.6
nanstd        148.2        1.9        1.9        2.2        2.1
nanvar        139.1        1.9        2.0        2.2        2.3
nanmin         32.5        0.9        3.0        1.1        4.2
nanmax         32.5        1.1        2.9        1.1        4.0
median        116.5        1.2        5.2        1.0        5.0
nanmedian     115.3        5.1        4.8        4.4        4.8
ss             12.6        0.9        0.9        1.0        1.0
nanargmin      88.2        8.9       12.6        4.3        9.1
nanargmax      85.9        9.0       12.5        4.3        9.3
anynan         12.2        0.7       45.5        1.1       40.4
allnan         19.1      197.1      142.0      184.2      122.3
rankdata       51.7        1.9        1.9        2.1        2.1
nanrankdata    54.3        2.1        2.0        2.3        2.2
partition       4.1        1.1        1.6        1.0        1.5
argpartition    4.0        1.1        1.4        1.2        1.7
replace        13.3        2.6        2.7        2.6        2.7
push         1474.2        8.5        8.5       14.3       11.6
move_sum     2909.8      104.9      147.1      271.7      204.9
move_mean    7425.3      146.0      181.8      415.3      259.3
move_std     9370.6      130.2      232.3      249.5      348.8
move_var     9836.1      146.5      248.5      288.7      362.7
move_min     1413.0       16.2       35.7       21.3       44.1
move_max     1243.4       16.9       32.5       20.2       41.8
move_argmin  3100.7       54.1       84.4       59.4       96.1
move_argmax  3004.7       54.1       83.8       59.7       94.9
move_median  2425.0      152.3      150.1      156.1      151.9
move_rank     779.8        1.6        1.3        2.8        2.3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span><span class="o">.</span><span class="n">bench</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float128&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bottleneck performance benchmark
    Bottleneck 1.3.2; Numpy 1.20.3
    Speed is NumPy time divided by Bottleneck time
    NaN means approx one-fifth NaNs; float128 used

              no NaN     no NaN      NaN       no NaN      NaN    
               (100,)  (1000,1000)(1000,1000)(1000,1000)(1000,1000)
               axis=0     axis=0     axis=0     axis=1     axis=1  
nansum          0.7        1.0        1.0        1.0        1.0
nanmean         1.1        1.0        1.0        1.0        1.0
nanstd          0.9        1.0        1.0        1.0        1.0
nanvar          0.9        1.0        1.0        1.0        1.0
nanmin          0.6        1.0        1.0        1.0        1.0
nanmax          0.6        1.0        1.0        1.0        1.0
median          1.0        1.0        1.0        1.0        1.0
nanmedian       0.9        1.0        1.0        1.0        1.0
ss              0.9        1.0        1.0        1.0        1.0
nanargmin       0.8        1.0        1.0        1.0        1.0
nanargmax       0.8        1.0        1.0        1.0        1.0
anynan          0.8        1.0        1.0        1.0        1.0
allnan          0.9        1.0        1.0        1.0        1.0
rankdata        1.0        1.0        1.0        1.0        1.0
nanrankdata     1.0        1.0        1.0        1.0        1.0
partition       0.9        1.0        1.0        1.0        1.0
argpartition    0.9        1.0        1.0        1.0        1.0
replace         0.9        1.0        1.0        1.0        1.0
push            1.0        1.0        1.0        1.0        1.0
move_sum        0.9        1.0        1.0        1.0        1.0
move_mean       1.0        1.0        1.0        1.0        1.0
move_std        1.0        1.0        1.0        1.0        1.0
move_var        1.0        1.0        1.0        1.0        1.0
move_min        1.0        1.0        1.0        1.0        1.0
move_max        1.0        1.0        1.0        1.0        1.0
move_argmin     1.0        1.0        1.0        1.0        1.0
move_argmax     1.0        1.0        1.0        1.0        1.0
move_median     1.0        1.0        1.0        1.0        1.0
move_rank       1.0        1.0        1.0        1.0        1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================= test session starts ==============================
platform linux -- Python 3.8.3, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /home/hadi/Dropbox/git/jb-Ca-fMRI/nb/aug21
plugins: anyio-2.2.0
collected 191 items

tests/input_modification_test.py .............................           [ 15%]
tests/list_input_test.py .............................                   [ 30%]
tests/memory_test.py .                                                   [ 30%]
tests/move_test.py .................................                     [ 48%]
tests/nonreduce_axis_test.py ....................                        [ 58%]
tests/nonreduce_test.py ..........                                       [ 63%]
tests/reduce_test.py ................................................... [ 90%]
                                                                         [ 90%]
tests/scalar_input_test.py ..................                            [100%]

=============================== warnings summary ===============================
tests/move_test.py: 64502 warnings
  /home/hadi/anaconda3/lib/python3.8/site-packages/bottleneck/slow/move.py:168: DeprecationWarning:
  
  `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations

-- Docs: https://docs.pytest.org/en/stable/warnings.html
===================== 191 passed, 64502 warnings in 49.97s =====================
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>
</pre>
</div></div>
</div>
<section id="group-results">
<h2>Group results<a class="headerlink" href="#group-results" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svinet_props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="s1">&#39;rest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
    <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span>
    <span class="s1">&#39;match_metric&#39;</span><span class="p">:</span> <span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="s1">&#39;graph_type&#39;</span><span class="p">:</span> <span class="s1">&#39;real&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
<span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="n">svinet_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="s1">&#39;rest&#39;</span><span class="p">),</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">num_cuts</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">svinet</span> <span class="o">=</span> <span class="n">SVINET</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;sub-SLC&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="p">,</span> <span class="n">group_dir</span> <span class="o">=</span> <span class="n">get_group_results</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">num_cuts</span><span class="p">,</span> <span class="o">**</span><span class="n">svinet_props</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">current expt: <span style="color: #008000; text-decoration-color: #008000">'p20'</span>
</pre>
</div><script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "feeef08dfb884f5dbbafd9c6ec3c5ddd", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IOPub message rate exceeded.
The notebook server will temporarily stop sending output
to the client in order to avoid crashing it.
To change this limit, set the config variable
`--NotebookApp.iopub_msg_rate_limit`.

Current values:
NotebookApp.iopub_msg_rate_limit=1000.0 (msgs/sec)
NotebookApp.rate_limit_window=3.0 (secs)

</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1b92d9e50e864690b980201a82b6baf7", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IOPub message rate exceeded.
The notebook server will temporarily stop sending output
to the client in order to avoid crashing it.
To change this limit, set the config variable
`--NotebookApp.iopub_msg_rate_limit`.

Current values:
NotebookApp.iopub_msg_rate_limit=1000.0 (msgs/sec)
NotebookApp.rate_limit_window=3.0 (secs)

</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "464bf2c81811437abfe59affa12b44ce", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IOPub message rate exceeded.
The notebook server will temporarily stop sending output
to the client in order to avoid crashing it.
To change this limit, set the config variable
`--NotebookApp.iopub_msg_rate_limit`.

Current values:
NotebookApp.iopub_msg_rate_limit=1000.0 (msgs/sec)
NotebookApp.rate_limit_window=3.0 (secs)

</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "935a79201f9f47a086fb6876a0572343", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IOPub message rate exceeded.
The notebook server will temporarily stop sending output
to the client in order to avoid crashing it.
To change this limit, set the config variable
`--NotebookApp.iopub_msg_rate_limit`.

Current values:
NotebookApp.iopub_msg_rate_limit=1000.0 (msgs/sec)
NotebookApp.rate_limit_window=3.0 (secs)

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">gam_arr</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;gam&#39;</span><span class="p">],</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gam_arr</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;oc_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ad3e6e4d9d8b253019ab17dd10ac79d2ca454c421c888e853dc0bce9cd1a8ee4.png" src="../../_images/ad3e6e4d9d8b253019ab17dd10ac79d2ca454c421c888e853dc0bce9cd1a8ee4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;pi&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.colorbar.Colorbar</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7f1394f4d1c0</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/b602a87755a000aaef0ac3a7f19edd17c298bbe825d38afbee80dae2088ea2a4.png" src="../../_images/b602a87755a000aaef0ac3a7f19edd17c298bbe825d38afbee80dae2088ea2a4.png" />
</div>
</div>
<p>take aligned gammas, average them to get the overal gamma for animal/session.  Then estimate beta parameters for each community/node, and compare that distribution vs seed’s distribution</p>
<p>just like pi_all, loop over keys and make gam_all which is also numpy array (rather than just a dict)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_boot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">pi_booted</span><span class="p">,</span> <span class="n">pi_real</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;pi_all&#39;</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
    <span class="n">estimator_seed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pi_booted</span><span class="p">,</span> <span class="n">pi_real</span> <span class="o">=</span> <span class="n">pi_booted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">pi_real</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pi_boot</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pi_booted</span><span class="p">)</span><span class="si">:</span><span class="s2">1.0e</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">save_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">pi_booted</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">group_dir</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;npy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8522ed491b054d8a93bc2ed2e187bd8c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_boot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">gam_booted</span><span class="p">,</span> <span class="n">gam_real</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;gam_all&#39;</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
    <span class="n">estimator_seed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">gam_booted</span><span class="p">,</span> <span class="n">gam_real</span> <span class="o">=</span> <span class="n">gam_booted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">gam_real</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;gam_boot</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">gam_booted</span><span class="p">)</span><span class="si">:</span><span class="s2">1.0e</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">save_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">gam_booted</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">group_dir</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;npy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootstrap-light">
<h2>BOOTSTRAP (light)<a class="headerlink" href="#bootstrap-light" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;svinet_all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">sub</span><span class="p">,</span> <span class="n">ses</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">looper</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">reord_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">gam_all</span><span class="p">[:,</span> <span class="n">reord_ids</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">g</span> <span class="o">/</span> <span class="n">g</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">seed_ids</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">seed_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">seed_ids</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">mem_cut</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
            <span class="n">mem_cut</span> <span class="o">=</span> <span class="n">mem_cut</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">mem_cut</span><span class="o">.</span><span class="n">values</span>
            <span class="n">portions</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">]</span>
            <span class="n">cut_oc</span><span class="p">[</span><span class="n">sub</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ses</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">portions</span>
<span class="n">cut_oc</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9d5e4a04c9f54704b01fb92965a05153", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;cut-oc_bins-</span><span class="si">{</span><span class="n">num_cuts</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">save_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">data_all</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">figs_dir</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;npy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'cut-oc_bins-10.npy'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">real-p20-k6</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/figs_combined/real-p20-k6/cut-oc_bins-10.npy'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_boot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">booted</span><span class="p">,</span> <span class="n">real</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">data_all</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">booted</span><span class="p">,</span> <span class="n">real</span> <span class="o">=</span> <span class="n">booted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">real</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">booted</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "662cca8ace81480ca18746f576b068aa", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10000</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;booted-oc_bins-</span><span class="si">{</span><span class="n">num_cuts</span><span class="si">}</span><span class="s2">_boot-</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">)</span><span class="si">:</span><span class="s2">1.0e</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">save_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">booted</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">figs_dir</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;npy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'booted-oc_bins-10_boot-1e+04.npy'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">real-p20-k6</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/figs_combined/real-p20-k6/booted-oc_bins-10_boot-1e+04.npy'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">9</span>

<span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">intervals</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
    <span class="s1">&#39;oc_idx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
    <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
<span class="p">})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;oc_idx&#39;</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="n">svinet</span><span class="o">.</span><span class="n">colors</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">xlabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'mean'</span><span style="color: #000000; text-decoration-color: #000000">, </span><span style="color: #808000; text-decoration-color: #808000">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Density'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/dc5c70e5818f102d3653628eabdaaaac04c29e73f756ffd1d4282e8fdc366ad5.png" src="../../_images/dc5c70e5818f102d3653628eabdaaaac04c29e73f756ffd1d4282e8fdc366ad5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figs</span><span class="p">,</span> <span class="n">sups</span> <span class="o">=</span> <span class="n">plot_bootstrap</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">,</span> <span class="n">booted</span><span class="p">,</span> <span class="n">svinet</span><span class="o">.</span><span class="n">colors</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">],</span> <span class="s1">&#39;hist&#39;</span><span class="p">)</span>
<span class="n">figs</span><span class="p">,</span> <span class="n">sups</span> <span class="o">=</span> <span class="n">plot_bootstrap</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">,</span> <span class="n">booted</span><span class="p">,</span> <span class="n">svinet</span><span class="o">.</span><span class="n">colors</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">],</span> <span class="s1">&#39;kde&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d1c9ffc3524b421faed2a3c083c51245", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/real-p20-k6/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">hist_bins-10_boot-1e+04.pdf</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">done.
</pre>
</div><script type="application/vnd.jupyter.widget-view+json">{"model_id": "18e1709b3962409b857d4d3834b08b33", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/real-p20-k6/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">kde_bins-10_boot-1e+04.pdf</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">done.
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/65b889b3190da176ad85120698b2d23d5d241011835d80f62557575357c93c0f.png" src="../../_images/65b889b3190da176ad85120698b2d23d5d241011835d80f62557575357c93c0f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;npy&#39;</span> <span class="ow">in</span> <span class="n">e</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'cut-oc_bins-10.npy'</span>, <span style="color: #008000; text-decoration-color: #008000">'booted-oc_bins-10_boot-1e+04.npy'</span><span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
</section>
<section id="scipy-boot">
<h2>SciPy Boot<a class="headerlink" href="#scipy-boot" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_statistic</span> <span class="o">=</span> <span class="n">get_statistic_fn</span><span class="p">(</span>
    <span class="n">axis_sub</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">axis_ses</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">axis_seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">n_resamples</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">batch</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">dlist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;bca&#39;</span>
<span class="n">ci</span> <span class="o">=</span> <span class="mf">99.9</span>
<span class="n">boot</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">data_all</span><span class="p">,),</span>
    <span class="n">statistic</span><span class="o">=</span><span class="n">my_statistic</span><span class="p">,</span>
    <span class="n">confidence_level</span><span class="o">=</span><span class="n">ci</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">n_resamples</span><span class="o">=</span><span class="n">n_resamples</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01424201</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00535805</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00485735</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00397629</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00371928</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00398988</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00439758</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00323872</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00352239</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01758454</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0140842</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00833121</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00643357</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0053721</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00357011</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00438428</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00472382</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00674219</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00695908</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01871863</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00456345</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00624264</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0064267</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00481555</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00445535</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00376705</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00486817</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00616496</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00734718</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0202638</span> <span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0125659</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00912745</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00617892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00351437</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00341073</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00406372</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00505067</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00854501</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00985853</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01118936</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01645829</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00670721</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00240115</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00281473</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00250767</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00234332</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00206258</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00150486</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00231202</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02660409</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01027638</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00328249</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0036399</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00219623</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00239537</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00183878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00151675</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00204267</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0022742</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01402824</span><span style="font-weight: bold">]])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99.16666666666667</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boot</span><span class="o">.</span><span class="n">confidence_interval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">ConfidenceInterval</span><span style="font-weight: bold">(</span><span style="color: #808000; text-decoration-color: #808000">low</span>=<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.16299788</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.11439128</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07537326</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05456608</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04340583</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02504375</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02176093</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01916549</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01078964</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2278044</span> <span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06491725</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06595956</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05403557</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04996249</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05499547</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03282023</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04093808</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04026682</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04028609</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25489541</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0247164</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02605457</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03580494</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04957356</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05540866</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06397393</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07346311</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09000358</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10071379</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.18968931</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08005183</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0722386</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06812345</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06505508</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06937702</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06241593</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06049158</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05238466</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03724037</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.14488182</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.17997978</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.11064514</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07418794</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04728167</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03266405</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02248267</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02085926</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01799767</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0105893</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.20600311</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.21356707</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.14234903</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08646321</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06221028</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04551402</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02717492</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02391779</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01620615</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00533432</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1767775</span> <span style="font-weight: bold">]])</span>, <span style="color: #808000; text-decoration-color: #808000">high</span>=<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25374534</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.14926265</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10515378</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07872001</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06680032</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04986906</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04949074</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03936925</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.032732</span>  , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33762556</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1501238</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.11857895</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09489875</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08547422</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.077294</span>  ,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06057464</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06980939</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0824857</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08383312</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.37692558</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05402637</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06673029</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07587693</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07968841</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08357547</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08850651</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10464581</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.13075589</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.15078943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.31800211</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1571642</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.12974104</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10914885</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08733478</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0901859</span> ,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08799022</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09096075</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1046824</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09754219</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.21083274</span><span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.28610653</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.15097906</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09028617</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06519387</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04795752</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03673529</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03402107</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02758909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02511773</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3743306</span> <span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.27717635</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.16383072</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10909534</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0754608</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06126973</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03929939</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03313063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0293177</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.01948093</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.26717647</span><span style="font-weight: bold">]]))</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;scipy-boot-oc_bins-</span><span class="si">{</span><span class="n">num_cuts</span><span class="si">}</span><span class="s2">_boot-</span><span class="si">{</span><span class="n">n_resamples</span><span class="si">:</span><span class="s2">1.0e</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">save_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;se&#39;</span><span class="p">:</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span><span class="p">,</span>
        <span class="s1">&#39;ci_low&#39;</span><span class="p">:</span> <span class="n">boot</span><span class="o">.</span><span class="n">confidence_interval</span><span class="o">.</span><span class="n">low</span><span class="p">,</span>
        <span class="s1">&#39;ci_high&#39;</span><span class="p">:</span> <span class="n">boot</span><span class="o">.</span><span class="n">confidence_interval</span><span class="o">.</span><span class="n">high</span><span class="p">,},</span>
    <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">figs_dir</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;npy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'scipy-boot-oc_bins-10_boot-1e+04.npy'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">real-p20-k6</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/figs_combined/real-p20-k6/scipy-boot-oc_bins-10_boot-1e+04.npy'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dlist1</span><span class="p">,</span> <span class="n">dlist2</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">intvl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
        <span class="n">dlist1</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_sample</span><span class="p">),</span>
            <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">intvl</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_sample</span><span class="p">),</span>
            <span class="s1">&#39;oc_idx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_sample</span><span class="p">),</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">real_sample</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">})</span>
        <span class="n">dlist2</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
            <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">intvl</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
            <span class="s1">&#39;oc_idx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">})</span>
<span class="n">df_real</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dlist1</span><span class="p">))</span>
<span class="n">df_boot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dlist2</span><span class="p">))</span>

<span class="n">t</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sp_stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_subjects</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span> <span class="o">*</span> <span class="n">t</span>
<span class="n">q3</span> <span class="o">=</span> <span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span> <span class="o">*</span> <span class="n">t</span>

<span class="n">dlist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ci_all</span> <span class="o">=</span> <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mf">99.99</span><span class="p">,</span> <span class="mf">99.999</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.05</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ci_all</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ci</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sp_stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_subjects</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span> <span class="o">*</span> <span class="n">t</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">real</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">intvl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
            <span class="n">_res</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">low</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
                <span class="s1">&#39;Q1&#39;</span><span class="p">:</span> <span class="n">q1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
                <span class="s1">&#39;Q3&#39;</span><span class="p">:</span> <span class="n">q3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
                <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">high</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
            <span class="p">}</span>
            <span class="n">dlist</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">_res</span><span class="p">),</span>
                <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">_res</span><span class="p">),</span>
                <span class="s1">&#39;ci&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ci</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">_res</span><span class="p">),</span>
                <span class="s1">&#39;oc_idx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">_res</span><span class="p">),</span>
                <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">intvl</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">_res</span><span class="p">),</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">_res</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">_res</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
            <span class="p">})</span>
<span class="n">df_t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dlist</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_t</span><span class="o">.</span><span class="n">interval</span> <span class="o">==</span> <span class="n">intervals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>p</th>
      <th>t</th>
      <th>ci</th>
      <th>oc_idx</th>
      <th>interval</th>
      <th>label</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>0.05000</td>
      <td>1.833113</td>
      <td>95.000</td>
      <td>1</td>
      <td>(0.9, 1.0]</td>
      <td>low</td>
      <td>0.237742</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.05000</td>
      <td>1.833113</td>
      <td>95.000</td>
      <td>1</td>
      <td>(0.9, 1.0]</td>
      <td>Q1</td>
      <td>0.257619</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0.05000</td>
      <td>1.833113</td>
      <td>95.000</td>
      <td>1</td>
      <td>(0.9, 1.0]</td>
      <td>Q3</td>
      <td>0.257619</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.05000</td>
      <td>1.833113</td>
      <td>95.000</td>
      <td>1</td>
      <td>(0.9, 1.0]</td>
      <td>high</td>
      <td>0.302211</td>
    </tr>
    <tr>
      <th>76</th>
      <td>0.05000</td>
      <td>1.833113</td>
      <td>95.000</td>
      <td>2</td>
      <td>(0.9, 1.0]</td>
      <td>low</td>
      <td>0.268470</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>919</th>
      <td>0.00001</td>
      <td>8.102058</td>
      <td>99.999</td>
      <td>5</td>
      <td>(0.9, 1.0]</td>
      <td>high</td>
      <td>0.507092</td>
    </tr>
    <tr>
      <th>956</th>
      <td>0.00001</td>
      <td>8.102058</td>
      <td>99.999</td>
      <td>6</td>
      <td>(0.9, 1.0]</td>
      <td>low</td>
      <td>0.101344</td>
    </tr>
    <tr>
      <th>957</th>
      <td>0.00001</td>
      <td>8.102058</td>
      <td>99.999</td>
      <td>6</td>
      <td>(0.9, 1.0]</td>
      <td>Q1</td>
      <td>0.205144</td>
    </tr>
    <tr>
      <th>958</th>
      <td>0.00001</td>
      <td>8.102058</td>
      <td>99.999</td>
      <td>6</td>
      <td>(0.9, 1.0]</td>
      <td>Q3</td>
      <td>0.205144</td>
    </tr>
    <tr>
      <th>959</th>
      <td>0.00001</td>
      <td>8.102058</td>
      <td>99.999</td>
      <td>6</td>
      <td>(0.9, 1.0]</td>
      <td>high</td>
      <td>0.328659</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span> <span class="nf">modify_box</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">):</span>
    <span class="n">children</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
    <span class="c1"># fix box</span>
    <span class="n">pathpatch</span> <span class="o">=</span> <span class="n">children</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">pathpatch</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">vertices</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">vertices</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">pathpatch</span><span class="o">.</span><span class="n">set_path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">codes</span><span class="p">))</span>
    <span class="c1"># fix arms</span>
    <span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;xdata&#39;</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="s1">&#39;ydata&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])})</span>
    <span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;xdata&#39;</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="s1">&#39;ydata&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">])})</span>
    <span class="n">children</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;xdata&#39;</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="s1">&#39;ydata&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])})</span>
    <span class="n">children</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;xdata&#39;</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span> <span class="k">else</span> <span class="s1">&#39;ydata&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">])})</span>
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">]</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">props</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;boxprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">},</span>
    <span class="s1">&#39;medianprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">},</span>
    <span class="s1">&#39;whiskerprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">},</span>
    <span class="s1">&#39;capprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="s1">&#39;flierprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">props</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">modify_box</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5c8e7a3079e5e751ed8ccf0fb634d75897cdf919a6cf50e6e79be30353daa606.png" src="../../_images/5c8e7a3079e5e751ed8ccf0fb634d75897cdf919a6cf50e6e79be30353daa606.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_last_bin</span><span class="p">(</span>
        <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">booted</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">df_real</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">standard_error</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">colors</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">dist_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;bca&#39;</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">),</span>
        <span class="n">ci</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">99.9</span><span class="p">,</span> <span class="p">):</span>
    <span class="kn">from</span> <span class="nn">fitter</span> <span class="kn">import</span> <span class="n">Fitter</span>
    <span class="n">props</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;boxprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ls&#39;</span><span class="p">:</span> <span class="s1">&#39;--&#39;</span><span class="p">},</span>
        <span class="s1">&#39;medianprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">},</span>
        <span class="s1">&#39;whiskerprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s1">&#39;capprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="n">meanprops</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="s2">&quot;markerfacecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="s2">&quot;markeredgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="s2">&quot;markersize&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">dist_names</span> <span class="o">=</span> <span class="n">dist_names</span> <span class="k">if</span> <span class="n">dist_names</span> <span class="k">else</span> <span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">]</span>
    <span class="n">ci_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="mi">100</span> <span class="o">-</span> <span class="n">ci</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ci_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">ci_low</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">intervals</span> <span class="o">=</span> <span class="n">df_real</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_real</span><span class="o">.</span><span class="n">oc_idx</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span>
        <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
        <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axes_twin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">Fitter</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">distributions</span><span class="o">=</span><span class="n">dist_names</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_d</span> <span class="ow">in</span> <span class="n">dist_names</span><span class="p">:</span>
            <span class="n">pdf</span> <span class="o">=</span> <span class="n">make_pdf</span><span class="p">(</span>
                <span class="n">dist</span><span class="o">=</span><span class="n">_d</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="n">_d</span><span class="p">],</span>
                <span class="n">whis</span><span class="o">=</span><span class="p">(</span><span class="n">ci_low</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">ci_high</span> <span class="o">/</span> <span class="mi">100</span><span class="p">),</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">_d</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span> <span class="k">else</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">_d</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
            <span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OC</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">//</span> <span class="n">ncols</span> <span class="o">==</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mean portion&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">ax_tx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">_df</span> <span class="o">=</span> <span class="n">df_real</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df_real</span><span class="o">.</span><span class="n">oc_idx</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df_real</span><span class="o">.</span><span class="n">interval</span> <span class="o">==</span> <span class="n">intervals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">]</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">meanprops</span><span class="o">=</span><span class="n">meanprops</span><span class="p">,</span>
            <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_tx</span><span class="p">,</span>
            <span class="o">**</span><span class="n">props</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_tx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
        
        <span class="c1"># modify box</span>
        <span class="n">real</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="c1"># quartiles</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sp_stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">real</span> <span class="o">-</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">real</span> <span class="o">+</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span>
        <span class="c1"># whiskers</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sp_stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">ci</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">real</span> <span class="o">-</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">high</span> <span class="o">=</span> <span class="n">real</span> <span class="o">+</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">ax_tx</span> <span class="o">=</span> <span class="n">modify_box</span><span class="p">(</span><span class="n">ax_tx</span><span class="p">,</span> <span class="p">[</span><span class="n">low</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">high</span><span class="p">],</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">axes_twin</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax_tx</span>
        
        <span class="c1"># change xlim</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">low</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">high</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">high</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span>
            <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">get_text</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
        <span class="p">])</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ci = </span><span class="si">{</span><span class="n">ci</span><span class="si">}</span><span class="s2"> %  whiskers: [</span><span class="si">{</span><span class="n">ci_low</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_high</span><span class="si">}</span><span class="s2">]   -   method: </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;median and mean (white circle): &#39;actual&#39; sample</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;whiskers, caps, hist: &#39;bootstrapped&#39; samples&quot;</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

    <span class="n">save_file</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;last-bin-</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;bins-</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;boot-</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">)</span><span class="si">:</span><span class="s2">1.0e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">save_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
    <span class="n">save_file</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">save_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
    <span class="n">save_fig</span><span class="p">(</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">,</span>
        <span class="n">save_file</span><span class="o">=</span><span class="n">save_file</span><span class="p">,</span>
        <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">axes_twin</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">axes_twin</span> <span class="o">=</span> <span class="n">plot_last_bin</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">,</span> <span class="n">booted</span><span class="p">,</span> <span class="n">df_real</span><span class="p">,</span> <span class="n">boot</span><span class="o">.</span><span class="n">standard_error</span><span class="p">,</span> <span class="n">svinet</span><span class="o">.</span><span class="n">colors</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">99.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="d7f6b025-6936-4adc-99c7-3117668dca33" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="e318e102-bb43-4d52-99f5-34617f4383f3" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="49b5e5ac-7093-4353-8c33-45e553522ec8" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="d614fad9-b097-4689-89eb-219624651a99" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="d98f820c-f385-4306-a260-d4b05944ba06" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="dc3184d5-b64d-42f2-abe9-ba9132195cef" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="f1334282-4272-4405-b341-db578b4fb8c0" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="66c21da7-86c2-4037-9cd4-c1600a23f44a" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="52a57ea2-cdcf-449a-b05a-98c93c521a42" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="a8d5a2b2-55f9-4d16-804d-6b15599d3f20" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="80e93ba3-d74a-4bd6-a28c-92baf5501c9d" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="1e4bfc1b-0935-4c8e-9bbf-19d3dbb1c4d6" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/real-p20-k6/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">last-bin-bca_bins-10_boot-1e+04.pdf</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">done.
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/32706419bc1f8431b27b9c09b7762ad9d642d96960f554f232bf8e95b9f1a83c.png" src="../../_images/32706419bc1f8431b27b9c09b7762ad9d642d96960f554f232bf8e95b9f1a83c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_last_bin</span><span class="p">(</span>
        <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">booted</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">df_real</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">df_boot</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">colors</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span>
        <span class="n">dist_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">),</span>
        <span class="n">ci</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">99.9</span><span class="p">,</span> <span class="p">):</span>
    <span class="kn">from</span> <span class="nn">fitter</span> <span class="kn">import</span> <span class="n">Fitter</span>
    <span class="n">props_boot</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;boxprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s1">&#39;medianprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;whiskerprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s1">&#39;capprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s1">&#39;flierprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="n">props_real</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;boxprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;medianprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
        <span class="s1">&#39;whiskerprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;capprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
        <span class="s1">&#39;flierprops&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="n">meanprops</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="s2">&quot;markerfacecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="s2">&quot;markeredgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="s2">&quot;markersize&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">dist_names</span> <span class="o">=</span> <span class="n">dist_names</span> <span class="k">if</span> <span class="n">dist_names</span> <span class="k">else</span> <span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">]</span>
    <span class="n">ci_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">((</span><span class="mi">100</span> <span class="o">-</span> <span class="n">ci</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ci_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">ci_low</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">intervals</span> <span class="o">=</span> <span class="n">df_real</span><span class="o">.</span><span class="n">interval</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_real</span><span class="o">.</span><span class="n">oc_idx</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span>
        <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
        <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">Fitter</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">distributions</span><span class="o">=</span><span class="n">dist_names</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_d</span> <span class="ow">in</span> <span class="n">dist_names</span><span class="p">:</span>
            <span class="n">pdf</span> <span class="o">=</span> <span class="n">make_pdf</span><span class="p">(</span>
                <span class="n">dist</span><span class="o">=</span><span class="n">_d</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="n">_d</span><span class="p">],</span>
                <span class="n">whis</span><span class="o">=</span><span class="p">(</span><span class="n">ci_low</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">ci_high</span> <span class="o">/</span> <span class="mi">100</span><span class="p">),</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">_d</span> <span class="o">==</span> <span class="s1">&#39;t&#39;</span> <span class="k">else</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">_d</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
            <span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OC</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">ax_tx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">_df</span> <span class="o">=</span> <span class="n">df_boot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df_boot</span><span class="o">.</span><span class="n">oc_idx</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df_boot</span><span class="o">.</span><span class="n">interval</span> <span class="o">==</span> <span class="n">intervals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">]</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="n">whis</span><span class="o">=</span><span class="p">(</span><span class="n">ci_low</span><span class="p">,</span> <span class="n">ci_high</span><span class="p">),</span>
            <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_tx</span><span class="p">,</span>
            <span class="o">**</span><span class="n">props_boot</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">_df</span> <span class="o">=</span> <span class="n">df_real</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">df_real</span><span class="o">.</span><span class="n">oc_idx</span> <span class="o">==</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">df_real</span><span class="o">.</span><span class="n">interval</span> <span class="o">==</span> <span class="n">intervals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">]</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">meanprops</span><span class="o">=</span><span class="n">meanprops</span><span class="p">,</span>
            <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_tx</span><span class="p">,</span>
            <span class="o">**</span><span class="n">props_real</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_tx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">//</span> <span class="n">ncols</span> <span class="o">==</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mean portion&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span>
            <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">get_text</span><span class="p">()),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
        <span class="p">])</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ci = </span><span class="si">{</span><span class="n">ci</span><span class="si">}</span><span class="s2"> %  whiskers: [</span><span class="si">{</span><span class="n">ci_low</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ci_high</span><span class="si">}</span><span class="s2">]   -   method: </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;median and mean (white circle): &#39;actual&#39; sample</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;whiskers, caps, hist: &#39;bootstrapped&#39; samples&quot;</span>
    <span class="n">sup</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

    <span class="n">save_file</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;last-bin-</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;bins-</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;boot-</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">)</span><span class="si">:</span><span class="s2">1.0e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">save_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
    <span class="n">save_file</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="n">save_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
    <span class="n">save_fig</span><span class="p">(</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">sup</span><span class="o">=</span><span class="n">sup</span><span class="p">,</span>
        <span class="n">save_file</span><span class="o">=</span><span class="n">save_file</span><span class="p">,</span>
        <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_last_bin</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">,</span> <span class="n">booted</span><span class="p">,</span> <span class="n">df_real</span><span class="p">,</span> <span class="n">df_boot</span><span class="p">,</span> <span class="n">svinet</span><span class="o">.</span><span class="n">colors</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">99.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="c7b3b856-eb26-47ee-9ab1-398ed5662bbf" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="ec0b01c3-5614-4c56-a37f-49eaeb6a49bf" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="0083f4ec-e989-4c5e-b4bb-f3256d9049db" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="5acd6e3e-e1cf-4330-bc78-de30159784e3" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="c573c421-9993-42b8-aab6-ced3b1ac54a1" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="87ecfa60-6c7e-4a55-b578-a1253aface54" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="bad20e38-1ec7-4622-aaa6-deff53196f51" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="a0f6ef9a-67b3-4b5a-8300-844079b049a0" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="abbcfbdc-0ad2-4d46-a42b-ee63cb599162" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="8a4bb2e0-c6fd-43cc-8bfc-67c71d91d342" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="13fdc874-c190-47b5-ac69-919a810bc4a2" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="80658731-9e46-409c-ab92-187b56a100cd" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/real-p20-k6/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">last-bin-percentile_bins-10_boot-1e+04.pdf</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">done.
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1146d95efa63e395d29566f0cd790218799b0e0e311153da0c33efe9a5430eab.png" src="../../_images/1146d95efa63e395d29566f0cd790218799b0e0e311153da0c33efe9a5430eab.png" />
</div>
</div>
</section>
<section id="new-correct-fig">
<h2>New, correct Fig<a class="headerlink" href="#new-correct-fig" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data_all</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float128&#39;</span><span class="p">)</span>
<span class="n">real_sample</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">booted</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">real</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data_all</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">((</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10000</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">))</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dlist1</span><span class="p">,</span> <span class="n">dlist2</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">intvl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
        <span class="n">dlist1</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;real&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_sample</span><span class="p">),</span>
            <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">intvl</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_sample</span><span class="p">),</span>
            <span class="s1">&#39;oc_idx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_sample</span><span class="p">),</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">real_sample</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">})</span>
        <span class="n">dlist2</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;boot&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
            <span class="s1">&#39;interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">intvl</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
            <span class="s1">&#39;oc_idx&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">booted</span><span class="p">),</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">booted</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
        <span class="p">})</span>
<span class="n">df_real</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dlist1</span><span class="p">))</span>
<span class="n">df_boot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dlist2</span><span class="p">))</span>
<span class="n">df_real</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">df_boot</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">((</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">600000</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span><span style="font-weight: bold">))</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figs</span><span class="p">,</span> <span class="n">sups</span> <span class="o">=</span> <span class="n">plot_group</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">,</span> <span class="n">df_real</span><span class="p">,</span> <span class="n">df_boot</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bb1b6706f3b2446fa1efc2d0f1029705", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/real-p20-k6/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">group_bins-10_boot-1e+04.pdf</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">done.
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_last_bin</span><span class="p">(</span><span class="n">figs_dir</span><span class="p">,</span> <span class="n">booted</span><span class="p">,</span> <span class="n">df_real</span><span class="p">,</span> <span class="n">df_boot</span><span class="p">,</span> <span class="n">svinet</span><span class="o">.</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="9fc728fb-2b13-4680-930a-0a189320d33e" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="6de2e4f7-9490-4190-a1f3-01ce1471c98f" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="3cd2ba4a-e926-436a-9aa4-33f7954732e9" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="fd91b77f-3670-4fbf-9ffb-097e2b21a1b0" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="12a3afb8-1f2b-4f0b-9dd7-8c4f2008ac84" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="020aff76-b619-48cd-a9e7-a42eaf1756ca" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="8adf9156-7e03-4f5c-8f85-cf4e6fd66d6d" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="f7383a42-4f21-4afd-8b29-39ea22611a40" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="925eeaf9-7269-48d9-9d1c-79778f5323e3" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="ebfa1998-a54c-4f5c-8256-051b5f8e73cb" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html">
            <div style="float: left; border: 1px solid black; width:500px">
              <div id="73d79162-e6d1-4d69-b8fb-5cc0ebc615a9" style="background-color:blue; width:0%">&nbsp;</div>
            </div>
            <label id="86b56b24-c966-4455-bd0a-a7c2cd11bc79" style="padding-left: 10px;" text = ""/>
            </div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/real-p20-k6/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">last-bin_bins-10_boot-1e+04.pdf</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">done.
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/baaabf24d635f2293a5c49ba14fd228c1933f0782c9c08edd06575a16c71ab24.png" src="../../_images/baaabf24d635f2293a5c49ba14fd228c1933f0782c9c08edd06575a16c71ab24.png" />
</div>
</div>
</section>
<section id="integrate-out-communities">
<h2>Integrate out communities<a class="headerlink" href="#integrate-out-communities" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">h_all</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">h_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04702574289752963</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">pi_all</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3857813</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46207</span><span style="font-weight: bold">)]</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">h_all</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pi_all</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46207</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">277242</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">pi_all</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span>
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">942</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">942</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">942</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">129</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">129</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">129</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">113</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">124</span><span style="font-weight: bold">])</span>
<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi_all</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">129</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span>nan, nan, nan, nan, nan, nan<span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">get_rng</span><span class="p">()</span>
<span class="n">num_cuts</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_cuts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">intervals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">([],</span> <span class="n">bins</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>

<span class="n">cut_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span>
    <span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_subjects</span><span class="p">,</span>
    <span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_sessions</span><span class="p">,</span>
    <span class="nb">min</span><span class="p">(</span><span class="n">seed_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
    <span class="n">num_nodes</span><span class="p">,</span> <span class="n">num_cuts</span><span class="p">,</span>
<span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">cut_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span>
    <span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_subjects</span><span class="p">,</span>
    <span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_sessions</span><span class="p">,</span>
    <span class="nb">min</span><span class="p">(</span><span class="n">seed_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
    <span class="n">num_cuts</span><span class="p">,</span>
<span class="p">))</span>

<span class="k">for</span> <span class="n">sub_i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">pi_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">for</span> <span class="n">ses_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pi_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">sub_i</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ses_i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">seed_i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">pi_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">_h</span> <span class="o">=</span> <span class="n">h_all</span><span class="p">[</span><span class="n">sub_i</span><span class="p">,</span> <span class="n">ses_i</span><span class="p">,</span> <span class="n">seed_i</span><span class="p">]</span>
            <span class="n">_cut</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">_h</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">_cut</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
            <span class="n">portions</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">]</span>
            <span class="n">cut_h</span><span class="p">[</span><span class="n">sub_i</span><span class="p">,</span> <span class="n">ses_i</span><span class="p">,</span> <span class="n">seed_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">portions</span>
            
            <span class="n">good_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_h</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">node_i</span> <span class="ow">in</span> <span class="n">good_nodes</span><span class="p">:</span>
                <span class="n">_cut</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pi_all</span><span class="p">[</span><span class="n">sub_i</span><span class="p">,</span> <span class="n">ses_i</span><span class="p">,</span> <span class="n">seed_i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">node_i</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
                <span class="n">counts</span> <span class="o">=</span> <span class="n">_cut</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
                <span class="n">portions</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">]</span>
                <span class="n">cut_nodes</span><span class="p">[</span><span class="n">sub_i</span><span class="p">,</span> <span class="n">ses_i</span><span class="p">,</span> <span class="n">seed_i</span><span class="p">,</span> <span class="n">node_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">portions</span>
<span class="n">cut_nodes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">cut_h</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;pi&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Count'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/388afdcaee6ac32fd88f1d2cfa26b7190769a6a95e9f0dd52e874664bbbbc2d3.png" src="../../_images/388afdcaee6ac32fd88f1d2cfa26b7190769a6a95e9f0dd52e874664bbbbc2d3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_cuts</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">cut_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bin = </span><span class="si">{</span><span class="n">intervals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4d1dd3c6aa515a97193cfd4c84f429296889211fbdf673ce8f0f1f7cdd0b4004.png" src="../../_images/4d1dd3c6aa515a97193cfd4c84f429296889211fbdf673ce8f0f1f7cdd0b4004.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">h_all</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">node</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Count'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/a7704ff5db5790b50578cb782ae88cd5fa28edaa477a0d5bd72d1a5a79248f23.png" src="../../_images/a7704ff5db5790b50578cb782ae88cd5fa28edaa477a0d5bd72d1a5a79248f23.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;svinet_all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">sub</span><span class="p">,</span> <span class="n">ses</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">looper</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">sub</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">ses</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">continue</span>
    
    <span class="n">reord_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;perms&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">gam_all</span><span class="p">[:,</span> <span class="n">reord_ids</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">g</span> <span class="o">/</span> <span class="n">g</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">seed_ids</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">seed_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">seed_ids</span><span class="p">]</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">entropies</span><span class="p">[</span><span class="n">sub</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ses</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span>
    
    <span class="n">nans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">good_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">nans</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)):</span>
        <span class="n">mem_cut</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
        <span class="n">mem_cut</span> <span class="o">=</span> <span class="n">mem_cut</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">mem_cut</span><span class="o">.</span><span class="n">values</span>
        <span class="n">portions</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">]</span>
        <span class="n">entropies_cut</span><span class="p">[</span><span class="n">sub</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ses</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">portions</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">good_nodes</span><span class="p">:</span>
            <span class="n">mem_cut</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">j</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">bins</span><span class="p">)</span>
            <span class="n">mem_cut</span> <span class="o">=</span> <span class="n">mem_cut</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">mem_cut</span><span class="o">.</span><span class="n">values</span>
            <span class="n">portions</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">]</span>
            <span class="n">pi_cut_nodes</span><span class="p">[</span><span class="n">sub</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ses</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">portions</span>

<span class="n">pi_cut_nodes</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c2794d4658484c01a78a53af5533ab24", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nans</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cut_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span>
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">942</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">942</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">942</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">120</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">120</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">120</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #808000; text-decoration-color: #808000">...</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span><span style="font-weight: bold">])</span>
<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cut_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.049474011436324614</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">h_all</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">h_all</span><span class="p">)]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6e95e0fc1a2f12bd6172b5d48703711828729623c016e3dc7ed1f448e305f17b.png" src="../../_images/6e95e0fc1a2f12bd6172b5d48703711828729623c016e3dc7ed1f448e305f17b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">h_all</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span>,<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.lines.Line2D</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7f85012a1d30</span><span style="font-weight: bold">&gt;]</span>
</pre>
</div><img alt="../../_images/34e2e25ab6c47c0014aa7db99ee21f0327478a2a9e3e9d8707370d24a1059c1c.png" src="../../_images/34e2e25ab6c47c0014aa7db99ee21f0327478a2a9e3e9d8707370d24a1059c1c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7f85045604c0</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/fee9c9b702a608820dc58a142443637e1a27e5473b8612484ec690da2c5f1305.png" src="../../_images/fee9c9b702a608820dc58a142443637e1a27e5473b8612484ec690da2c5f1305.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;pi&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.colorbar.Colorbar</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7f8502139640</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/dd40f61325cda55f14367da170803b92279c12bac45048aff25851fea6d0bceb.png" src="../../_images/dd40f61325cda55f14367da170803b92279c12bac45048aff25851fea6d0bceb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">gam</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;gamma_all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">_pi</span> <span class="o">=</span> <span class="n">gam</span> <span class="o">/</span> <span class="n">gam</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">sp_stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">_pi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">, min h: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">, max h: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/768e99b5e2dbf532ede65c5b6f67ea87f09dffe3d150a50d0471d4caa13d206a.png" src="../../_images/768e99b5e2dbf532ede65c5b6f67ea87f09dffe3d150a50d0471d4caa13d206a.png" />
<img alt="../../_images/3dd365e28aeb00f237e1bbe57e3796a9a360b05da84d637c01386e5c5f9e8c6c.png" src="../../_images/3dd365e28aeb00f237e1bbe57e3796a9a360b05da84d637c01386e5c5f9e8c6c.png" />
<img alt="../../_images/e07cc9aac0b5c48293b9d2e9e23fdf636e911d7dce8ff5c9e4920c8b022fafad.png" src="../../_images/e07cc9aac0b5c48293b9d2e9e23fdf636e911d7dce8ff5c9e4920c8b022fafad.png" />
<img alt="../../_images/0ef80550d37711a50393ed508cba0dc2e09fb28959e66788842cf1a876b9767e.png" src="../../_images/0ef80550d37711a50393ed508cba0dc2e09fb28959e66788842cf1a876b9767e.png" />
<img alt="../../_images/0e0e0d01d9d75b64a0009a1b3e2bdcfa5c404af438102811bc1f3003c6b6cb19.png" src="../../_images/0e0e0d01d9d75b64a0009a1b3e2bdcfa5c404af438102811bc1f3003c6b6cb19.png" />
<img alt="../../_images/4042da8bc9a617196dbea2d4ccad3441b186bcbbfa963bbfbc01da819870d7fe.png" src="../../_images/4042da8bc9a617196dbea2d4ccad3441b186bcbbfa963bbfbc01da819870d7fe.png" />
<img alt="../../_images/d80b4b99502c6f2c7357999e4427c7cae55f7c65e52d6c02889ac6dc305900fb.png" src="../../_images/d80b4b99502c6f2c7357999e4427c7cae55f7c65e52d6c02889ac6dc305900fb.png" />
<img alt="../../_images/0b2ed0b415fdcba7807c024e593227b6a86121715b11ba99df4808944856aa99.png" src="../../_images/0b2ed0b415fdcba7807c024e593227b6a86121715b11ba99df4808944856aa99.png" />
<img alt="../../_images/82ea9a5281e7cf66d7b3ef0779019521946f558a555418e1ca38914f04000137.png" src="../../_images/82ea9a5281e7cf66d7b3ef0779019521946f558a555418e1ca38914f04000137.png" />
<img alt="../../_images/0c6821a07f6156a1cd486e47b8077654001faa5ed1fad54efffd7e7278993100.png" src="../../_images/0c6821a07f6156a1cd486e47b8077654001faa5ed1fad54efffd7e7278993100.png" />
<img alt="../../_images/6082654fb029dba3816045a224800900a8e7792991b25312cf78619773febb07.png" src="../../_images/6082654fb029dba3816045a224800900a8e7792991b25312cf78619773febb07.png" />
<img alt="../../_images/57a2b821416224aca04e45a62011fe6fbde0cb7c864507b7c21e3b8eb48eea77.png" src="../../_images/57a2b821416224aca04e45a62011fe6fbde0cb7c864507b7c21e3b8eb48eea77.png" />
<img alt="../../_images/49c894e05fb1aacc2a0f9900a3e164ce13db382da0b1b5fb30ec6dfe8437ee51.png" src="../../_images/49c894e05fb1aacc2a0f9900a3e164ce13db382da0b1b5fb30ec6dfe8437ee51.png" />
<img alt="../../_images/bd39bfae0e1e4d58df49144d2261cc31487455ee519fb10169a3ab9400bc8a05.png" src="../../_images/bd39bfae0e1e4d58df49144d2261cc31487455ee519fb10169a3ab9400bc8a05.png" />
<img alt="../../_images/f0df0a12798bf1d9f2d636c85d4e4b707742267d5f8f03f1d64fee673106a367.png" src="../../_images/f0df0a12798bf1d9f2d636c85d4e4b707742267d5f8f03f1d64fee673106a367.png" />
<img alt="../../_images/b6a2ca75725b6896af63416fcfb03c480fe0095d26e3154652acbe9e9744e8d1.png" src="../../_images/b6a2ca75725b6896af63416fcfb03c480fe0095d26e3154652acbe9e9744e8d1.png" />
<img alt="../../_images/d26ccc39639d9b1e519aec5ef5f9b06b332e0bcfb33ee1946cbf8726fbfefe70.png" src="../../_images/d26ccc39639d9b1e519aec5ef5f9b06b332e0bcfb33ee1946cbf8726fbfefe70.png" />
<img alt="../../_images/a708532cb147449e96967a77940247834f7e4c98a5f4d51c979d84644a1b85f4.png" src="../../_images/a708532cb147449e96967a77940247834f7e4c98a5f4d51c979d84644a1b85f4.png" />
<img alt="../../_images/66bd48da93951f5749db9dd3b6ab7e152bc7f32c30ca3eeb2517fe48224abbc0.png" src="../../_images/66bd48da93951f5749db9dd3b6ab7e152bc7f32c30ca3eeb2517fe48224abbc0.png" />
<img alt="../../_images/0f42822fc771ca31fa43b5ec25615469403748db9fea8bed43b06d961141a36c.png" src="../../_images/0f42822fc771ca31fa43b5ec25615469403748db9fea8bed43b06d961141a36c.png" />
<img alt="../../_images/2c45f54c69d507f16be2a971e804a2f858bdf8244d909d922beea1a6a5c4f3c8.png" src="../../_images/2c45f54c69d507f16be2a971e804a2f858bdf8244d909d922beea1a6a5c4f3c8.png" />
<img alt="../../_images/83effc3a18d128debe7b9f5ce4853b54c99df141d0c964987478d599d6a93868.png" src="../../_images/83effc3a18d128debe7b9f5ce4853b54c99df141d0c964987478d599d6a93868.png" />
<img alt="../../_images/9eb26b3e2f4910612294ed8cd9833c379a3c76061693e8e8a56ff55f54026d04.png" src="../../_images/9eb26b3e2f4910612294ed8cd9833c379a3c76061693e8e8a56ff55f54026d04.png" />
<img alt="../../_images/e936185603e163c310b5e3fa200bf201f9b6eed22af3e71db1cb6786a4fcdfe3.png" src="../../_images/e936185603e163c310b5e3fa200bf201f9b6eed22af3e71db1cb6786a4fcdfe3.png" />
<img alt="../../_images/d853b7ad8d33afd8099d168e586af4e7ffefdc5cf2824e205fcdda09a353fb15.png" src="../../_images/d853b7ad8d33afd8099d168e586af4e7ffefdc5cf2824e205fcdda09a353fb15.png" />
<img alt="../../_images/f1e9442706b0b03ff359c0b39d58b7e489c4ff3c5ea6375cc6e1b6907e14cc87.png" src="../../_images/f1e9442706b0b03ff359c0b39d58b7e489c4ff3c5ea6375cc6e1b6907e14cc87.png" />
<img alt="../../_images/ea34b4ca3a01aaa2113f5889931eececfc1879cf9664b599cc971e648708a9f2.png" src="../../_images/ea34b4ca3a01aaa2113f5889931eececfc1879cf9664b599cc971e648708a9f2.png" />
<img alt="../../_images/0ba0527bb90748edb1cdcc15c31fd44dea587ecf1ed8500a0ff9691583739543.png" src="../../_images/0ba0527bb90748edb1cdcc15c31fd44dea587ecf1ed8500a0ff9691583739543.png" />
<img alt="../../_images/d1377e8baef571e022ebd9d26f927ba28e37ca18155bf5f01c20eb8bb6b7d0b6.png" src="../../_images/d1377e8baef571e022ebd9d26f927ba28e37ca18155bf5f01c20eb8bb6b7d0b6.png" />
<img alt="../../_images/e669057bb18787366b575480469f1e552c47a28da403c00451ffaa69be95a3dd.png" src="../../_images/e669057bb18787366b575480469f1e552c47a28da403c00451ffaa69be95a3dd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">))</span>
<span class="n">gam_arr</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">_pi</span><span class="p">,</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gam_arr</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;oc_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7ef95868fc199606b9a58f0b1ebfefe2a546548d78808b34534a231eadb7670b.png" src="../../_images/7ef95868fc199606b9a58f0b1ebfefe2a546548d78808b34534a231eadb7670b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.41492661</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82672472</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68213581</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.49205765</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8520797</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.48596108</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.62768482</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5790587</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.35321321</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.71733458</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.74400477</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.40248991</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72536875</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.53442075</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.53344934</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.55481887</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.78985376</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.46669976</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.32517561</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.75238062</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.76862138</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64853976</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8304846</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64623488</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.63306944</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.73964554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.49402841</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.74068415</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66310339</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.73283696</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.67956947</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.71775953</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.59656554</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.56859275</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.51933401</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.48605415</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.61826302</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64192505</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7573</span>    , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.67792683</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82294287</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.55990795</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.58558356</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68144527</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.76534287</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.81255845</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.80537844</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68901322</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68844073</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.78444326</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.29707637</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.61358312</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64504729</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.70439327</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.62323062</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.63554016</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1975646</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.69376857</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.33557285</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5439305</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.60106718</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.52730022</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5776906</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6279179</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.18268549</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.18612312</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.20793517</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.18336582</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.19350218</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83474386</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.80962794</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.644751</span>  , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66527682</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83615909</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66426029</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6589592</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83339958</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.57346567</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5123289</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.81023408</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.55602042</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.67613822</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.633046</span>  , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3811772</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.53047392</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.78239416</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50125741</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.27102729</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83035434</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.62368447</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.52923295</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.45612928</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.44468127</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.78958639</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.89558963</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.38774349</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6337868</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66035631</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9178147</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.47338839</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.65392301</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.40807053</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.26077487</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.73143169</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.77507828</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.65866328</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.77807878</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66824165</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.77633856</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7954267</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.77265986</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.80269134</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.67325811</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.78316087</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68911306</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.73735492</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66862073</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66567009</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.74462057</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2642169</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.69185219</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.62804781</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68769028</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.29973297</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.48336095</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.62051382</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.44395356</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.24588082</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.26497212</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.42352269</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.23573852</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.28453482</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.48955559</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.71312291</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.29284029</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.53614403</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.28763104</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.20043885</span><span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">gam_arr</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;gam&#39;</span><span class="p">],</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gam_arr</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;oc_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/27877418c5cd2ad21e3c800d09a2d9b89dda6cc8c17244cc37a1fa3f1f163dee.png" src="../../_images/27877418c5cd2ad21e3c800d09a2d9b89dda6cc8c17244cc37a1fa3f1f163dee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">gam_arr</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">pi_all</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gam_arr</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;oc_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4705b77d408ddcc857b23ba9ff3964798593b5691cd2aa7391252ade8a5e7278.png" src="../../_images/4705b77d408ddcc857b23ba9ff3964798593b5691cd2aa7391252ade8a5e7278.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">_pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">pi_all</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">gam_arr</span> <span class="o">=</span> <span class="n">svinet</span><span class="o">.</span><span class="n">pi2arr</span><span class="p">(</span><span class="n">_pi</span><span class="p">,</span> <span class="n">cortex_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gam_arr</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rocket&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;oc_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/41877ee6cd2c1bafa47a79794718101970bd5925218e22b8de72156b73f1f370.png" src="../../_images/41877ee6cd2c1bafa47a79794718101970bd5925218e22b8de72156b73f1f370.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_pi</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.86915131</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.80769064</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68585145</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.84495132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.81940703</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90601819</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.51931935</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.76145654</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87049879</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91355648</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82592787</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.93105628</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82785608</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.44383345</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90700943</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82204491</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90797154</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91123843</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91599848</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.89319675</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91999414</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.48064286</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.85699364</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.92267711</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.54079846</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.81310005</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91735204</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90612374</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.84055286</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.84184984</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.53259297</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.84902949</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.92199449</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83005686</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.56805971</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9347367</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.40826845</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72054241</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83684855</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87189922</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.85352341</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.89596672</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64764493</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.85300103</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68621972</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.85495402</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72024833</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90466533</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.882262</span>  , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8740084</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72132095</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.88900583</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.41619105</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87687432</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83173786</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91309939</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.79673572</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91641008</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.947285</span>  , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90740974</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90908457</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9276417</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90378401</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.92103114</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66407489</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.73876886</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.70249825</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.65218873</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.62804428</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87443068</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.80796386</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68710349</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.78768301</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.71781665</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9115713</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.45040063</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.77128924</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82511331</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90020673</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8354266</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.94405628</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.70772388</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.47309757</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.91423153</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.80927791</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.77610559</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.88702741</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.93279967</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.86769451</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9000489</span> ,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.51304632</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.84968047</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.93693792</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.57917822</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66766948</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9460923</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.92544892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.805323</span>  , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.74718397</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.53708925</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7861095</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9549686</span> , <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87798446</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.59320339</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.93686589</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.47534892</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.70783463</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68877479</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64919124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.83361853</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.89794165</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.65013318</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.68721234</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72926253</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.65405101</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72147567</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72670032</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.75537634</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.66468116</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.49857777</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.79296444</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.43376191</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.72971211</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87515749</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.90859919</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.50706726</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.87909335</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.93620622</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.89373769</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.82707355</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.95141635</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.92901826</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.92263683</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.64463891</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.61275215</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.51162872</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.45717716</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.44453689</span><span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_cuts</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="n">node</span> <span class="o">=</span> <span class="mi">47</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">pi_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bin = </span><span class="si">{</span><span class="n">intervals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/79b95c9fb9075c0aa21ed30c891f5abf491f7e26405c062e4c69c1f6e53d802b.png" src="../../_images/79b95c9fb9075c0aa21ed30c891f5abf491f7e26405c062e4c69c1f6e53d802b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">entropies</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="n">node</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Count'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/589215fb70121a7e0307965b5d0ec0d07b2bd119087d4e418081df4e9e79a66a.png" src="../../_images/589215fb70121a7e0307965b5d0ec0d07b2bd119087d4e418081df4e9e79a66a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.54</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span><span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_all</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">dtype</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'float64'</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)[:,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f5ebf9765589b62b83365d6fefb91869d713baba0c3bd50eab2fcd095c5ba83e.png" src="../../_images/f5ebf9765589b62b83365d6fefb91869d713baba0c3bd50eab2fcd095c5ba83e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e4925914d87dde86ab62be63618521e1ce55febea2c8c67b44936dc0e1f8ca8a.png" src="../../_images/e4925914d87dde86ab62be63618521e1ce55febea2c8c67b44936dc0e1f8ca8a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;cut-node_bins-</span><span class="si">{</span><span class="n">num_cuts</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">save_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="o">=</span><span class="n">data_all</span><span class="p">,</span>
    <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">figs_dir</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;npy&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'cut-node_bins-5.npy'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/fi</span>
<span style="color: #800080; text-decoration-color: #800080">gs_combined/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">real-p20-k6</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'/home/hadi/Documents/Ca-fMRI/processed/norm-global_parcel-spatial-sym_n-128/results/SVINET/figs_combined/real-p20-k6/cut-node_bins-5.npy'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data_all</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">nans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nans</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nans</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span>
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span><span style="font-weight: bold">])</span>,
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">129</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">125</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">108</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">112</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">117</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">120</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">124</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">135</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">118</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">125</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">102</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">113</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">124</span><span style="font-weight: bold">])</span>
<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">30</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">31</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">33</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">34</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">35</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">36</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">37</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">38</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">39</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">40</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">41</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">42</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">43</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">45</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">46</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">47</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">48</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">49</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">50</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">51</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">52</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">54</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">55</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">56</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">57</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">58</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">59</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">60</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">61</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">63</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">65</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">66</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">67</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">68</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">69</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">70</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">71</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">72</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">73</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">74</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">75</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">76</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">77</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">79</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">81</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">82</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">83</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">84</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">85</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">86</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">87</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">88</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">89</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">90</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">91</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">92</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">93</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">94</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">95</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">96</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">97</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">98</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">99</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">101</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">102</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">103</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">104</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">105</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">106</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">107</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">108</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">110</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">111</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">112</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">113</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">115</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">116</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">117</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">118</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">119</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">120</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">121</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">122</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">123</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">124</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">125</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">126</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">127</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">129</span>,
       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">130</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">131</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">133</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">134</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">135</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">136</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">137</span><span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_all</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">943</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/662d158540e70e83f6cb68d9858b18641eabc1dabd7ca93609d3326ef726fffb.png" src="../../_images/662d158540e70e83f6cb68d9858b18641eabc1dabd7ca93609d3326ef726fffb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_boot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">booted</span><span class="p">,</span> <span class="n">real</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">data_all</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="n">booted</span><span class="p">,</span> <span class="n">real</span> <span class="o">=</span> <span class="n">booted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> <span class="n">real</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">booted</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./nb/aug21"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#group-results">Group results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-light">BOOTSTRAP (light)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-boot">SciPy Boot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-correct-fig">New, correct Fig</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrate-out-communities">Integrate out communities</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hadi Vafaii
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>