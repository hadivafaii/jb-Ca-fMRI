
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>June 29th, 2021 &#8212; Ca-fMRI [Daily Progress]</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="June 30th, 2021" href="jun-30-2021.html" />
    <link rel="prev" title="June, 26th, 2021" href="jun-26-2021.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Ca-fMRI [Daily Progress]</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/feb21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/feb21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-12-2021.html">
     February, 12th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-13-2021.html">
     February, 13th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-16-2021.html">
     February, 16th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-20-2021.html">
     February, 20th 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/mar21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/mar21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-10-2021.html">
     March 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-13-2021.html">
     March 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-15-2021.html">
     March 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-16-2021.html">
     March 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-18-2021.html">
     March 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-19-2021.html">
     March 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-26-2021.html">
     March 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-29-2021.html">
     March 29th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/apr21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/apr21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr21/apr-07-2021.html">
     April 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr21/apr-30-2021.html">
     April 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  May 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/may21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/may21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-08-2021.html">
     May 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-09-2021.html">
     May 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-11-2021.html">
     May 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-12-2021.html">
     May 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-20-2021.html">
     May 20th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-24-2021.html">
     May 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-31-2021.html">
     May 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  June 2021
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jun21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../md/jun21_updates.html">
   Updates
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="jun-05-2021.html">
     June 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-06-2021.html">
     June 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-07-2021.html">
     June 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-12-2021.html">
     June 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-13-2021.html">
     June 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-15-2021.html">
     June 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-17-2021.html">
     June 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-18-2021.html">
     June 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-19-2021.html">
     June 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-21-2021.html">
     June 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-24-2021.html">
     June 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-26-2021.html">
     June, 26th, 2021
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     June 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jun-30-2021.html">
     June 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  July 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jul21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/jul21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-01-2021.html">
     July 1st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-09-2021.html">
     July 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-11-2021.html">
     July 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-31-2021.html">
     July 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  August 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/aug21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/aug21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../aug21/aug-21-2021.html">
     Aug 21st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  September 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/sep21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/sep21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-07-2021.html">
     Sep 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-08-2021.html">
     Sep 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-15-2021.html">
     Sep 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-19-2021.html">
     Sep 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-24-2021.html">
     Sep 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-25-2021.html">
     Sep 25th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sep21/sep-27-2021.html">
     Sep 27th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  October 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/oct21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/oct21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-06-2021.html">
     October 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-10-2021.html">
     October 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-11-2021.html">
     October 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-12-2021.html">
     October 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-16-2021.html">
     October 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-17-2021.html">
     October 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-21-2021.html">
     October 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-26-2021.html">
     October 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-27-2021.html">
     October 27th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-29-2021.html">
     October 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-30-2021.html">
     October 30th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-31-2021.html">
     October 31th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  November 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/nov21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/nov21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-05-2021.html">
     November 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-06-2021.html">
     November 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-09-2021.html">
     November 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-13-2021.html">
     November 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-24-2021.html">
     November 24th, 2021 (corr distrs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-26-2021.html">
     November 26th, 2021 (identify spikes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-29-2021.html">
     November 29th, 2021 (figs 1 and 2)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  December 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/dec21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/dec21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-01-2021.html">
     Dec 1st, 2021 (topo dist)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-04-2021.html">
     Dec 4th, 2021 (Binary vs Sample)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-06-2021.html">
     Dec 6th, 2021 (tSNR: Ca all plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-07-2021.html">
     Dec 7th, 2021 (tSNR: Ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-08-2021.html">
     Dec 8th, 2021 (scp2raw2npy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-09-2021.html">
     Dec 9th, 2021 (tSNR: BOLD)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-10-2021.html">
     Dec 10th, 2021 (tSNR: identify bad areas)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-17-2021.html">
     Dec 17th, 2021 (GS all plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-18-2021.html">
     Dec 18th, 2021 (rabies)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-21-2021.html">
     Dec 21st, 2021 (ROI layers: concept)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-22-2021.html">
     Dec 22nd, 2021 (3-depths + render fns)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-24-2021.html">
     Dec 24th, 2021 (ROI layers: compare)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-27-2021.html">
     Dec 27th, 2021 (Parcel viz 3D)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  January 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jan22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/jan22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-03-2022.html">
     Jan 3rd, 2022 (Coreg ses play; fix 10_3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-04-2022.html">
     Jan 4th, 2022 (Coreg ses)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-07-2022.html">
     Jan 7th, 2022 (rabies: 2nd stage)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-12-2022.html">
     Jan 12th, 2022 (voxel sz plots)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-13-2022.html">
     Jan 13th, 2022 (topo dist, best density)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-17-2022.html">
     Jan 17th, 2022 (Results at various thresholds, discussion on topology)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-19-2022.html">
     Jan 19th, 2022 (Hierarchical)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-22-2022.html">
     Jan 22nd, 2022 (degree dist, cartography)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-25-2022.html">
     Jan 25th, 2022 (debug boot + 2 anim draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-26-2022.html">
     Jan 26th, 2022 (cleaner figs, SE bug)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-27-2022.html">
     Jan 27th, 2022 (SE debug)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-28-2022.html">
     Jan 28th, 2022 (SE debug: cont.)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-29-2022.html">
     Jan 29th, 2022 (seed filter: draft)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-30-2022.html">
     Jan 30th, 2022 (seed filter)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jan22/jan-31-2022.html">
     Jan 31st, 2022 (small memship vote: draft)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/feb22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/feb22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-01-2022.html">
     Feb 1st, 2022 (small memship vote)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-02-2022.html">
     Feb 2nd, 2022 (Mouse ICA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-04-2022.html">
     Feb 4th, 2022 (plot bold+ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-06-2022.html">
     Feb 6th, 2022 (rabies: 3rd stage)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-07-2022.html">
     Feb 7th, 2022 (Structural Connectome)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-08-2022.html">
     Feb 08, 2022 (LED vs. REST; avg over runs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-14-2022.html">
     Feb 14th, 2022 (pruned in grp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-15a-2022.html">
     Feb 15th, 2022 (Smart adj plot)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-15b-2022.html">
     Feb 15th, 2022 (Smart adj plot; better)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-18-2022.html">
     Feb 18th, 2022 (upsample bold; corr timeseries)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-22-2022.html">
     Feb 22nd, 2022 (GLM Ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-24-2022.html">
     Feb 24th, 2022 (grant finalize)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-25a-2022.html">
     Feb 25th, 2022 (Figs 4 the talk)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-25b-2022.html">
     Feb 25th, 2022 (compare cosine, DMN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-25c-2022.html">
     Feb 25th, 2022 (Entropy, carto)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-25d-2022.html">
     Feb 25th, 2022 (LFR reboot)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-25e-2022.html">
     Feb 25th, 2022 (ovp score, C_i; pie charts)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb22/feb-25f-2022.html">
     Feb 25th, 2022 (ROI plots)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/mar22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/mar22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar22/mar-05-2022.html">
     Mar 5th, 2022 (debug net; spearman &gt; pearson)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar22/mar-06-2022.html">
     Mar 6th, 2022 (Cartography, explored)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/apr22.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/apr22_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-01-2022.html">
     Apr 1st, 2022 (props, pie, entropy, contour, carto)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-02-2022.html">
     Apr 2nd, 2022 (quality control: both modalities)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-03-2022.html">
     Apr 3rd, 2022 (copy files: rabies + ca)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-04-2022.html">
     Apr 4th, 2022 (ca ref; viz some t)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-05-2022.html">
     Apr 5th, 2022 (check co-registration perf)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-07-2022.html">
     Apr 7th, 2022 (Fig 4, OCs, cosine sim, DMN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-11-2022.html">
     Apr 11th, 2022 (fix: affiliation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-12-2022.html">
     Apr 12th, 2022 (ent fixed + some supp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-13-2022.html">
     Apr 13th, 2022 (node &amp; oc overlap scores)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-14-2022.html">
     Apr 14th, 2022 (carto fixed + some supp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-15-2022.html">
     Apr 15th, 2022 (parcellation fix)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr22/apr-17-2022.html">
     April 17th, 2022 (register RABIES)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/nb/jun21/jun-29-2021.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hadivafaii/Ca-fMRI"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/hadivafaii/Ca-fMRI/issues/new?title=Issue%20on%20page%20%2Fnb/jun21/jun-29-2021.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hadivafaii/Ca-fMRI/master?urlpath=tree/docs/nb/jun21/jun-29-2021.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-prepare">
   Load &amp; prepare
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mice">
     Mice
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parcellation">
     parcellation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combine-all-data">
     Combine all data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hierarchical-clustering">
   Hierarchical clustering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#all-clusters">
     All clusters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#embed-table">
     Embed table
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#render">
   Render
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#embed-3d">
     Embed 3d
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dice">
   Dice
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#canberra">
   Canberra?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#report-properties-of-a-parcellation-todo">
   Report properties of a parcellation (TODO)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gozzi-data">
   Gozzi data
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="june-29th-2021">
<h1>June 29th, 2021<a class="headerlink" href="#june-29th-2021" title="Permalink to this headline">¶</a></h1>
<p><strong>Motivation</strong>: Visualize cortical 2d projections, combine data in various ways + hierarchical results <br></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span> <span class="k">as</span> <span class="n">dc</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="kn">from</span> <span class="nn">myterial</span> <span class="kn">import</span> <span class="n">orange</span><span class="p">,</span> <span class="n">blue_grey</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">rgb2hex</span><span class="p">,</span> <span class="n">to_rgb</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># set style &amp; no interpolalation</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.interpolation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/tmp&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/_extras&#39;</span><span class="p">)</span>

<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;Ca-fMRI&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">load_allen</span><span class="p">,</span> <span class="n">load_bg_atlas</span>
<span class="kn">from</span> <span class="nn">register.parcellation</span> <span class="kn">import</span> <span class="n">Parcellation</span>
<span class="kn">from</span> <span class="nn">analysis.hierarchical</span> <span class="kn">import</span> <span class="n">Hierarchical</span>
<span class="kn">from</span> <span class="nn">utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.render</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">model.mouse</span> <span class="kn">import</span> <span class="n">Mice</span>
<span class="kn">from</span> <span class="nn">model.configuration</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="c1"># warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-prepare">
<h2>Load &amp; prepare<a class="headerlink" href="#load-prepare" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mice">
<h3>Mice<a class="headerlink" href="#mice" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">convert_time</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">00</span> - <span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">00:00:30</span>  <span style="font-weight: bold">(</span>dd - hh:mm:ss<span style="font-weight: bold">)</span>

</pre>
</div></div>
</div>
</div>
<div class="section" id="parcellation">
<h3>parcellation<a class="headerlink" href="#parcellation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">show_2d</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_6_0.png" src="../../_images/jun-29-2021_6_0.png" />
<img alt="../../_images/jun-29-2021_6_1.png" src="../../_images/jun-29-2021_6_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramp_colors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;#0023ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#0ea4f1&#39;</span><span class="p">,</span> <span class="s1">&#39;#00ffcf&#39;</span><span class="p">,</span> <span class="s1">&#39;#00ffc1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#00ff0d&#39;</span><span class="p">,</span> <span class="s1">&#39;#00c72e&#39;</span><span class="p">,</span> <span class="s1">&#39;#caff58&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#cfff00&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffc22c&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff7200&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#f42c0b&#39;</span><span class="p">,</span> <span class="s1">&#39;#d82789&#39;</span><span class="p">,</span> <span class="s1">&#39;#ad00ff&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">custom_cmap</span> <span class="o">=</span> <span class="n">make_cmap</span><span class="p">(</span>
    <span class="n">ramp_colors</span><span class="o">=</span><span class="n">ramp_colors</span><span class="p">,</span>
    <span class="n">n_colors</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;n_cortical_regions&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;custom&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_8_0.png" src="../../_images/jun-29-2021_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">parcel2html</span><span class="p">(</span>
    <span class="n">masks</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;eroded_masks&#39;</span><span class="p">],</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">extras_dir</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">parcel-1024_cmap-custom.html</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">include</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">include</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">include</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">include</span><span class="p">]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span> <span class="k">if</span> <span class="n">cmap</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mf">0.5</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">][</span><span class="n">acro</span><span class="p">]</span> <span class="k">for</span> <span class="n">acro</span> <span class="ow">in</span> <span class="n">include</span><span class="p">]</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="o">~</span><span class="n">cond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">])</span>

    <span class="n">data2plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;atlas&#39;</span><span class="p">])</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

    <span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="n">tick_labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">acro</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">acro</span> <span class="ow">in</span> <span class="n">include</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">acro</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;acro2idx&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;name2idx&#39;</span><span class="p">])</span>
    <span class="p">]</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.3</span><span class="p">)</span>

    <span class="n">_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">show_2d</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;centers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span>
<span class="c1"># ax.invert_yaxis()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_12_0.png" src="../../_images/jun-29-2021_12_0.png" />
<img alt="../../_images/jun-29-2021_12_1.png" src="../../_images/jun-29-2021_12_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_14_0.png" src="../../_images/jun-29-2021_14_0.png" />
</div>
</div>
</div>
<div class="section" id="combine-all-data">
<h3>Combine all data<a class="headerlink" href="#combine-all-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">44</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1650</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1650</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1650</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1100</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10_ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10_ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1650</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10_ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6050</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6050</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6050</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5500</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6600</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6050</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62700</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ses-1'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19800</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ses-2'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20900</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ses-3'</span>: <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22000</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e6</span>
    <span class="n">tot</span> <span class="o">+=</span> <span class="n">size</span>
<span class="n">tot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">278.89030399999996</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mice</span><span class="o">.</span><span class="n">bold_df_piv</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e6</span>
    <span class="n">tot</span> <span class="o">+=</span> <span class="n">size</span>
<span class="n">tot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">124.76966399999972</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
<span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="p">[</span><span class="s1">&#39;sub-SLC&#39;</span><span class="p">]</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node_labels</span><span class="p">)}</span>

<span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_df_piv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">((</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">62700</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span><span style="font-weight: bold">)</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">138</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">204</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
</div>
</div>
<div class="section" id="hierarchical-clustering">
<h2>Hierarchical clustering<a class="headerlink" href="#hierarchical-clustering" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_idxs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> 
    <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="mi">7</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="mi">8</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="mi">9</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="mi">10</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="mi">11</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="mi">12</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="mi">13</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="mi">14</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="mi">15</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">hier</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span>
<span class="n">hier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="c1">#, c_idxs)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">convert_time</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">00</span> - <span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">00:01:00</span>  <span style="font-weight: bold">(</span>dd - hh:mm:ss<span style="font-weight: bold">)</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;fig&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_34_0.png" src="../../_images/jun-29-2021_34_0.png" />
</div>
</div>
<div class="section" id="all-clusters">
<h3>All clusters<a class="headerlink" href="#all-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">result_dict</span> <span class="ow">in</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n_clusters = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;cluster_classes&#39;</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;fig&#39;</span><span class="p">]</span>
    <span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;cluster_colors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="c1"># export results</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">extras_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;CORR-REST-</span><span class="si">{</span><span class="n">hier</span><span class="o">.</span><span class="n">parcel</span><span class="p">[</span><span class="s1">&#39;n_cortical_regions&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(31)', '(107)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_2.png" src="../../_images/jun-29-2021_37_2.png" />
<div class="output text_html"><svg  width="110" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-2.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-2.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(31)', '(23)', '(84)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_9.png" src="../../_images/jun-29-2021_37_9.png" />
<div class="output text_html"><svg  width="165" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-3.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-3.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(31)', '(23)', '(37)', '(47)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_16.png" src="../../_images/jun-29-2021_37_16.png" />
<div class="output text_html"><svg  width="220" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-4.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-4.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(31)', '(23)', '(37)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(14)', '(33)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_23.png" src="../../_images/jun-29-2021_37_23.png" />
<div class="output text_html"><svg  width="275" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-5.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-5.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(31)', '(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(10)', '(27)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(14)', '(33)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_30.png" src="../../_images/jun-29-2021_37_30.png" />
<div class="output text_html"><svg  width="330" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-6.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-6.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(10)', '(27)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(33)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_37.png" src="../../_images/jun-29-2021_37_37.png" />
<div class="output text_html"><svg  width="385" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-7.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-7.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(10)', '(7)', '(20)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(33)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_44.png" src="../../_images/jun-29-2021_37_44.png" />
<div class="output text_html"><svg  width="440" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-8.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-8.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(10)', '(7)', '(5)', '(15)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(33)', '(14)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_51.png" src="../../_images/jun-29-2021_37_51.png" />
<div class="output text_html"><svg  width="495" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-9.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-9.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(10)', '(7)', '(5)', '(15)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(10)', '(23)', '(14)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_58.png" src="../../_images/jun-29-2021_37_58.png" />
<div class="output text_html"><svg  width="550" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-10.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-10.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(4)', '(6)', '(7)', '(5)', '(15)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(10)', '(23)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_65.png" src="../../_images/jun-29-2021_37_65.png" />
<div class="output text_html"><svg  width="605" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="550" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-11.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-11.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(4)', '(6)', '(7)', '(5)', '(6)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(10)', '(23)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_72.png" src="../../_images/jun-29-2021_37_72.png" />
<div class="output text_html"><svg  width="660" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="550" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="605" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-12.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-12.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(16)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(4)', '(6)', '(7)', '(5)', '(6)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(10)', '(11)', '(12)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_79.png" src="../../_images/jun-29-2021_37_79.png" />
<div class="output text_html"><svg  width="715" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="550" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="605" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="660" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-13.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-13.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(7)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(4)', '(6)', '(7)', '(5)', '(6)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(10)', '(11)', '(12)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_86.png" src="../../_images/jun-29-2021_37_86.png" />
<div class="output text_html"><svg  width="770" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="550" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="605" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="660" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="715" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-14.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-14.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">n_clusters = <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>
</pre>
</div><div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(7)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(4)', '(6)', '(7)', '(5)', '(6)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(10)', '(11)', '(5)', '(7)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_37_93.png" src="../../_images/jun-29-2021_37_93.png" />
<div class="output text_html"><svg  width="825" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="550" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="605" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="660" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="715" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="770" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-regions_n-15.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> <span style="color: #008000; text-decoration-color: #008000">'CORR-REST-128-clusters_n-15.html'</span> saved at
<span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">_extras</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="s1">&#39;cluster_classes&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="s1">&#39;ax&#39;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="s1">&#39;fig&#39;</span><span class="p">]</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">15</span><span class="p">][</span><span class="s1">&#39;cluster_colors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table style="border: 0;"><tr style="border: 0;"><td style="background-color: #1f77b4; border: 0;"><code style="background-color: #1f77b4;">#1f77b4</code></td><td style="border: 0"><code>['(23)']</code></td></tr><tr style="border: 0;"><td style="background-color: #ff7f0e; border: 0;"><code style="background-color: #ff7f0e;">#ff7f0e</code></td><td style="border: 0"><code>['(15)', '(7)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #2ca02c; border: 0;"><code style="background-color: #2ca02c;">#2ca02c</code></td><td style="border: 0"><code>['(4)', '(6)', '(7)', '(5)', '(6)', '(9)']</code></td></tr><tr style="border: 0;"><td style="background-color: #d62728; border: 0;"><code style="background-color: #d62728;">#d62728</code></td><td style="border: 0"><code>['(14)', '(10)', '(11)', '(5)', '(7)']</code></td></tr></table></div><img alt="../../_images/jun-29-2021_39_1.png" src="../../_images/jun-29-2021_39_1.png" />
<div class="output text_html"><svg  width="825" height="55"><rect x="0" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="55" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="110" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="165" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="220" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="275" y="0" width="55" height="55" style="fill:#e377c2;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="330" y="0" width="55" height="55" style="fill:#7f7f7f;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="385" y="0" width="55" height="55" style="fill:#bcbd22;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="440" y="0" width="55" height="55" style="fill:#17becf;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="495" y="0" width="55" height="55" style="fill:#1f77b4;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="550" y="0" width="55" height="55" style="fill:#ff7f0e;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="605" y="0" width="55" height="55" style="fill:#2ca02c;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="660" y="0" width="55" height="55" style="fill:#d62728;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="715" y="0" width="55" height="55" style="fill:#9467bd;stroke-width:2;stroke:rgb(255,255,255)"/><rect x="770" y="0" width="55" height="55" style="fill:#8c564b;stroke-width:2;stroke:rgb(255,255,255)"/></svg></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="fixed" style="border:0px solid black;width: 100%; table-layout: fixed"><col width="5%" /><col width="95%" /><tr style="border: 0"><td style="background-color: #98d6f9;border: 0; text-align: center">STR</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>100%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #8599cc;border: 0; text-align: center">PAL</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>100%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #9ad2bd;border: 0; text-align: center">OLF</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>100%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #8ada87;border: 0; text-align: center">CTXsp</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>100%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #7ed04b;border: 0; text-align: center">HPF</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>100%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #08858c;border: 0; text-align: center">VIS</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>100%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #15b0b3;border: 0; text-align: center">TEa</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="42.20862846104314%" /><col width="45px" /><col width="39.47198969735995%" /><col width="45px" /><col width="18.319381841596908%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>42%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>39%</p></td><td style="background-color: #ff7f0e;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>18%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #0e9684;border: 0; text-align: center">PERI</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="83.5633626097867%" /><col width="45px" /><col width="9.912170639899623%" /><col width="45px" /><col width="6.524466750313676%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>84%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>10%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>7%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #0d9f91;border: 0; text-align: center">ECT</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="81.13425925925925%" /><col width="45px" /><col width="10.532407407407407%" /><col width="45px" /><col width="8.333333333333334%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>81%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>11%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>8%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #1aa698;border: 0; text-align: center">RSP</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="56.50884744141559%" /><col width="45px" /><col width="41.75035868005739%" /><col width="45px" /><col width="1.7407938785270205%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>57%</p></td><td style="background-color: #ff7f0e;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>42%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>2%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #019399;border: 0; text-align: center">AUD</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="48.33622183708839%" /><col width="45px" /><col width="45.77123050259965%" /><col width="45px" /><col width="5.892547660311958%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>48%</p></td><td style="background-color: #ff7f0e;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>46%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>6%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #009fac;border: 0; text-align: center">PTLp</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="100.0%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>100%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #11ad83;border: 0; text-align: center">VISC</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="55.56962025316456%" /><col width="45px" /><col width="23.755274261603375%" /><col width="45px" /><col width="20.675105485232066%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>56%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>24%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>21%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SS</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="55.422156856859864%" /><col width="45px" /><col width="35.14121919740673%" /><col width="45px" /><col width="9.415613650688838%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>55%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>35%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>9%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="57.50698898207531%" /><col width="45px" /><col width="31.002302252918927%" /><col width="45px" /><col width="11.461930603519159%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>58%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>31%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>11%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-bfd</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="74.62187549753224%" /><col width="45px" /><col width="25.362203470784905%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>75%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>25%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-ll</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="97.4587039390089%" /><col width="45px" /><col width="2.4142312579415504%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>97%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>2%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-m</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="92.6413881748072%" /><col width="45px" /><col width="7.358611825192802%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>93%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>7%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-n</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="64.6108179419525%" /><col width="45px" /><col width="35.389182058047496%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>65%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>35%</p></td><td style="background-color: #8c564b;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-tr</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="73.90993566833453%" /><col width="45px" /><col width="25.804145818441743%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>74%</p></td><td style="background-color: #ff7f0e;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>26%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-ul</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="85.97236981934113%" /><col width="45px" /><col width="12.885228480340064%" /><col width="45px" /><col width="1.1424017003188098%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>86%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>13%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>1%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSp-un</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="78.06809184481394%" /><col width="45px" /><col width="17.102137767220903%" /><col width="45px" /><col width="4.829770387965162%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>78%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>17%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>5%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #188064;border: 0; text-align: center">SSs</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="49.78316468364283%" /><col width="45px" /><col width="46.336039141554544%" /><col width="45px" /><col width="3.880796174802624%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>50%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>46%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_1</b><br>4%</p></td><td style="background-color: #ff7f0e;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #009c75;border: 0; text-align: center">GU</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="69.20454545454545%" /><col width="45px" /><col width="23.181818181818183%" /><col width="45px" /><col width="7.613636363636363%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>69%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>23%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>8%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #40a666;border: 0; text-align: center">ACA</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="70.58716596982367%" /><col width="45px" /><col width="27.37684057444101%" /><col width="45px" /><col width="2.035993455735321%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>71%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>27%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>2%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #219866;border: 0; text-align: center">AI</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="65.76279776989357%" /><col width="45px" /><col width="17.802838317283324%" /><col width="45px" /><col width="16.434363912823112%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>66%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>18%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>16%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #1f9d5a;border: 0; text-align: center">MO</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="36.29454069957502%" /><col width="45px" /><col width="31.305165086629618%" /><col width="45px" /><col width="25.74370709382151%" /><col width="45px" /><col width="6.656587119973848%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>36%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>31%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>26%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>7%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #1f9d5a;border: 0; text-align: center">MOp</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="49.331926863572434%" /><col width="45px" /><col width="36.031997187060476%" /><col width="45px" /><col width="13.65154711673699%" /><col width="45px" /><col width="0.9845288326300985%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>49%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>36%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>14%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>1%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #1f9d5a;border: 0; text-align: center">MOs</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="55.963653023824065%" /><col width="45px" /><col width="16.80665852168601%" /><col width="45px" /><col width="15.6459987782529%" /><col width="45px" /><col width="11.583689676237018%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>56%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>17%</p></td><td style="background-color: #9467bd;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_5</b><br>16%</p></td><td style="background-color: #8c564b;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>12%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #59b363;border: 0; text-align: center">ILA</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="99.76442873969376%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>100%</p></td><td style="background-color: #2ca02c;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #2fa850;border: 0; text-align: center">PL</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="48.04767776407727%" /><col width="45px" /><col width="46.23921085080148%" /><col width="45px" /><col width="5.713111385121249%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>48%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>46%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>6%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #248a5e;border: 0; text-align: center">ORB</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="73.73428474345906%" /><col width="45px" /><col width="22.86782195039076%" /><col width="45px" /><col width="3.397893306150187%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>74%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>23%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>3%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr><tr style="border: 0"><td style="background-color: #268f45;border: 0; text-align: center">FRP</td><td style="border: 0; padding: 10px"><table class="fixed" style="border: 1px solid black;width: 100%; table-layout: fixed"><col width="45px" /><col width="72.04968944099379%" /><col width="45px" /><col width="19.358178053830226%" /><col width="45px" /><col width="8.592132505175984%" /><tr style="border: 0"><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_3</b><br>72%</p></td><td style="background-color: #d62728;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_2</b><br>19%</p></td><td style="background-color: #2ca02c;"></td><td style="background-color: transparent;border: 1px solid black;"><p style="font-family:Courier; text-align: center;"><b>C_4</b><br>9%</p></td><td style="background-color: #9467bd;"></td></tr></table></td></tr></table></div></div>
</div>
</div>
<div class="section" id="embed-table">
<h3>Embed table<a class="headerlink" href="#embed-table" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;../../_extras/full-</span><span class="si">{</span><span class="n">hier</span><span class="o">.</span><span class="n">parcel</span><span class="p">[</span><span class="s1">&#39;n_cortical_regions&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-regions_n-</span><span class="si">{</span><span class="n">n_clusters</span><span class="si">}</span><span class="s2">.html&quot;</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">550</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="1000"
    height="550"
    src="../../_extras/full-128-regions_n-5.html"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
</div>
</div>
<div class="section" id="render">
<h2>Render<a class="headerlink" href="#render" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">cluster2html</span><span class="p">(</span>
        <span class="n">cluster</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">],</span>
        <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;CORR-REST&#39;</span><span class="p">,</span>
        <span class="n">n_cortex_regions</span><span class="o">=</span><span class="n">hier</span><span class="o">.</span><span class="n">parcel</span><span class="p">[</span><span class="s1">&#39;n_cortical_regions&#39;</span><span class="p">],</span>
        <span class="n">save_dir</span><span class="o">=</span><span class="n">extras_dir</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-4.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-1.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-2.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-3.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-4.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-5.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-6.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-7.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-8.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-9.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-10.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-11.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-12.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-13.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-14.html</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Scene saved at <span style="color: #800080; text-decoration-color: #800080">/home/hadi/Dropbox/git/jb-Ca-fMRI/_extras/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">CORR-REST_render-128_n-15.html</span>
</pre>
</div></div>
</div>
<div class="section" id="embed-3d">
<h3>Embed 3d<a class="headerlink" href="#embed-3d" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>  
<span class="n">file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;../../_extras/CORR-REST_render-</span><span class="si">{</span><span class="n">mice</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_cortex_regions</span><span class="si">}</span><span class="s2">_n-</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">.html&quot;</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe
    width="1000"
    height="700"
    src="../../_extras/CORR-REST_render-128_n-5.html"
    frameborder="0"
    allowfullscreen
></iframe>
</div></div>
</div>
</div>
</div>
<div class="section" id="dice">
<h2>Dice<a class="headerlink" href="#dice" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dice_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">overlap_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">distance</span> <span class="k">as</span> <span class="n">sp_dist</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp_dist</span><span class="o">.</span><span class="n">jaccard</span><span class="p">,</span> <span class="n">sp_dist</span><span class="o">.</span><span class="n">hamming</span><span class="p">,</span> <span class="n">sp_dist</span><span class="o">.</span><span class="n">chebyshev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span>
    <span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">function</span><span style="color: #000000; text-decoration-color: #000000"> jaccard at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7be038160</span><span style="font-weight: bold">&gt;</span>,
    <span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">function</span><span style="color: #000000; text-decoration-color: #000000"> hamming at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7be0380d0</span><span style="font-weight: bold">&gt;</span>,
    <span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">function</span><span style="color: #000000; text-decoration-color: #000000"> chebyshev at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7be038430</span><span style="font-weight: bold">&gt;</span>
<span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df = mice.bold_combined[&#39;sub-SLC&#39;]</span>
<span class="c1"># node_labels = df.columns.values.tolist()</span>
<span class="c1"># node_labels = {i: lbl for i, lbl in enumerate(node_labels)}</span>

<span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;correlation&#39;</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">hier</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="p">[</span><span class="s1">&#39;sub-SLC&#39;</span><span class="p">],</span>
    <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">convert_time</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">hier1</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="p">[</span><span class="s1">&#39;ses-1&#39;</span><span class="p">],</span>
    <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">convert_time</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">hier2</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="p">[</span><span class="s1">&#39;ses-2&#39;</span><span class="p">],</span>
    <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">convert_time</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">hier3</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="p">[</span><span class="s1">&#39;ses-3&#39;</span><span class="p">],</span>
    <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">convert_time</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">00</span> - <span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">00:01:05</span>  <span style="font-weight: bold">(</span>dd - hh:mm:ss<span style="font-weight: bold">)</span>

</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">00</span> - <span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">00:01:01</span>  <span style="font-weight: bold">(</span>dd - hh:mm:ss<span style="font-weight: bold">)</span>

</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">00</span> - <span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">00:01:00</span>  <span style="font-weight: bold">(</span>dd - hh:mm:ss<span style="font-weight: bold">)</span>

</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">00</span> - <span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">00:01:01</span>  <span style="font-weight: bold">(</span>dd - hh:mm:ss<span style="font-weight: bold">)</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">project_masks_2d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># _ = mice.parcel.get_annot_fig(fig, axes[-1], ctick_labelsize=7, shrink=0.5)</span>

<span class="k">for</span> <span class="n">ax_i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ax_i</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">ax_i</span><span class="o">%</span><span class="k">ncols</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
    <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
    <span class="n">coord2c</span> <span class="o">=</span> <span class="n">project_masks_2d</span><span class="p">(</span><span class="n">cluster_masks</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_y</span><span class="p">,</span> <span class="n">npix_z</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">][</span><span class="s1">&#39;sizes&#39;</span><span class="p">]</span>
    <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_z</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">pix</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">clusters2d</span><span class="p">[</span><span class="n">pix</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
    <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

    <span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">=</span> <span class="n">filter_boundaries</span><span class="p">(</span>
        <span class="n">x_list</span><span class="o">=</span><span class="p">[</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">],</span> <span class="n">clusters2d</span><span class="p">],</span>
        <span class="n">mask</span><span class="o">=</span><span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">data2plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_67_0.png" src="../../_images/jun-29-2021_67_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># _ = mice.parcel.get_annot_fig(fig, axes[-1], ctick_labelsize=7, shrink=0.5)</span>

<span class="k">for</span> <span class="n">ax_i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ax_i</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">ax_i</span><span class="o">%</span><span class="k">ncols</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">hier3</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
    <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
    <span class="n">coord2c</span> <span class="o">=</span> <span class="n">project_masks_2d</span><span class="p">(</span><span class="n">cluster_masks</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_y</span><span class="p">,</span> <span class="n">npix_z</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">][</span><span class="s1">&#39;sizes&#39;</span><span class="p">]</span>
    <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_z</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">pix</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">clusters2d</span><span class="p">[</span><span class="n">pix</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
    <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

    <span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">=</span> <span class="n">filter_boundaries</span><span class="p">(</span>
        <span class="n">x_list</span><span class="o">=</span><span class="p">[</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">],</span> <span class="n">clusters2d</span><span class="p">],</span>
        <span class="n">mask</span><span class="o">=</span><span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">data2plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_69_0.png" src="../../_images/jun-29-2021_69_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">project_masks_2d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;correlation&#39;</span>

<span class="n">hierarchical</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">_hier</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
    <span class="n">hierarchical</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_hier</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax_i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ax_i</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">ax_i</span><span class="o">%</span><span class="k">ncols</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="n">_hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
        <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
        <span class="n">coord2c</span> <span class="o">=</span> <span class="n">project_masks_2d</span><span class="p">(</span><span class="n">cluster_masks</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_y</span><span class="p">,</span> <span class="n">npix_z</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">][</span><span class="s1">&#39;sizes&#39;</span><span class="p">]</span>
        <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_z</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">pix</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">clusters2d</span><span class="p">[</span><span class="n">pix</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

        <span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">=</span> <span class="n">filter_boundaries</span><span class="p">(</span>
            <span class="n">x_list</span><span class="o">=</span><span class="p">[</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">],</span> <span class="n">clusters2d</span><span class="p">],</span>
            <span class="n">mask</span><span class="o">=</span><span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data2plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1d565989d0a94bfdabd94f5f3bd37eec", "version_major": 2, "version_minor": 0}
</script><img alt="../../_images/jun-29-2021_74_1.png" src="../../_images/jun-29-2021_74_1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_3.png" src="../../_images/jun-29-2021_74_3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_5.png" src="../../_images/jun-29-2021_74_5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_7.png" src="../../_images/jun-29-2021_74_7.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_9.png" src="../../_images/jun-29-2021_74_9.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_11.png" src="../../_images/jun-29-2021_74_11.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_13.png" src="../../_images/jun-29-2021_74_13.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_15.png" src="../../_images/jun-29-2021_74_15.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_17.png" src="../../_images/jun-29-2021_74_17.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_19.png" src="../../_images/jun-29-2021_74_19.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_21.png" src="../../_images/jun-29-2021_74_21.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_23.png" src="../../_images/jun-29-2021_74_23.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_25.png" src="../../_images/jun-29-2021_74_25.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_27.png" src="../../_images/jun-29-2021_74_27.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_29.png" src="../../_images/jun-29-2021_74_29.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_31.png" src="../../_images/jun-29-2021_74_31.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_33.png" src="../../_images/jun-29-2021_74_33.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_35.png" src="../../_images/jun-29-2021_74_35.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_37.png" src="../../_images/jun-29-2021_74_37.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_39.png" src="../../_images/jun-29-2021_74_39.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_41.png" src="../../_images/jun-29-2021_74_41.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_43.png" src="../../_images/jun-29-2021_74_43.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_45.png" src="../../_images/jun-29-2021_74_45.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_47.png" src="../../_images/jun-29-2021_74_47.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_49.png" src="../../_images/jun-29-2021_74_49.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_51.png" src="../../_images/jun-29-2021_74_51.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_53.png" src="../../_images/jun-29-2021_74_53.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_55.png" src="../../_images/jun-29-2021_74_55.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_57.png" src="../../_images/jun-29-2021_74_57.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_59.png" src="../../_images/jun-29-2021_74_59.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_61.png" src="../../_images/jun-29-2021_74_61.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_63.png" src="../../_images/jun-29-2021_74_63.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_65.png" src="../../_images/jun-29-2021_74_65.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_67.png" src="../../_images/jun-29-2021_74_67.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_69.png" src="../../_images/jun-29-2021_74_69.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_71.png" src="../../_images/jun-29-2021_74_71.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_73.png" src="../../_images/jun-29-2021_74_73.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_75.png" src="../../_images/jun-29-2021_74_75.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_77.png" src="../../_images/jun-29-2021_74_77.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_79.png" src="../../_images/jun-29-2021_74_79.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_81.png" src="../../_images/jun-29-2021_74_81.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_83.png" src="../../_images/jun-29-2021_74_83.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_85.png" src="../../_images/jun-29-2021_74_85.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_74_87.png" src="../../_images/jun-29-2021_74_87.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">hierarchical</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10_ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10_ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10_ses-3'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC01'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC02'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC03'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC04'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC05'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC06'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC07'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC08'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC09'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC10'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'sub-SLC'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ses-1'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ses-2'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'ses-3'</span>
<span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">project_masks_2d</span>
<span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span>
<span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dice_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">overlap_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">m1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ses-1&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-2&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-3&#39;</span><span class="p">]</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;correlation&#39;</span>

<span class="n">hierarchical</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selected_keys</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">_hier</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
    <span class="n">hierarchical</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_hier</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax_i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ax_i</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">ax_i</span><span class="o">%</span><span class="k">ncols</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="n">_hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
        <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
        <span class="n">coord2c</span> <span class="o">=</span> <span class="n">project_masks_2d</span><span class="p">(</span><span class="n">cluster_masks</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_y</span><span class="p">,</span> <span class="n">npix_z</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">][</span><span class="s1">&#39;sizes&#39;</span><span class="p">]</span>
        <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_z</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">pix</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">clusters2d</span><span class="p">[</span><span class="n">pix</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

        <span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">=</span> <span class="n">filter_boundaries</span><span class="p">(</span>
            <span class="n">x_list</span><span class="o">=</span><span class="p">[</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">],</span> <span class="n">clusters2d</span><span class="p">],</span>
            <span class="n">mask</span><span class="o">=</span><span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data2plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "600acb34b0304b1994f4fb795433d4e0", "version_major": 2, "version_minor": 0}
</script><img alt="../../_images/jun-29-2021_80_1.png" src="../../_images/jun-29-2021_80_1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_80_3.png" src="../../_images/jun-29-2021_80_3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_80_5.png" src="../../_images/jun-29-2021_80_5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_best_match</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">reverese</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
    <span class="n">ind_x</span><span class="p">,</span> <span class="n">ind_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span>
        <span class="n">indices</span><span class="o">=</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">reverese</span> <span class="k">else</span> <span class="n">ind</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_i</span><span class="p">,</span> <span class="n">_j</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ind_x</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_i</span> <span class="ow">and</span> <span class="n">ind_y</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_j</span><span class="p">:</span>
            <span class="n">_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_x</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span>
            <span class="n">_j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_y</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_i</span><span class="p">))</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_i</span><span class="p">))</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">cond_safety</span> <span class="o">=</span> <span class="n">ctr</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">cond</span> <span class="ow">or</span> <span class="n">cond_safety</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="n">_j</span><span class="p">)}</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">mapping</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">avg_scores</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dict_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">masks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">selected_keys</span><span class="p">:</span>
        <span class="n">hier</span> <span class="o">=</span> <span class="n">hierarchical</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
        <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
        <span class="n">masks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_masks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">selected_keys</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">dice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">])))</span>
        <span class="n">overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">])))</span>
        <span class="n">jaccard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">])))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">m2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">]):</span>
                <span class="n">dice</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dice_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
                <span class="n">overlap</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlap_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
                <span class="n">jaccard</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sp_dist</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">m2</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dice&#39;</span><span class="p">:</span> <span class="n">dice</span><span class="p">,</span>
            <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="n">overlap</span><span class="p">,</span>
            <span class="s1">&#39;jaccard&#39;</span><span class="p">:</span> <span class="n">jaccard</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">find_best_match</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[:,</span> <span class="nb">list</span><span class="p">(</span><span class="n">mappings</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;n_rois&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">hier</span><span class="o">.</span><span class="n">parcel</span><span class="p">[</span><span class="s1">&#39;n_cortical_regions&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;n_clusters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">])]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;dist_measure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">v</span><span class="p">)],</span>
            <span class="p">}</span>
            <span class="n">dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

        <span class="c1"># fig, axes = create_figure(1, 3, figsize=(8, 3))</span>
        <span class="c1"># for ax, (k, v) in zip(axes, results.items()):</span>
        <span class="c1">#     im = ax.imshow(v, cmap=&#39;nipy_spectral&#39;)</span>
        <span class="c1">#     plt.colorbar(im, ax=ax, shrink=0.6)</span>
        <span class="c1">#     ax.set_title(f&quot;cond: {&#39;_&#39;.join([k1, k2])}\n{k}, mean: {np.round(np.diag(v).mean(), 3)}&quot;)</span>
        <span class="c1"># fig.suptitle(n, fontsize=12)</span>
        <span class="c1"># plt.show()</span>
        <span class="c1"># print(&#39;\n\n&#39;)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dict_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a802c983ec29434a9be67251dc0897a6", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Index</span><span style="font-weight: bold">([</span><span style="color: #008000; text-decoration-color: #008000">'n_rois'</span>, <span style="color: #008000; text-decoration-color: #008000">'n_clusters'</span>, <span style="color: #008000; text-decoration-color: #008000">'condition'</span>, <span style="color: #008000; text-decoration-color: #008000">'metric'</span>, <span style="color: #008000; text-decoration-color: #008000">'dist_measure'</span>, <span style="color: #008000; text-decoration-color: #008000">'value'</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">dtype</span>=<span style="color: #008000; text-decoration-color: #008000">'object'</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>

<span class="n">selected_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">results_df</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;correlation&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">selected_df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">selected_df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
    <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_87_0.png" src="../../_images/jun-29-2021_87_0.png" />
</div>
</div>
</div>
<div class="section" id="canberra">
<h2>Canberra?<a class="headerlink" href="#canberra" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">project_masks_2d</span>
<span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dice_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">overlap_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">m1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ses-1&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-2&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-3&#39;</span><span class="p">]</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;canberra&#39;</span>

<span class="n">hierarchical</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">bold_combined</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selected_keys</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">_hier</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">parcel</span><span class="o">=</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="p">,</span>
        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
    <span class="n">hierarchical</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_hier</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax_i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">ax_i</span><span class="o">//</span><span class="n">ncols</span><span class="p">,</span> <span class="n">ax_i</span><span class="o">%</span><span class="k">ncols</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="n">_hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
        <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
        <span class="n">coord2c</span> <span class="o">=</span> <span class="n">project_masks_2d</span><span class="p">(</span><span class="n">cluster_masks</span><span class="p">,</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_y</span><span class="p">,</span> <span class="n">npix_z</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">][</span><span class="s1">&#39;sizes&#39;</span><span class="p">]</span>
        <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npix_x</span><span class="p">,</span> <span class="n">npix_z</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">pix</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coord2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">clusters2d</span><span class="p">[</span><span class="n">pix</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">clusters2d</span> <span class="o">=</span> <span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>

        <span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">=</span> <span class="n">filter_boundaries</span><span class="p">(</span>
            <span class="n">x_list</span><span class="o">=</span><span class="p">[</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;contour&#39;</span><span class="p">],</span> <span class="n">clusters2d</span><span class="p">],</span>
            <span class="n">mask</span><span class="o">=</span><span class="n">clusters2d</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">_contour</span><span class="p">,</span> <span class="n">_x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data2plt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">remove_ticks</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5acf1c95a1d64d29967aa52f50c77989", "version_major": 2, "version_minor": 0}
</script><img alt="../../_images/jun-29-2021_93_1.png" src="../../_images/jun-29-2021_93_1.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_93_3.png" src="../../_images/jun-29-2021_93_3.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div><img alt="../../_images/jun-29-2021_93_5.png" src="../../_images/jun-29-2021_93_5.png" />
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">


</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_best_match</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">reverese</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
    <span class="n">ind_x</span><span class="p">,</span> <span class="n">ind_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span>
        <span class="n">indices</span><span class="o">=</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">reverese</span> <span class="k">else</span> <span class="n">ind</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_i</span><span class="p">,</span> <span class="n">_j</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ind_x</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_i</span> <span class="ow">and</span> <span class="n">ind_y</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_j</span><span class="p">:</span>
            <span class="n">_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_x</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span>
            <span class="n">_j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_y</span><span class="p">[</span><span class="n">ctr</span><span class="p">])</span>
        <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_i</span><span class="p">))</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_i</span><span class="p">))</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">cond_safety</span> <span class="o">=</span> <span class="n">ctr</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">cond</span> <span class="ow">or</span> <span class="n">cond_safety</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="n">_j</span><span class="p">)}</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">mapping</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">avg_scores</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dict_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">masks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">selected_keys</span><span class="p">:</span>
        <span class="n">hier</span> <span class="o">=</span> <span class="n">hierarchical</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">cluster</span> <span class="o">=</span> <span class="n">hier</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>
        <span class="n">cluster_masks</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cluster</span><span class="o">.</span><span class="n">idxs</span><span class="p">}</span>
        <span class="n">masks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_masks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">selected_keys</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">dice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">])))</span>
        <span class="n">overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">])))</span>
        <span class="n">jaccard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">])))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">m2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="n">k2</span><span class="p">]):</span>
                <span class="n">dice</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dice_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
                <span class="n">overlap</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlap_score</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
                <span class="n">jaccard</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sp_dist</span><span class="o">.</span><span class="n">jaccard</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">m2</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dice&#39;</span><span class="p">:</span> <span class="n">dice</span><span class="p">,</span>
            <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="n">overlap</span><span class="p">,</span>
            <span class="s1">&#39;jaccard&#39;</span><span class="p">:</span> <span class="n">jaccard</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">find_best_match</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[:,</span> <span class="nb">list</span><span class="p">(</span><span class="n">mappings</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;n_rois&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">hier</span><span class="o">.</span><span class="n">parcel</span><span class="p">[</span><span class="s1">&#39;n_cortical_regions&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;n_clusters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;condition&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">])]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;dist_measure&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span>
                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">v</span><span class="p">)],</span>
            <span class="p">}</span>
            <span class="n">dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

        <span class="c1"># fig, axes = create_figure(1, 3, figsize=(8, 3))</span>
        <span class="c1"># for ax, (k, v) in zip(axes, results.items()):</span>
        <span class="c1">#     im = ax.imshow(v, cmap=&#39;nipy_spectral&#39;)</span>
        <span class="c1">#     plt.colorbar(im, ax=ax, shrink=0.6)</span>
        <span class="c1">#     ax.set_title(f&quot;cond: {&#39;_&#39;.join([k1, k2])}\n{k}, mean: {np.round(np.diag(v).mean(), 3)}&quot;)</span>
        <span class="c1"># fig.suptitle(n, fontsize=12)</span>
        <span class="c1"># plt.show()</span>
        <span class="c1"># print(&#39;\n\n&#39;)</span>

<span class="n">results_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">dict_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6ce382262d894956aae8fc8b97f87348", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1">#selected_df = results_df.loc[results_df.metric == &#39;correlation&#39;]</span>
    <span class="n">selected_df</span> <span class="o">=</span> <span class="n">results_df</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">results_df2</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">selected_df</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
        <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">selected_df</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s1">&#39;dist_measure&#39;</span><span class="p">,</span>
        <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_98_0.png" src="../../_images/jun-29-2021_98_0.png" />
</div>
</div>
</div>
<div class="section" id="report-properties-of-a-parcellation-todo">
<h2>Report properties of a parcellation (TODO)<a class="headerlink" href="#report-properties-of-a-parcellation-todo" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>use this:</p>
</div></blockquote>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyinspect</span> <span class="k">as</span> <span class="nn">pi</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints an overview of the Actors in the scene.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">actors</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">Report</span><span class="p">(</span>
            <span class="s2">&quot;Scene actors&quot;</span><span class="p">,</span> <span class="n">accent</span><span class="o">=</span><span class="n">salmon</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">orange</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">:</span>
            <span class="n">actors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold][</span><span class="si">{</span><span class="n">amber</span><span class="si">}</span><span class="s2">]- </span><span class="si">{</span><span class="n">act</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[/bold][</span><span class="si">{</span><span class="n">orange_darker</span><span class="si">}</span><span class="s2">] &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(type: [</span><span class="si">{</span><span class="n">orange</span><span class="si">}</span><span class="s2">]</span><span class="si">{</span><span class="n">act</span><span class="o">.</span><span class="n">br_class</span><span class="si">}</span><span class="s2">[/</span><span class="si">{</span><span class="n">orange</span><span class="si">}</span><span class="s2">]) &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(color: [</span><span class="si">{</span><span class="n">orange</span><span class="si">}</span><span class="s2">]</span><span class="si">{</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">act</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">c</span><span class="p">())</span><span class="si">}</span><span class="s2">[/</span><span class="si">{</span><span class="n">orange</span><span class="si">}</span><span class="s2">]) &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(alpha: [</span><span class="si">{</span><span class="n">orange</span><span class="si">}</span><span class="s2">]</span><span class="si">{</span><span class="n">act</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">alpha</span><span class="p">()</span><span class="si">}</span><span class="s2">[/</span><span class="si">{</span><span class="n">orange</span><span class="si">}</span><span class="s2">]) &quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;win32&quot;</span> <span class="o">!=</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="p">:</span>
            <span class="n">actors</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gozzi-data">
<h2>Gozzi data<a class="headerlink" href="#gozzi-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ants</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;/home/hadi/Downloads/ica_all_05_icasso_iter_1000_comp_0_mask_z_1_allen_masked_sym_thresh.nrrd&#39;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type : float <span style="font-weight: bold">(</span>float32<span style="font-weight: bold">)</span>
         Components : <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
         Dimensions : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">)</span>
         Spacing    : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span><span style="font-weight: bold">)</span>
         Origin     : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span><span style="font-weight: bold">)</span>
         Direction  : <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.<span style="font-weight: bold">]</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_114_0.png" src="../../_images/jun-29-2021_114_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;/home/hadi/Downloads/ica_all_05_icasso_iter_1000_comp_0_mask_z_1_allen_masked_sym_thresh.nii.gz&#39;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ANTsImage <span style="font-weight: bold">(</span>RPI<span style="font-weight: bold">)</span>
         Pixel Type : float <span style="font-weight: bold">(</span>float32<span style="font-weight: bold">)</span>
         Components : <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
         Dimensions : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span><span style="font-weight: bold">)</span>
         Spacing    : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span><span style="font-weight: bold">)</span>
         Origin     : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span><span style="font-weight: bold">)</span>
         Direction  : <span style="font-weight: bold">[</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.<span style="font-weight: bold">]</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/jun-29-2021_116_0.png" src="../../_images/jun-29-2021_116_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nb/jun21"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="jun-26-2021.html" title="previous page">June, 26th, 2021</a>
    <a class='right-next' id="next-link" href="jun-30-2021.html" title="next page">June 30th, 2021</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hadi Vafaii<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>