
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sep 26th, 2021 &#8212; Ca-fMRI [Daily Progress]</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Ca-fMRI [Daily Progress]</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/intro.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  February 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/feb21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/feb21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-12-2021.html">
     February, 12th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-13-2021.html">
     February, 13th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-16-2021.html">
     February, 16th 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../feb21/feb-20-2021.html">
     February, 20th 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  March 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/mar21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/mar21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-10-2021.html">
     March 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-13-2021.html">
     March 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-15-2021.html">
     March 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-16-2021.html">
     March 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-18-2021.html">
     March 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-19-2021.html">
     March 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-26-2021.html">
     March 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mar21/mar-29-2021.html">
     March 29th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  April 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/apr21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/apr21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr21/apr-07-2021.html">
     April 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../apr21/apr-30-2021.html">
     April 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  May 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/may21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/may21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-08-2021.html">
     May 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-09-2021.html">
     May 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-11-2021.html">
     May 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-12-2021.html">
     May 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-20-2021.html">
     May 20th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-24-2021.html">
     May 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../may21/may-31-2021.html">
     May 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  June 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jun21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/jun21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-05-2021.html">
     June 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-06-2021.html">
     June 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-07-2021.html">
     June 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-12-2021.html">
     June 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-13-2021.html">
     June 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-15-2021.html">
     June 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-17-2021.html">
     June 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-18-2021.html">
     June 18th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-19-2021.html">
     June 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-21-2021.html">
     June 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-24-2021.html">
     June 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-26-2021.html">
     June, 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-29-2021.html">
     June 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jun21/jun-30-2021.html">
     June 30th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  July 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/jul21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/jul21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-01-2021.html">
     July 1st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-09-2021.html">
     July 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-11-2021.html">
     July 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jul21/jul-31-2021.html">
     July 31st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  August 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/aug21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/aug21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../aug21/aug-21-2021.html">
     Aug 21st, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  September 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/sep21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/sep21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-07-2021.html">
     Sep 7th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-08-2021.html">
     Sep 8th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-15-2021.html">
     Sep 15th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-19-2021.html">
     Sep 19th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-24-2021.html">
     Sep 24th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-25-2021.html">
     Sep 25th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sep-27-2021.html">
     Sep 27th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  October 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/oct21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/oct21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-06-2021.html">
     October 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-10-2021.html">
     October 10th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-11-2021.html">
     October 11th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-12-2021.html">
     October 12th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-16-2021.html">
     October 16th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-17-2021.html">
     October 17th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-21-2021.html">
     October 21st, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-26-2021.html">
     October 26th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-27-2021.html">
     October 27th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-29-2021.html">
     October 29th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-30-2021.html">
     October 30th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../oct21/oct-31-2021.html">
     October 31th, 2021
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  November 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/nov21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/nov21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-05-2021.html">
     November 5th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-06-2021.html">
     November 6th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-09-2021.html">
     November 9th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-13-2021.html">
     November 13th, 2021
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-24-2021.html">
     November 24th, 2021 (corr distrs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-26-2021.html">
     November 26th, 2021 (identify spikes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nov21/nov-29-2021.html">
     November 29th, 2021 (figs 1 and 2)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  December 2021
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../md/dec21.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../md/dec21_updates.html">
   Updates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dec21/dec-01-2021.html">
     Dec 1st, 2021 (topo dist)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/nb/sep21/sep-26or7-2021.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hadivafaii/Ca-fMRI"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/hadivafaii/Ca-fMRI/issues/new?title=Issue%20on%20page%20%2Fnb/sep21/sep-26or7-2021.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hadivafaii/Ca-fMRI/master?urlpath=tree/docs/nb/sep21/sep-26or7-2021.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#now-do-yale2indiv">
   Now do Yale2Indiv
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#now-do-the-inverse-of-double-thing">
   Now do the inverse of double thing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#direct-indiv">
   Direct indiv
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-do-the-direct-to-indiv-thing">
     Now do the direct to indiv thing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#do-the-double-thing">
   do the double thing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-load-slides-and-watch-out-for-bad-registrations">
   Next, load slides and watch out for bad registrations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-do-the-same-for-each-individual-animal-check-if-it-works">
   Next, do the same for each individual animal, check if it works
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-see-if-you-need-to-register-per-animal-or-just-register-individuals-to-n162-and-gateway">
   Next, see if you need to register per animal, or just register individuals to N162 and gateway?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-1">
   Figure 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what">
     What
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how">
     How
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="sep-26th-2021">
<h1>Sep 26th, 2021<a class="headerlink" href="#sep-26th-2021" title="Permalink to this headline">¶</a></h1>
<p><strong>Motivation</strong>: This has the most succesfull registration of Nissl to sub-SLC01_ses-2 <br></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDE CODE</span>


<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span> <span class="k">as</span> <span class="n">dc</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">pjoin</span>
<span class="kn">from</span> <span class="nn">myterial</span> <span class="kn">import</span> <span class="n">orange</span><span class="p">,</span> <span class="n">blue_grey</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">rgb2hex</span><span class="p">,</span> <span class="n">to_rgb</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># set style &amp; no interpolalation</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.interpolation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>

<span class="c1"># tmp &amp; extras dir</span>
<span class="n">git_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Dropbox/git&#39;</span><span class="p">)</span>
<span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/tmp&#39;</span><span class="p">)</span>
<span class="n">extras_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;jb-Ca-fMRI/_extras&#39;</span><span class="p">)</span>
<span class="n">lfr_dir</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Documents/workspaces/lfr/binary_overlapping&#39;</span><span class="p">)</span>


<span class="c1"># GitHub</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pjoin</span><span class="p">(</span><span class="n">git_dir</span><span class="p">,</span> <span class="s1">&#39;_Ca-fMRI&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">register.atlas</span> <span class="kn">import</span> <span class="n">load_allen</span><span class="p">,</span> <span class="n">make_tree_graph</span>
<span class="kn">from</span> <span class="nn">register.parcellation</span> <span class="kn">import</span> <span class="n">Parcellation</span>
<span class="kn">from</span> <span class="nn">analysis.hierarchical</span> <span class="kn">import</span> <span class="n">Hierarchical</span>
<span class="kn">from</span> <span class="nn">analysis.bootstrap</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.svinet</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.group</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">analysis.lfr</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.render</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utils.plotting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">model.mouse</span> <span class="kn">import</span> <span class="n">Mice</span>
<span class="kn">from</span> <span class="nn">model.configuration</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="c1"># warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">load_preproc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">register.register</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">anat</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">T1w</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">indiv</span> <span class="o">=</span> <span class="n">anat</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="n">indiv</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">indiv</span><span class="p">)</span>
    <span class="n">m_indiv</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">mask3d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="n">m_indiv</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">m_indiv</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint32&#39;</span><span class="p">))</span>
    <span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./sep26_imgs/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.nii.gz&quot;</span><span class="p">)</span>
    <span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">m_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./sep26_imgs/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_mask.nii.gz&quot;</span><span class="p">)</span>

    <span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;indiv2nissl&#39;</span><span class="p">,</span>
        <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
        <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
        <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">],</span><span class="c1">#, &#39;SyNAggro&#39;],</span>
        <span class="n">grads</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span><span class="c1"># [0.15, 0.2, 0.25, 0.3],</span>
        <span class="n">syn_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
        <span class="n">aff_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
        <span class="n">aff_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
        <span class="n">n_seeds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">df_tx</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;tx&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./sep26_dfs/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.df&quot;</span><span class="p">)</span>
    <span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
        <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
        <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">iso</span><span class="p">,</span>
        <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
        <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">vis_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
        <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
        <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">vis</span><span class="p">,</span>
        <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
        <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./sep26_results/iso_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best.nii.gz&quot;</span><span class="p">)</span>
    <span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./sep26_results/vis_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best.nii.gz&quot;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">indiv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
            <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
            <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
            <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;./sep26_reg_plts/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/30 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a4a4ed99de8b453bacf47ba7a547c1a6", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.999042</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|▎         | 1/30 [1:44:54&lt;50:42:17, 6294.39s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2541cc14e77a4316b19f04845ad1299d", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.981711</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|▋         | 2/30 [3:28:51&lt;48:41:36, 6260.60s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "554583db031448408ca2ba755c518ddf", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.988704</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|█         | 3/30 [5:12:09&lt;46:44:22, 6231.93s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "111b68607f7349c591a005a8c4d8aed9", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.992055</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 13%|█▎        | 4/30 [6:58:05&lt;45:21:51, 6281.23s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ed43b5b5064245ada36b1991f8c1f9bd", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.994103</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|█▋        | 5/30 [8:43:43&lt;43:45:37, 6301.48s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "76d0ba5522e947b8b53e9d0809c50804", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.993446</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|██        | 6/30 [10:30:57&lt;42:18:38, 6346.62s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4f1e1c498ad643fb9b3b448206184bda", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.995685</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|██▎       | 7/30 [12:20:12&lt;40:58:58, 6414.70s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2c3d0f71ae404f7b9114986f8a6a77fb", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.998132</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 27%|██▋       | 8/30 [14:08:07&lt;39:19:06, 6433.93s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6e512b7154884927940ffea873ec8529", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.996249</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|███       | 9/30 [15:56:56&lt;37:42:18, 6463.75s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9d721c29a6b5430c87d3478957cfe5e2", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.999512</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███▎      | 10/30 [17:44:32&lt;35:53:42, 6461.10s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "60ea18ae4d2c4de3a849067bae07394b", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.999612</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 37%|███▋      | 11/30 [19:31:12&lt;34:00:06, 6442.47s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "edc4c961f80943839f49774ba7acf526", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.995877</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 40%|████      | 12/30 [21:17:49&lt;32:08:38, 6428.78s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0113f75746a34a27b1cff7456b12a0b5", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.999046</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 43%|████▎     | 13/30 [23:02:48&lt;30:10:18, 6389.33s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "581ab84a08594c0da614e76c1cec135c", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.997046</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 47%|████▋     | 14/30 [24:52:46&lt;28:40:36, 6452.29s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2bbf8fccef1142cfaa8cee7d8d2ec795", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.998896</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|█████     | 15/30 [26:45:56&lt;27:18:31, 6554.13s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d1a12a371ad4411dbec8dc4a8abde13e", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.996444</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 53%|█████▎    | 16/30 [28:34:35&lt;25:26:48, 6543.49s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f02e364aa6624a14af74de30ef658531", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.994853</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 57%|█████▋    | 17/30 [30:24:16&lt;23:40:15, 6555.06s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "65b389012148461381c044e9f8816767", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.997426</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|██████    | 18/30 [32:15:30&lt;21:58:09, 6590.76s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "505ab58682d04a3ba93c82473418e62f", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed                 <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
type        ElasticSyN
grad               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric             sym
score         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.991982</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 63%|██████▎   | 19/30 [34:12:02&lt;20:30:24, 6711.31s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0a8728cfd9a443628cd7d78d49a1e571", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.8</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.994685</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|██████▋   | 20/30 [36:00:24&lt;18:28:04, 6648.42s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "75ed619652ab4c809f5b84362de1748a", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars
</pre></div>
</div>
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed              <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
type            SyN
grad            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
aff_rate        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric          sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.99918</span>

</pre>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|███████   | 21/30 [37:46:35&lt;16:24:45, 6565.06s/it]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4f91e3c421a749228adc623dfdeb5db7", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hadi/Dropbox/git/_Ca-fMRI/analysis/helper.py:483: RuntimeWarning:

invalid value encountered in long_scalars

 70%|███████   | 21/30 [39:31:42&lt;16:56:26, 6776.31s/it]
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">7569</span><span class="n">f7d31d90</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">m_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./sep26_imgs/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_mask.nii.gz&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> 
<span class="ne">----&gt; </span><span class="mi">9</span>     <span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>         <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;indiv2nissl&#39;</span><span class="p">,</span>

<span class="nn">~/Dropbox/git/_Ca-fMRI/register/register.py</span> in <span class="ni">fit_register</span><span class="nt">(self, name, mode, fixed, moving, save_results, types, grads, syn_bins, aff_bins, aff_rates, n_seeds)</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span> 			<span class="n">n_seeds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>                 <span class="k">assert</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2d&#39;</span><span class="p">,</span> <span class="s1">&#39;3d&#39;</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">231</span>                 <span class="n">grads</span> <span class="o">=</span> <span class="n">grads</span> <span class="k">if</span> <span class="n">grads</span> <span class="k">else</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span>                 <span class="n">types</span> <span class="o">=</span> <span class="n">types</span> <span class="k">if</span> <span class="n">types</span> <span class="k">else</span> <span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>                 <span class="n">syn_bins</span> <span class="o">=</span> <span class="n">syn_bins</span> <span class="k">if</span> <span class="n">syn_bins</span> <span class="k">else</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>

<span class="nn">~/anaconda3/lib/python3.8/site-packages/ants/registration/interface.py</span> in <span class="ni">registration</span><span class="nt">(fixed, moving, type_of_transform, initial_transform, outprefix, mask, grad_step, flow_sigma, total_sigma, aff_metric, aff_sampling, aff_random_sampling_rate, syn_metric, syn_sampling, reg_iterations, aff_iterations, aff_shrink_factors, aff_smoothing_sigmas, write_composite_transform, random_seed, verbose, multivariate_extras, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1375</span>                 <span class="n">processed_args</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">_int_antsProcessArguments</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1376</span>                 <span class="n">libfn</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_lib_fn</span><span class="p">(</span><span class="s2">&quot;antsRegistration&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1377</span>                 <span class="n">libfn</span><span class="p">(</span><span class="n">processed_args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1378</span>                 <span class="n">afffns</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">outprefix</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot;[0-9]GenericAffine.mat&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1379</span>                 <span class="n">fwarpfns</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">outprefix</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="s2">&quot;[0-9]Warp.nii.gz&quot;</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;sub-SLC01_ses-2&#39;</span>
<span class="n">indiv</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">T1w</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">indiv</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">indiv</span><span class="p">)</span>
<span class="n">m_indiv</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">mask3d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">m_indiv</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">m_indiv</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint32&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;indiv2nissl&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">],</span>
    <span class="n">grads</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="n">syn_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="n">aff_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="n">aff_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "13f95df70d0143f887fb2a4dc14df46c", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">indiv2nissl, perf:
seed               <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
type             SyN
grad             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
syn_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
aff_bin           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric           sym
score       <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.980779</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SyN&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;syn_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;aff_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;aff_rate&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>896</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.492028</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>897</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.989187</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>898</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.933439</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>899</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>ovp_iso</td>
      <td>0.964235</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>900</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>ovp_vis</td>
      <td>0.959105</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>901</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.975250</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>902</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>ovp</td>
      <td>0.962953</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>903</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.324601</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>904</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.969184</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>905</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.968280</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>906</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>ovp_iso_fixed</td>
      <td>1.000000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>907</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>ovp_vis_fixed</td>
      <td>1.000000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>908</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.968958</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>909</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>ovp_fixed</td>
      <td>1.000000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mi&#39;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;syn_bin&#39;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.502</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">xlabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'score'</span><span style="color: #000000; text-decoration-color: #000000">, </span><span style="color: #808000; text-decoration-color: #808000">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Count'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_15_1.png" src="../../_images/sep-26or7-2021_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mi&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;syn_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)],</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.502</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">AxesSubplot:</span><span style="color: #808000; text-decoration-color: #808000; font-weight: bold">xlabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'score'</span><span style="color: #000000; text-decoration-color: #000000">, </span><span style="color: #808000; text-decoration-color: #808000">ylabel</span><span style="color: #000000; text-decoration-color: #000000">=</span><span style="color: #008000; text-decoration-color: #008000">'Count'</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_17_1.png" src="../../_images/sep-26or7-2021_17_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;syn_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mi&#39;</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>0</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499653</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.172756</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>196</th>
      <td>0</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499606</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>210</th>
      <td>0</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499648</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>308</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499061</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>322</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.500080</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>420</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499037</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>434</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499198</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>532</th>
      <td>2</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499508</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>546</th>
      <td>2</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.071741</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>644</th>
      <td>2</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499775</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>658</th>
      <td>2</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.071741</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>756</th>
      <td>3</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499388</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>770</th>
      <td>3</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499470</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>868</th>
      <td>3</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499641</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>882</th>
      <td>3</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.500185</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>980</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499490</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>994</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499661</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1092</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.499993</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1106</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.500908</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span> <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>,
        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span><span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">19</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1106</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.500908</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;syn_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;aff_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;aff_rate&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1106</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.500908</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1107</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.997923</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1108</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.910112</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1109</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>ovp_iso</td>
      <td>0.967698</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1110</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>ovp_vis</td>
      <td>0.969865</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1111</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.975971</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1112</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>ovp</td>
      <td>0.968240</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1113</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.325335</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1114</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.981789</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1115</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.920661</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1116</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>ovp_iso_fixed</td>
      <td>1.000000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1117</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>ovp_vis_fixed</td>
      <td>1.000000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1118</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.966507</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>1119</th>
      <td>4</td>
      <td>ElasticSyN</td>
      <td>0.3</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>ovp_fixed</td>
      <td>1.000000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">seed                                                        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
type                                               ElasticSyN
grad                                                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin                                                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin                                                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_rate                                                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric                                                     mi
score                                                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.500908</span>
tx          <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'warpedmovout'</span>: ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type <span style="color: #808000; text-decoration-color: #808000">...</span>
Name: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1106</span>, dtype: object
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;mi&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;sym&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.505</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_29_1.png" src="../../_images/sep-26or7-2021_29_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;sym_vis&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;sym_iso&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.95</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.0</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_32_1.png" src="../../_images/sep-26or7-2021_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;sym_iso&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;sym_vis&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">c</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;sym_iso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">102</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>817</th>
      <td>4</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.974359</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SyN&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;syn_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;aff_bin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;aff_rate&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>240</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.497111</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>241</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.975625</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>242</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.946844</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>243</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.961234</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>244</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.325399</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>245</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.958575</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>246</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.970639</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>247</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.3</td>
      <td>16</td>
      <td>13</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.964607</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">seed                                                        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
type                                               ElasticSyN
grad                                                      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3</span>
syn_bin                                                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
aff_bin                                                    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
aff_rate                                                  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
metric                                                    sym
score                                                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.957011</span>
tx          <span style="font-weight: bold">{</span><span style="color: #008000; text-decoration-color: #008000">'warpedmovout'</span>: ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type <span style="color: #808000; text-decoration-color: #808000">...</span>
Name: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">947</span>, dtype: object
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ovp&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sym&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.96</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.97</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_40_1.png" src="../../_images/sep-26or7-2021_40_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mi&#39;</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mi&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;metric&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sym&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.495</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.99</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_43_1.png" src="../../_images/sep-26or7-2021_43_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="o">.</span><span class="n">seed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>type</th>
      <th>grad</th>
      <th>syn_bin</th>
      <th>aff_bin</th>
      <th>aff_rate</th>
      <th>metric</th>
      <th>score</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.496176</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.990708</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.906793</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.948751</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.324756</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.974037</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.940000</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.957018</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.496002</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.991222</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.904836</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.948029</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.324750</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.974463</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>46</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.934534</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1</td>
      <td>SyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.954498</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.496048</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.991983</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>50</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.906940</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>51</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.949462</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>52</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.324733</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.976299</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>54</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.940100</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>55</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>20</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.958200</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi</td>
      <td>0.495938</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_iso</td>
      <td>0.986762</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>58</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_vis</td>
      <td>0.926752</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>59</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym</td>
      <td>0.956757</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>60</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>mi_fixed</td>
      <td>0.324745</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>61</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_iso_fixed</td>
      <td>0.970086</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>62</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_vis_fixed</td>
      <td>0.958194</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
    <tr>
      <th>63</th>
      <td>1</td>
      <td>ElasticSyN</td>
      <td>0.2</td>
      <td>32</td>
      <td>32</td>
      <td>0.2</td>
      <td>sym_fixed</td>
      <td>0.964140</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">vis</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">mask_r</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">mask_l</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4922</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9994</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9250</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./iso_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./vis_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">indiv</span><span class="o">.</span><span class="n">get_mask</span><span class="p">()</span>

<span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="p">(</span><span class="n">warped</span> <span class="o">*</span> <span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="o">.</span><span class="n">get_mask</span><span class="p">()))</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="n">iso_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="p">(</span><span class="n">mask_l_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="p">(</span><span class="n">mask_r_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="n">vis_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="p">(</span><span class="n">mask_l_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="p">(</span><span class="n">mask_r_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.3247</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9806</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9525</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./iso_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best-fix.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span> <span class="o">*</span> <span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./vis_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best-fix.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">indiv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
    <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
    <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
    <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_best_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type : float <span style="font-weight: bold">(</span>float32<span style="font-weight: bold">)</span>
         Components : <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
         Dimensions : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span><span style="font-weight: bold">)</span>
         Spacing    : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span><span style="font-weight: bold">)</span>
         Origin     : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span><span style="font-weight: bold">)</span>
         Direction  : <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.<span style="font-weight: bold">]</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overlap_score</span><span class="p">(</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span> <span class="n">mask</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9680537723736878</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overlap_score</span><span class="p">(</span><span class="n">vis_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span> <span class="n">mask</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9714285714285714</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span> <span class="n">mask</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12818</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13241</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">12818</span> <span class="o">-</span> <span class="mi">13241</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-423</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">13299</span> <span class="o">-</span> <span class="mi">13744</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-445</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">94945</span> <span class="o">-</span> <span class="mi">94707</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">238</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">95335</span> <span class="o">-</span> <span class="mi">95090</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">245</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tess</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s1">&#39;./tess.nii.gz&#39;</span><span class="p">)</span>
<span class="n">tess</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type : float <span style="font-weight: bold">(</span>float32<span style="font-weight: bold">)</span>
         Components : <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
         Dimensions : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">)</span>
         Spacing    : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span><span style="font-weight: bold">)</span>
         Origin     : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span><span style="font-weight: bold">)</span>
         Direction  : <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.<span style="font-weight: bold">]</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tess_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">tess</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tess_yale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ANTsImage <span style="font-weight: bold">(</span>RAI<span style="font-weight: bold">)</span>
         Pixel Type : float <span style="font-weight: bold">(</span>float32<span style="font-weight: bold">)</span>
         Components : <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>
         Dimensions : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">78</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">64</span><span style="font-weight: bold">)</span>
         Spacing    : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.1</span><span style="font-weight: bold">)</span>
         Origin     : <span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span><span style="font-weight: bold">)</span>
         Direction  : <span style="font-weight: bold">[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>. <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>.<span style="font-weight: bold">]</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">tess_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;./tess_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">_Best.nii.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overlap_score</span><span class="p">(</span><span class="n">tess_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9999967734962072</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dice_score</span><span class="p">(</span><span class="n">tess_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6454462626189001</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tess_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">309933</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">tess_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">309932</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indiv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
    <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
    <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_87_0.png" src="../../_images/sep-26or7-2021_87_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">alt</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">][</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">alt</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">][</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">vis</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">alt</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">][</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">mask_r</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">alt</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">][</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">mask_l</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">alt</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">][</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5009</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9979</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9101</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./iso_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best(alt).nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;./vis_direct_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_Best(alt).nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;nissl2yale&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">,</span> <span class="s1">&#39;SyNAggro&#39;</span><span class="p">],</span>
    <span class="n">grads</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="n">syn_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="n">aff_bins</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="n">aff_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f863b9a3fd7a44a988f13643ed9b9601", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;isocortex_mask&#39;</span><span class="p">])</span>

<span class="n">vis</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;structure_tree&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_structures_by_acronym</span><span class="p">([</span><span class="s1">&#39;VIS&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vis</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_structure_mask</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vis</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>

<span class="n">mask_r</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;mask_r&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">)</span>
<span class="n">mask_l</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;mask_l&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(),</span>
    <span class="n">type_of_transform</span><span class="o">=</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span>
    <span class="n">syn_metric</span><span class="o">=</span><span class="s1">&#39;mattes&#39;</span><span class="p">,</span>
    <span class="n">grad_step</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">syn_sampling</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">aff_sampling</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">vis</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_r</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_l</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.4985</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9979</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9409</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="s2">&quot;./iso_yale_SyN_0.1_Best.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="s2">&quot;./vis_yale_SyN_0.1_Best.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dst</span> <span class="o">=</span> <span class="s1">&#39;best_nissl2yale_0.1mm&#39;</span>
<span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">]:</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">_dst</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span>
        <span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">-fwd.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">_dst</span><span class="p">)</span>
<span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">]:</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">_dst</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span>
        <span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">-inv.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="now-do-yale2indiv">
<h2>Now do Yale2Indiv<a class="headerlink" href="#now-do-yale2indiv" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;sub-SLC01_ses-2&#39;</span>
<span class="n">indiv</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">T1w</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">indiv</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">indiv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">sub-SLC01_ses-<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">indiv</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(),</span>
    <span class="n">type_of_transform</span><span class="o">=</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span>
    <span class="n">syn_metric</span><span class="o">=</span><span class="s1">&#39;mattes&#39;</span><span class="p">,</span>
    <span class="n">grad_step</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">syn_sampling</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">aff_sampling</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">iso_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">vis_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.6499</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9850</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9536</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">indiv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">overlay</span><span class="o">=</span><span class="n">iso_indiv</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
        <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;double_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">_SyN_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_iso.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_vis.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="now-do-the-inverse-of-double-thing">
<h2>Now do the inverse of double thing<a class="headerlink" href="#now-do-the-inverse-of-double-thing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(),</span>
    <span class="n">type_of_transform</span><span class="o">=</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span>
    <span class="n">syn_metric</span><span class="o">=</span><span class="s1">&#39;mattes&#39;</span><span class="p">,</span>
    <span class="n">grad_step</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">syn_sampling</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">aff_sampling</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">iso_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">vis_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">indiv</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">indiv</span><span class="p">,</span> <span class="n">indiv</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.7343</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9571</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9986</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_iso2.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_vis2.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">indiv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">overlay</span><span class="o">=</span><span class="n">iso_indiv</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
        <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;double2_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">_ElasticSyN_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="direct-indiv">
<h2>Direct indiv<a class="headerlink" href="#direct-indiv" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(),</span>
    <span class="n">type_of_transform</span><span class="o">=</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span>
    <span class="n">syn_metric</span><span class="o">=</span><span class="s1">&#39;mattes&#39;</span><span class="p">,</span>
    <span class="n">grad_step</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">aff_random_sampling_rate</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span>
    <span class="n">syn_sampling</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">aff_sampling</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">iso_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">vis</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_r</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_l</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx_indiv</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">indiv</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span><span class="n">indiv</span><span class="p">,</span> <span class="n">indiv</span><span class="p">)</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_indiv</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">mi: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5635</span>,     iso: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9854</span>,    vis: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.9430</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_iso3.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_indiv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_vis3.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span> <span class="s2">&quot;nissl.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="now-do-the-direct-to-indiv-thing">
<h3>Now do the direct to indiv thing<a class="headerlink" href="#now-do-the-direct-to-indiv-thing" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(),</span>
    <span class="n">type_of_transform</span><span class="o">=</span><span class="s1">&#39;ElasticSyN&#39;</span><span class="p">,</span>
    <span class="n">syn_metric</span><span class="o">=</span><span class="s1">&#39;mattes&#39;</span><span class="p">,</span>
    <span class="n">grad_step</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">syn_sampling</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">aff_sampling</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reg.save_atlas_images()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">grads</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">30</span><span class="p">)],</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d7edfc1a5a4044419ce8254cf1da6d98", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">a, perf:
seed           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
grad        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.27</span>
bins          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
type         SyN
perf    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.493284</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">,</span> <span class="s1">&#39;grad&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="21" halign="left">perf</th>
    </tr>
    <tr>
      <th></th>
      <th>grad</th>
      <th>0.01</th>
      <th>0.03</th>
      <th>0.06</th>
      <th>0.08</th>
      <th>0.11</th>
      <th>0.13</th>
      <th>0.15</th>
      <th>0.18</th>
      <th>0.20</th>
      <th>0.22</th>
      <th>...</th>
      <th>0.49</th>
      <th>0.51</th>
      <th>0.53</th>
      <th>0.56</th>
      <th>0.58</th>
      <th>0.60</th>
      <th>0.63</th>
      <th>0.65</th>
      <th>0.68</th>
      <th>0.70</th>
    </tr>
    <tr>
      <th>type</th>
      <th>bins</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">ElasticSyN</th>
      <th>12</th>
      <td>0.469632</td>
      <td>0.479674</td>
      <td>0.485620</td>
      <td>0.488338</td>
      <td>0.488804</td>
      <td>0.488379</td>
      <td>0.489690</td>
      <td>0.490180</td>
      <td>0.491889</td>
      <td>0.491135</td>
      <td>...</td>
      <td>0.487499</td>
      <td>0.485682</td>
      <td>0.487556</td>
      <td>0.484668</td>
      <td>0.484756</td>
      <td>0.484975</td>
      <td>0.484932</td>
      <td>0.482894</td>
      <td>0.482235</td>
      <td>0.482904</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.467723</td>
      <td>0.477344</td>
      <td>0.484073</td>
      <td>0.485691</td>
      <td>0.486216</td>
      <td>0.490447</td>
      <td>0.487172</td>
      <td>0.486056</td>
      <td>0.484397</td>
      <td>0.488262</td>
      <td>...</td>
      <td>0.485971</td>
      <td>0.486505</td>
      <td>0.484690</td>
      <td>0.485514</td>
      <td>0.480731</td>
      <td>0.483088</td>
      <td>0.481851</td>
      <td>0.483741</td>
      <td>0.481056</td>
      <td>0.482164</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.468050</td>
      <td>0.477604</td>
      <td>0.484495</td>
      <td>0.487739</td>
      <td>0.488618</td>
      <td>0.488169</td>
      <td>0.489713</td>
      <td>0.490070</td>
      <td>0.489405</td>
      <td>0.490264</td>
      <td>...</td>
      <td>0.486607</td>
      <td>0.485014</td>
      <td>0.485454</td>
      <td>0.483962</td>
      <td>0.482130</td>
      <td>0.482688</td>
      <td>0.483474</td>
      <td>0.480626</td>
      <td>0.480014</td>
      <td>0.483010</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.465644</td>
      <td>0.472964</td>
      <td>0.478402</td>
      <td>0.486558</td>
      <td>0.482948</td>
      <td>0.482540</td>
      <td>0.487808</td>
      <td>0.485567</td>
      <td>0.490883</td>
      <td>0.481658</td>
      <td>...</td>
      <td>0.486306</td>
      <td>0.482292</td>
      <td>0.485459</td>
      <td>0.482042</td>
      <td>0.482615</td>
      <td>0.484149</td>
      <td>0.482069</td>
      <td>0.483186</td>
      <td>0.481789</td>
      <td>0.480048</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">SyN</th>
      <th>12</th>
      <td>0.469857</td>
      <td>0.478955</td>
      <td>0.485271</td>
      <td>0.487289</td>
      <td>0.488214</td>
      <td>0.490021</td>
      <td>0.490052</td>
      <td>0.491244</td>
      <td>0.491258</td>
      <td>0.490909</td>
      <td>...</td>
      <td>0.487403</td>
      <td>0.487010</td>
      <td>0.486230</td>
      <td>0.485269</td>
      <td>0.483438</td>
      <td>0.484829</td>
      <td>0.483385</td>
      <td>0.482416</td>
      <td>0.483498</td>
      <td>0.480959</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.468915</td>
      <td>0.480556</td>
      <td>0.482550</td>
      <td>0.485246</td>
      <td>0.489913</td>
      <td>0.490772</td>
      <td>0.485094</td>
      <td>0.489489</td>
      <td>0.490441</td>
      <td>0.484398</td>
      <td>...</td>
      <td>0.486264</td>
      <td>0.485692</td>
      <td>0.487301</td>
      <td>0.486133</td>
      <td>0.484540</td>
      <td>0.485009</td>
      <td>0.485849</td>
      <td>0.483785</td>
      <td>0.476636</td>
      <td>0.482646</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.469430</td>
      <td>0.478886</td>
      <td>0.485205</td>
      <td>0.485136</td>
      <td>0.487357</td>
      <td>0.489462</td>
      <td>0.489211</td>
      <td>0.489328</td>
      <td>0.490451</td>
      <td>0.490107</td>
      <td>...</td>
      <td>0.485073</td>
      <td>0.485747</td>
      <td>0.485390</td>
      <td>0.483423</td>
      <td>0.484655</td>
      <td>0.485840</td>
      <td>0.481630</td>
      <td>0.485136</td>
      <td>0.481793</td>
      <td>0.481030</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.464073</td>
      <td>0.476030</td>
      <td>0.479047</td>
      <td>0.482457</td>
      <td>0.488297</td>
      <td>0.481748</td>
      <td>0.481842</td>
      <td>0.483200</td>
      <td>0.488172</td>
      <td>0.489385</td>
      <td>...</td>
      <td>0.488554</td>
      <td>0.485177</td>
      <td>0.486054</td>
      <td>0.483489</td>
      <td>0.484542</td>
      <td>0.484340</td>
      <td>0.482289</td>
      <td>0.479200</td>
      <td>0.482271</td>
      <td>0.481183</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 30 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>bins</th>
      <th>grad</th>
      <th>perf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ElasticSyN</td>
      <td>12</td>
      <td>0.01</td>
      <td>0.469632</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ElasticSyN</td>
      <td>12</td>
      <td>0.03</td>
      <td>0.479674</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ElasticSyN</td>
      <td>12</td>
      <td>0.06</td>
      <td>0.485620</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ElasticSyN</td>
      <td>12</td>
      <td>0.08</td>
      <td>0.488338</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ElasticSyN</td>
      <td>12</td>
      <td>0.11</td>
      <td>0.488804</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>235</th>
      <td>SyN</td>
      <td>24</td>
      <td>0.60</td>
      <td>0.484340</td>
    </tr>
    <tr>
      <th>236</th>
      <td>SyN</td>
      <td>24</td>
      <td>0.63</td>
      <td>0.482289</td>
    </tr>
    <tr>
      <th>237</th>
      <td>SyN</td>
      <td>24</td>
      <td>0.65</td>
      <td>0.479200</td>
    </tr>
    <tr>
      <th>238</th>
      <td>SyN</td>
      <td>24</td>
      <td>0.68</td>
      <td>0.482271</td>
    </tr>
    <tr>
      <th>239</th>
      <td>SyN</td>
      <td>24</td>
      <td>0.70</td>
      <td>0.481183</td>
    </tr>
  </tbody>
</table>
<p>240 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_158_0.png" src="../../_images/sep-26or7-2021_158_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">grads</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">31</span><span class="p">)),</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "01902f1480664a09b36daca12e43028e", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">, perf:
seed           <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
grad        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.29</span>
bins          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>
type         SyN
perf    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.494299</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">,</span> <span class="s1">&#39;grad&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_167_0.png" src="../../_images/sep-26or7-2021_167_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">12</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.48</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_169_1.png" src="../../_images/sep-26or7-2021_169_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SyN&#39;</span><span class="p">)]</span>
<span class="n">df_1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="n">df_1</span><span class="p">[</span><span class="s1">&#39;perf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>grad</th>
      <th>bins</th>
      <th>type</th>
      <th>perf</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1062</th>
      <td>8</td>
      <td>0.23</td>
      <td>12</td>
      <td>SyN</td>
      <td>0.494826</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">)]</span>
<span class="n">df_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="n">df_2</span><span class="p">[</span><span class="s1">&#39;perf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>grad</th>
      <th>bins</th>
      <th>type</th>
      <th>perf</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>927</th>
      <td>4</td>
      <td>0.4</td>
      <td>12</td>
      <td>ElasticSyN</td>
      <td>0.495142</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx1</span> <span class="o">=</span> <span class="n">df_1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df_1</span><span class="p">[</span><span class="s1">&#39;perf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()][</span><span class="s1">&#39;tx&#39;</span><span class="p">]</span>
<span class="n">tx2</span> <span class="o">=</span> <span class="n">df_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df_2</span><span class="p">[</span><span class="s1">&#39;perf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()][</span><span class="s1">&#39;tx&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;isocortex_mask&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx1</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
        <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;in_house_SyN_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx2</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
        <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;in_house_ElasticSyN_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dst</span> <span class="o">=</span> <span class="s1">&#39;best_nissl2yale&#39;</span>
<span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">tx2</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">]:</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">_dst</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span>
        <span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">-fwd.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">_dst</span><span class="p">)</span>
<span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">tx2</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">]:</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">_dst</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span>
        <span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">-inv.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">grads</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="mi">5</span><span class="p">)),</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a8209be9d18e4b8988081bbf6ab2ccb7", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">, perf:
seed          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">32</span>
grad        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.25</span>
bins          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>
type         SyN
perf    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.494667</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_3</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="n">df_tx</span><span class="p">[</span><span class="s1">&#39;perf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]]</span>
<span class="n">tx3</span> <span class="o">=</span> <span class="n">df_3</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">df_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seed</th>
      <th>grad</th>
      <th>bins</th>
      <th>type</th>
      <th>perf</th>
      <th>tx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>83</th>
      <td>4</td>
      <td>0.29</td>
      <td>13</td>
      <td>SyN</td>
      <td>0.495242</td>
      <td>{'warpedmovout': ANTsImage (RAI)
	 Pixel Type ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_tx</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">,</span> <span class="s1">&#39;grad&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df_tx</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;perf&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;bins&#39;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_192_0.png" src="../../_images/sep-26or7-2021_192_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;isocortex_mask&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx3</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
        <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
        <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;in_house_SyN_axis</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">now</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dst</span> <span class="o">=</span> <span class="s1">&#39;best_nissl2yale&#39;</span>
<span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">tx3</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">]:</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">_dst</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span>
        <span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">-fwd.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">_dst</span><span class="p">)</span>
<span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">tx3</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">]:</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">_dst</span> <span class="o">=</span> <span class="n">pjoin</span><span class="p">(</span>
        <span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dst</span><span class="si">}</span><span class="s2">-inv.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">_dst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="s2">&quot;./inhouse.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="s2">&quot;./iso_yale_SyN.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vis_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">vis</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx3</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="s2">&quot;./vis_yaleSyN.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;isocortex_mask&#39;</span><span class="p">])</span>

<span class="n">vis</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;structure_tree&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_structures_by_acronym</span><span class="p">([</span><span class="s1">&#39;VIS&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vis</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_structure_mask</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vis</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>

<span class="n">mask_r</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;mask_r&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">)</span>
<span class="n">mask_l</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;mask_l&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tx</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">registration</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(),</span>
    <span class="n">type_of_transform</span><span class="o">=</span><span class="s1">&#39;ElasticSyN&#39;</span><span class="p">,</span>
    <span class="n">syn_metric</span><span class="o">=</span><span class="s1">&#39;mattes&#39;</span><span class="p">,</span>
    <span class="n">grad_step</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">syn_sampling</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">aff_sampling</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">vis_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">vis</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_r_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_r</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mask_l_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">mask_l</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">)</span>
<span class="n">perf</span> <span class="o">=</span> <span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span>

<span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">score_vis</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
    <span class="n">m</span><span class="o">=</span><span class="n">vis_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
    <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mi: </span><span class="si">{</span><span class="n">perf</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t\t</span><span class="s2">iso: </span><span class="si">{</span><span class="n">score_iso</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">vis: </span><span class="si">{</span><span class="n">score_vis</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">74</span><span class="n">cab4e05f6f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">score_iso</span> <span class="o">=</span> <span class="n">symmetry_score</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">m</span><span class="o">=</span><span class="n">iso_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">mask_l</span><span class="o">=</span><span class="n">mask_l_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">mask_r</span><span class="o">=</span><span class="n">mask_r_yale</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="p">)</span>

<span class="ne">NameError</span>: name &#39;symmetry_score&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="s2">&quot;./iso_yale_ElasticSyN_0.1_Best.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="s2">&quot;./vis_yale_ElasticSyN_0.1_Best.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">iso_yale</span><span class="p">,</span> <span class="s2">&quot;./iso_yale_SyN_best.nii.gz&quot;</span><span class="p">)</span>
<span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">vis_yale</span><span class="p">,</span> <span class="s2">&quot;./vis_yale_SyN_best.nii.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ants</span><span class="o">.</span><span class="n">image_write</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="s1">&#39;./in_house_0.1.nii.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="do-the-double-thing">
<h2>do the double thing<a class="headerlink" href="#do-the-double-thing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">load_preproc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;sub-SLC04_ses-2&#39;</span>
<span class="n">indiv</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">T1w</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">indiv</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">indiv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df_tx</span><span class="p">,</span> <span class="n">_best_tx</span><span class="p">,</span> <span class="n">_perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">grads</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)],</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">,</span> <span class="s1">&#39;ElasticSyN&#39;</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "597c7903b4c149129e01a168e8e4d490", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">a, perf:
seed          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
grad         <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.2</span>
bins          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>
type         SyN
perf    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.725569</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso_yale_indiv</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">_best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indiv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale_indiv</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
    <span class="n">nslices</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;in_house_indiv.png&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">warped</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">indiv</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">warped</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">_best_tx</span><span class="p">[</span><span class="s1">&#39;invtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">indiv</span><span class="p">,</span> <span class="n">warped</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">indiv</span><span class="p">,</span> <span class="n">indiv</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5645622211082675</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tx</span><span class="p">,</span> <span class="n">best_tx</span><span class="p">,</span> <span class="n">perf</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">fit_register</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">grads</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">9</span><span class="p">)],</span>
    <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SyN&#39;</span><span class="p">],</span>
    <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="n">n_seeds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5a362538592b47a1942b47d90cf13ab6", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">a, perf:
seed             <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>
grad          <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.23</span>
bins            <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>
type    ElasticSyN
perf      <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.494515</span>

</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nissl_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">nissl</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">nissl_yale</span><span class="p">)</span>
<span class="n">mi_base</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_mutual_information</span><span class="p">(</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">/</span> <span class="n">mi_base</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.5149954810621087</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">overlay</span><span class="o">=</span><span class="n">nissl_yale</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span>
    <span class="n">nslices</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_240_0.png" src="../../_images/sep-26or7-2021_240_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">overlay</span><span class="o">=</span><span class="n">nissl_yale</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;nipy_spectral&#39;</span><span class="p">,</span>
    <span class="n">nslices</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_241_0.png" src="../../_images/sep-26or7-2021_241_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iso</span> <span class="o">=</span> <span class="n">reset_ants_img</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;isocortex_mask&#39;</span><span class="p">])</span>

<span class="n">iso_yale</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">apply_transforms</span><span class="p">(</span>
    <span class="n">fixed</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="p">,</span>
    <span class="n">moving</span><span class="o">=</span><span class="n">iso</span><span class="p">,</span>
    <span class="n">transformlist</span><span class="o">=</span><span class="n">best_tx</span><span class="p">[</span><span class="s1">&#39;fwdtransforms&#39;</span><span class="p">],</span>
    <span class="n">interpolator</span><span class="o">=</span><span class="s1">&#39;genericLabel&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span><span class="o">.</span><span class="n">in_house</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">overlay</span><span class="o">=</span><span class="n">iso_yale</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">overlay_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">overlay_cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span>
    <span class="n">nslices</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_245_0.png" src="../../_images/sep-26or7-2021_245_0.png" />
</div>
</div>
</div>
<div class="section" id="next-load-slides-and-watch-out-for-bad-registrations">
<h2>Next, load slides and watch out for bad registrations<a class="headerlink" href="#next-load-slides-and-watch-out-for-bad-registrations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="next-do-the-same-for-each-individual-animal-check-if-it-works">
<h2>Next, do the same for each individual animal, check if it works<a class="headerlink" href="#next-do-the-same-for-each-individual-animal-check-if-it-works" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="next-see-if-you-need-to-register-per-animal-or-just-register-individuals-to-n162-and-gateway">
<h2>Next, see if you need to register per animal, or just register individuals to N162 and gateway?<a class="headerlink" href="#next-see-if-you-need-to-register-per-animal-or-just-register-individuals-to-n162-and-gateway" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="figure-1">
<h2>Figure 1<a class="headerlink" href="#figure-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what">
<h3>What<a class="headerlink" href="#what" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="how">
<h3>How<a class="headerlink" href="#how" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span> <span class="o">=</span> <span class="n">Mice</span><span class="p">(</span><span class="n">Config</span><span class="p">(</span><span class="mi">1884</span><span class="p">))</span>
<span class="n">mice</span><span class="o">.</span><span class="n">combine_dfs</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">register.parcellation.Parcellation</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fd556815fd0</span><span style="font-weight: bold">&gt;</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cortex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;eroded&#39;</span><span class="p">]</span>
<span class="n">subcortex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">cortex</span><span class="p">)</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;roi_masks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;isocortex&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="ow">in</span> <span class="n">region</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">region_i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">subcortex</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">region_i</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">OrderedDict</span><span style="font-weight: bold">([(</span><span style="color: #008000; text-decoration-color: #008000">'type'</span>, <span style="color: #008000; text-decoration-color: #008000">'unsigned short'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'dimension'</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'space'</span>, <span style="color: #008000; text-decoration-color: #008000">'left-posterior-superior'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'sizes'</span>, <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">]))</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'space directions'</span>, <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>.<span style="font-weight: bold">]]))</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'kinds'</span>, <span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'domain'</span>, <span style="color: #008000; text-decoration-color: #008000">'domain'</span>, <span style="color: #008000; text-decoration-color: #008000">'domain'</span><span style="font-weight: bold">])</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'endian'</span>, <span style="color: #008000; text-decoration-color: #008000">'little'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'encoding'</span>, <span style="color: #008000; text-decoration-color: #008000">'gzip'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'space origin'</span>, <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">]))])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;template_info&#39;</span><span class="p">][</span><span class="s1">&#39;space origin&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>
    <span style="color: #008000; text-decoration-color: #008000">'atlas_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'contour_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'parcel_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'eroded_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'parcel_acc_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'parcel_rej_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'mask_l_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'mask_r_trm'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'atlas'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'contour'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'parcel'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'eroded'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'parcel_acc'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'parcel_rej'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'mask_l'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'mask_r'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'radius'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'n_cortical_regions'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'centers'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'eroded_masks'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'roi_masks'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'major_masks'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'major_colors'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'annot_cmap'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'acro2idx'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'name2idx'</span>
<span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;parcel_acc&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fd54eaf5a00</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_274_1.png" src="../../_images/sep-26or7-2021_274_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">results2d</span><span class="p">[</span><span class="s1">&#39;parcel_acc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">)</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_281_0.png" src="../../_images/sep-26or7-2021_281_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">parcel</span><span class="o">.</span><span class="n">show2d</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_282_0.png" src="../../_images/sep-26or7-2021_282_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">mice</span><span class="p">,</span> <span class="s1">&#39;sub-SLC&#39;</span><span class="p">,</span> <span class="n">percentiles</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span><span class="o">.</span><span class="n">load_network</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">thresholds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">{</span>
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">53</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">29</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04139814153035346</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">28</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0439684986595741</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">27</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04665225133476631</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">26</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.04936660219451171</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">25</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.052399799401693696</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">24</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.05545280871768082</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">23</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.0586778935809938</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">22</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06223419581750657</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">21</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06604398443860941</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">20</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07007351599928377</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">19</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07444967885731966</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">18</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.07908949206469937</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">17</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08432095527569944</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08963561001531985</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">15</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09574749438834834</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">14</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10194368215506612</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">13</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.10915048865093123</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">12</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.11692139398431177</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.12552904940431253</span>,
    <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>: <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.13497348491291086</span>
<span style="font-weight: bold">}</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">adj_matrix</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">graphs</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08037398611890612</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">graphs</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.17830474509149033</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">make_graphs</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>PROGRESS<span style="font-weight: bold">]</span> graphs: done
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">graphs</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.20080158408283036</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">adj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">th</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2"> % (</span><span class="si">{</span><span class="n">th</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_298_0.png" src="../../_images/sep-26or7-2021_298_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">fig_within_hemis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/sep-26or7-2021_300_0.png" src="../../_images/sep-26or7-2021_300_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_template_volume</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7fb5608b0</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_303_1.png" src="../../_images/sep-26or7-2021_303_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_reference_space</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">get_slice_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7faf59ee0</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_305_1.png" src="../../_images/sep-26or7-2021_305_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">100</span><span class="o">-</span><span class="mi">23</span><span class="n">c3e98e725a</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">[</span><span class="s1">&#39;mcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_projection_matrix</span><span class="p">()</span>

<span class="ne">TypeError</span>: get_projection_matrix() missing 1 required positional argument: &#39;experiment_ids&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bg_atlasapi</span> <span class="kn">import</span> <span class="n">show_atlases</span><span class="p">,</span> <span class="n">BrainGlobeAtlas</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_atlases</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">                                                                                  </span>
<span style="font-style: italic">                                                                                  </span>
<span style="font-style: italic">                                Brainglobe Atlases                                </span>
╭──────────────────────────────────┬────────────┬───────────────┬────────────────╮
│<span style="color: #008000; text-decoration-color: #008000; font-weight: bold"> Name                             </span>│<span style="color: #008000; text-decoration-color: #008000; font-weight: bold"> Downloaded </span>│<span style="color: #008000; text-decoration-color: #008000; font-weight: bold"> Local version </span>│<span style="color: #008000; text-decoration-color: #008000; font-weight: bold"> Latest version </span>│
├──────────────────────────────────┼────────────┼───────────────┼────────────────┤
│ <span style="font-weight: bold">allen_cord_20um</span>                  │     <span style="color: #008000; text-decoration-color: #008000">✔</span>      │      1.0      │      1.0       │
│ <span style="font-weight: bold">mpin_zfish_1um</span>                   │     <span style="color: #008000; text-decoration-color: #008000">✔</span>      │      1.0      │      1.0       │
│ <span style="font-weight: bold">example_mouse_100um</span>              │     <span style="color: #008000; text-decoration-color: #008000">✔</span>      │      1.2      │      1.2       │
│ <span style="font-weight: bold">kim_mouse_100um</span>                  │     <span style="color: #008000; text-decoration-color: #008000">✔</span>      │      1.0      │      1.0       │
│ <span style="font-weight: bold">osten_mouse_100um</span>                │     <span style="color: #008000; text-decoration-color: #008000">✔</span>      │      1.1      │      1.1       │
│ <span style="font-weight: bold">allen_mouse_100um</span>                │     <span style="color: #008000; text-decoration-color: #008000">✔</span>      │      1.2      │      1.2       │
│ <span style="font-weight: bold">allen_mouse_10um</span>                 │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.2       │
│ <span style="font-weight: bold">allen_mouse_25um</span>                 │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.2       │
│ <span style="font-weight: bold">allen_mouse_50um</span>                 │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.2       │
│ <span style="font-weight: bold">allen_human_500um</span>                │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      0.1       │
│ <span style="font-weight: bold">kim_mouse_10um</span>                   │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.0       │
│ <span style="font-weight: bold">kim_mouse_25um</span>                   │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.0       │
│ <span style="font-weight: bold">kim_mouse_50um</span>                   │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.0       │
│ <span style="font-weight: bold">osten_mouse_10um</span>                 │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.1       │
│ <span style="font-weight: bold">osten_mouse_25um</span>                 │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.1       │
│ <span style="font-weight: bold">osten_mouse_50um</span>                 │    <span style="color: #800000; text-decoration-color: #800000">---</span>     │      <span style="color: #800000; text-decoration-color: #800000">---</span>      │      1.1       │
╰──────────────────────────────────┴────────────┴───────────────┴────────────────╯
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atlas</span> <span class="o">=</span> <span class="n">BrainGlobeAtlas</span><span class="p">(</span><span class="s1">&#39;kim_mouse_100um&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>kim mouse atlas (res. 100um)
From: https://kimlab.io/brain-map/atlas/ (Chon et al. 2019, https://doi.org/10.1038/s41467-019-13057-w )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">atlas</span><span class="o">.</span><span class="n">reference</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7fa64bc40</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_312_1.png" src="../../_images/sep-26or7-2021_312_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">mice</span><span class="o">.</span><span class="n">allen</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span>
    <span style="color: #008000; text-decoration-color: #008000">'mcc'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'manifest_file'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'structure_tree'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'dims_flat'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'root'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'grey'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'cerebrum'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'isocortex'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'template'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'template_info'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'annot'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'annot_info'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'root_mask'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'root_mask_info'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'grey_mask'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'grey_mask_info'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'cerebrum_mask'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'cerebrum_mask_info'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'isocortex_mask'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'isocortex_mask_info'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'onto_info_df'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'mc_summary_df'</span>,
    <span style="color: #008000; text-decoration-color: #008000">'expts_df'</span>
<span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">allensdk.api.queries.reference_space_api</span> <span class="kn">import</span> <span class="n">ReferenceSpaceApi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">ReferenceSpaceApi</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">build_volumetric_data_download_url</span><span class="p">(</span><span class="s1">&#39;ara_nissl&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;ara_nissl_100.nrrd&#39;</span><span class="p">,</span> <span class="n">voxel_resolution</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008000; text-decoration-color: #008000">'http://download.alleninstitute.org/informatics-archive/current-release/mouse_ccf/ara_nissl/ara_nissl_100.nrrd'</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;nrrd&#39;</span> <span class="ow">in</span> <span class="n">e</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'ara_nissl_100.nrrd'</span><span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nrrd</span>
<span class="n">ara</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">nrrd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pjoin</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="s1">&#39;ara_nissl_100.nrrd&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ara</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">)</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">OrderedDict</span><span style="font-weight: bold">([(</span><span style="color: #008000; text-decoration-color: #008000">'type'</span>, <span style="color: #008000; text-decoration-color: #008000">'float'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'dimension'</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'space'</span>, <span style="color: #008000; text-decoration-color: #008000">'left-posterior-superior'</span><span style="font-weight: bold">)</span>, 
<span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'sizes'</span>, <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">132</span>,  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">80</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">114</span><span style="font-weight: bold">]))</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'space directions'</span>, <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([[</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">]</span>,
       <span style="font-weight: bold">[</span>  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.,   <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">100</span>.<span style="font-weight: bold">]]))</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'kinds'</span>, <span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'domain'</span>, <span style="color: #008000; text-decoration-color: #008000">'domain'</span>, <span style="color: #008000; text-decoration-color: #008000">'domain'</span><span style="font-weight: bold">])</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'endian'</span>, 
<span style="color: #008000; text-decoration-color: #008000">'little'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'encoding'</span>, <span style="color: #008000; text-decoration-color: #008000">'gzip'</span><span style="font-weight: bold">)</span>, <span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'space origin'</span>, <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">array</span><span style="font-weight: bold">([</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>., <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>.<span style="font-weight: bold">]))])</span>
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ara</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.image.AxesImage</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb842cd3490</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_320_1.png" src="../../_images/sep-26or7-2021_320_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ara</span><span class="p">[:,</span> <span class="mi">30</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">matplotlib.colorbar.Colorbar</span><span style="color: #000000; text-decoration-color: #000000"> object at </span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0x7fb7fc3dce50</span><span style="font-weight: bold">&gt;</span>
</pre>
</div><img alt="../../_images/sep-26or7-2021_321_1.png" src="../../_images/sep-26or7-2021_321_1.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nb/sep21"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hadi Vafaii<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>